<!DOCTYPE html>
<html lang="en">
<head>

    <meta name="google-site-verification: google9d6c77d818ecf419.html" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tasklytic</title>

    <!-- ADD THESE ICON LINES HERE -->
    <link rel="icon" type="image/x-icon" href="data:image/Screenshot 2025-06-09 171415.png">
    
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzRGNDZFNSIvPgo8cGF0aCBkPSJNOCAxMkgyNE0xMiAxNkwyMCAxNk0xMCAyMEgxOCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz4KPHN2Zz4K">

    <link rel="manifest" href="data:application/json;charset=utf-8;base64,ewogICJuYW1lIjogIlRhc2tseXRpYyAtIFRhc2sgTWFuYWdlbWVudCIsCiAgInNob3J0X25hbWUiOiAiVGFza2x5dGljIiwKICAiZGVzY3JpcHRpb24iOiAiUHJvZmVzc2lvbmFsIHRhc2sgbWFuYWdlbWVudCBhcHAiLAogICJzdGFydF91cmwiOiAiLiIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzRmNDZlNSIsCiAgInRoZW1lX2NvbG9yIjogIiM0ZjQ2ZTUiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXlORUFpSUdobGFXZG9kRDBpTWpSQUlqNGdQSEpsWTNRZ2VEMGlNQ0lnZVQwaU1DSWdkMmxrZEdnOUlqSTBJaUJvWldsbmFIUTlJakkwSWlCbWFXeHNQU0lqTkdZME5tVTFJaTgrUEM5emRtYysiLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJMU1USWlJR2hsYVdkb2REMGlOVEV5SWo0Z1BISmxZM1FnZUQwaU1DSWdlVDBpTUNJZ2QybGtkR2c5SWpVeE1pSWdhR1ZwWjJoMFBTSTFNVElpSUdacGJHdzlJaU0wWmpRMlpUVWlMejQ4TDNOMlp6NGciLAogICAgICAic2l6ZXMiOiAiNTEyeDUxMiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">

    <meta name="application-name" content="Tasklytic">
    <meta name="apple-mobile-web-app-title" content="Tasklytic">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#4f46e5">
    <meta name="msapplication-TileImage" content="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiB2aWV3Qm94PSIwIDAgMTkyIDE5MiI+IDxyZWN0IHg9IjQiIHk9IjQiIHdpZHRoPSIxODQiIGhlaWdodD0iMTg0IiBmaWxsPSIjNGY0NmU1Ii8+PGljb24gY2xhc3M9ImZhcyBmYS10YXNrcyIgZmlsbD0iM3doaXRlIiB4PSI0OCIgeT0iNDgiPjwvc3ZnPg==">
    <style>
        :root {
            /* Primary Colors */
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --primary-light: #818cf8;
            --primary-gradient: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%);
            
            /* Secondary Colors */
            --secondary: #0ea5e9;
            --secondary-dark: #0284c7;
            --secondary-light: #7dd3fc;
            
            /* Accent Colors */
            --accent: #f97316;
            --accent-dark: #ea580c;
            --accent-light: #fdba74;
            
            /* Status Colors */
            --success: #10b981;
            --success-light: #d1fae5;
            --warning: #f59e0b;
            --warning-light: #fef3c7;
            --danger: #ef4444;
            --danger-light: #fee2e2;
            
            /* Gray Scale - Light Mode */
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            /* Category Colors */
            --work-color: #4f46e5;
            --work-light: #e0e7ff;
            --personal-color: #8b5cf6;
            --personal-light: #ede9fe;
            --shopping-color: #06b6d4;
            --shopping-light: #cffafe;
            --health-color: #10b981;
            --health-light: #d1fae5;
            --finance-color: #f59e0b;
            --finance-light: #fef3c7;
            --education-color: #ef4444;
            --education-light: #fee2e2;
            
            /* Shadows */
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --sidebar-shadow: 4px 0 10px -3px rgba(0, 0, 0, 0.1);

            /* Highlight Colors */
            --highlight-color: #ec4899;
            --highlight-light: #fce7f3;
        }

        /* Dark Mode Variables */
        body.dark-mode {
            --gray-50: #1f2937;
            --gray-100: #374151;
            --gray-200: #4b5563;
            --gray-300: #6b7280;
            --gray-400: #9ca3af;
            --gray-500: #d1d5db;
            --gray-600: #e5e7eb;
            --gray-700: #f3f4f6;
            --gray-800: #f9fafb;
            --gray-900: #ffffff;
            
            /* Dark mode specific adjustments */
            --success-light: rgba(16, 185, 129, 0.2);
            --warning-light: rgba(245, 158, 11, 0.2);
            --danger-light: rgba(239, 68, 68, 0.2);
            --work-light: rgba(79, 70, 229, 0.2);
            --personal-light: rgba(139, 92, 246, 0.2);
            --shopping-light: rgba(6, 182, 212, 0.2);
            --health-light: rgba(16, 185, 129, 0.2);
            --finance-light: rgba(245, 158, 11, 0.2);
            --education-light: rgba(239, 68, 68, 0.2);
            --highlight-light: rgba(236, 72, 153, 0.2);
            
            /* Dark shadows */
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.4), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
            --sidebar-shadow: 4px 0 10px -3px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            color: var(--gray-700);
            line-height: 1.7;
            background-color: var(--gray-50);
            min-height: 100vh;
            overflow-x: hidden;
            width: 100%;
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-text-size-adjust: 100%;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            color: var(--gray-800);
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Professional Welcome Animation Styles */
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.8s ease, visibility 0.8s ease;
            overflow: hidden;
        }

        .professional-welcome-container {
            text-align: center;
            color: white;
            position: relative;
            animation: containerFadeIn 1s ease-out;
        }

        /* Logo Animation */
        .logo-animation-container {
            margin-bottom: 3rem;
            position: relative;
        }

        .animated-logo {
            position: relative;
            display: inline-block;
        }

        .logo-circle {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            position: relative;
            animation: logoReveal 2s ease-out, logoPulse 3s ease-in-out infinite 2s;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .logo-circle i {
            font-size: 3rem;
            color: white;
            animation: iconRotate 2s ease-out;
        }

        .logo-particles {
            position: absolute;
            width: 200px;
            height: 200px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: particleFloat 4s ease-in-out infinite;
        }

        .particle:nth-child(1) {
            top: 20%;
            left: 10%;
            animation-delay: 0.5s;
        }

        .particle:nth-child(2) {
            top: 80%;
            right: 10%;
            animation-delay: 1s;
        }

        .particle:nth-child(3) {
            top: 10%;
            right: 30%;
            animation-delay: 1.5s;
        }

        .particle:nth-child(4) {
            bottom: 20%;
            left: 20%;
            animation-delay: 2s;
        }

        .particle:nth-child(5) {
            top: 50%;
            left: 5%;
            animation-delay: 2.5s;
        }

        .particle:nth-child(6) {
            top: 30%;
            right: 5%;
            animation-delay: 3s;
        }

        /* Company Branding */
        .company-branding {
            margin-bottom: 3rem;
        }

        .company-name {
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: 0.1em;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: center;
            gap: 0.1em;
        }

        .letter {
            display: inline-block;
            opacity: 0;
            animation: letterDrop 0.8s ease-out forwards;
        }

        .letter:nth-child(1) { animation-delay: 0.1s; }
        .letter:nth-child(2) { animation-delay: 0.2s; }
        .letter:nth-child(3) { animation-delay: 0.3s; }
        .letter:nth-child(4) { animation-delay: 0.4s; }
        .letter:nth-child(5) { animation-delay: 0.5s; }
        .letter:nth-child(6) { animation-delay: 0.6s; }
        .letter:nth-child(7) { animation-delay: 0.7s; }
        .letter:nth-child(8) { animation-delay: 0.8s; }
        .letter:nth-child(9) { animation-delay: 0.9s; }

        .company-tagline {
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
            animation: fadeInUp 1s ease-out 1.5s forwards;
            opacity: 0;
            letter-spacing: 0.05em;
        }

        /* Loading Animation */
        .loading-container {
            margin-top: 2rem;
            animation: fadeInUp 1s ease-out 2s forwards;
            opacity: 0;
        }

        .loading-bar {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            margin: 0 auto 1rem;
            overflow: hidden;
            position: relative;
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 1));
            border-radius: 2px;
            width: 0;
            animation: loadingProgress 3s ease-out 2.5s forwards;
            position: relative;
        }

        .loading-progress::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.8));
            animation: shimmer 1.5s ease-in-out infinite;
        }

        .loading-text {
            font-size: 0.9rem;
            font-weight: 300;
            opacity: 0.8;
            animation: textPulse 2s ease-in-out infinite;
        }

        /* Animations */
        @keyframes containerFadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes logoReveal {
            0% {
                opacity: 0;
                transform: scale(0.3) rotate(-180deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.1) rotate(0deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        @keyframes logoPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            }
        }

        @keyframes iconRotate {
            0% {
                transform: rotate(-180deg) scale(0.5);
                opacity: 0;
            }
            50% {
                transform: rotate(0deg) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: rotate(0deg) scale(1);
                opacity: 1;
            }
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0px);
                opacity: 0.4;
            }
            50% {
                transform: translateY(-20px);
                opacity: 1;
            }
        }

        @keyframes letterDrop {
            0% {
                opacity: 0;
                transform: translateY(-50px) rotateX(90deg);
            }
            50% {
                transform: translateY(10px) rotateX(0deg);
            }
            100% {
                opacity: 1;
                transform: translateY(0px) rotateX(0deg);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes loadingProgress {
            to {
                width: 100%;
            }
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-20px);
            }
            100% {
                transform: translateX(300px);
            }
        }

        @keyframes textPulse {
            0%, 100% {
                opacity: 0.8;
            }
            50% {
                opacity: 1;
            }
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .company-name {
                font-size: 2.5rem;
            }
            
            .logo-circle {
                width: 80px;
                height: 80px;
            }
            
            .logo-circle i {
                font-size: 2rem;
            }
            
            .loading-bar {
                width: 250px;
            }
        }

        /* App Container */
        .app-container {
            position: relative;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--gray-50);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .app-container.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Header */
        header {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 0.75rem 0;
            transition: all 0.3s ease;
            width: 100%;
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.5px;
        }

        .logo i {
            margin-right: 0.75rem;
            font-size: 2rem;
            background: white;
            color: var(--primary);
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle, .settings-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover, .settings-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }


        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 80px;
            right: -400px;
            width: 350px;
            background: var(--gray-50);
            border-radius: 16px;
            box-shadow: var(--card-shadow-hover);
            z-index: 1100;
            transition: right 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid var(--gray-200);
            overflow: hidden;
        }

        .settings-panel.active {
            right: 20px;
        }

        .settings-content {
            padding: 0;
        }

        .settings-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-gradient);
            color: white;
        }

        .settings-header h3 {
            margin: 0;
            color: white;
            font-size: 1.25rem;
        }

        .settings-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .settings-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .settings-options {
            padding: 1rem;
            background: var(--gray-50);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--gray-100);
            border: 1px solid var(--gray-200);
        }

        .setting-item:hover {
            background: var(--gray-200);
            transform: translateX(5px);
        }

        .setting-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .setting-info i {
            width: 20px;
            text-align: center;
            color: var(--primary);
            font-size: 1.1rem;
        }

        .setting-info span {
            font-weight: 500;
            color: var(--gray-700);
        }

        .setting-toggle .toggle-switch {
            width: 44px;
            height: 22px;
            background-color: var(--gray-300);
            border-radius: 22px;
            position: relative;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .setting-toggle .toggle-switch.active {
            background-color: var(--primary);
        }

        .setting-toggle .toggle-switch-handle {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .setting-toggle .toggle-switch.active .toggle-switch-handle {
            transform: translateX(22px);
        }

        .setting-action {
            color: var(--gray-400);
            transition: all 0.3s ease;
        }

        .setting-item:hover .setting-action {
            color: var(--primary);
            transform: translateX(5px);
        }

        /* Settings Overlay */
        .settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(5px);
            z-index: 1050;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .settings-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Smart Suggestions Container */
.smart-suggestions-container {
    width: 260px;
    min-width: 260px;
    background: linear-gradient(145deg, var(--gray-50) 0%, var(--gray-100) 100%);
    border-radius: 16px;
    box-shadow: var(--card-shadow);
    border: 1px solid var(--gray-200);
    position: sticky;
    top: 90px;
    height: fit-content;
    max-height: calc(100vh - 120px);
    overflow: hidden;
    margin-top: 1rem;
    opacity: 0;
    transform: translateX(-100px) scale(0.9);
    transition: all 1.2s cubic-bezier(0.23, 1, 0.32, 1);
    backdrop-filter: blur(10px);
}

.smart-suggestions-container.visible {
    opacity: 1;
    transform: translateX(0) scale(1);
}

.smart-suggestions-container.animate-from-center {
    animation: slideFromCenter 1.2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes slideFromCenter {
    0% {
        opacity: 0;
        transform: translateX(200px) translateY(-50px) scale(0.8);
    }
    60% {
        opacity: 0.7;
        transform: translateX(-20px) translateY(0) scale(1.05);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

.smart-suggestions-header {
    padding: 1.5rem 1rem 1rem 1rem;
    border-bottom: 1px solid var(--gray-200);
    background: var(--primary-gradient);
    color: white;
}

.smart-suggestions-header h3 {
    font-size: 1.1rem;
    color: white;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.suggestions-status {
    font-size: 0.8rem;
    opacity: 0.9;
    font-weight: 400;
}

.smart-suggestions-content {
    padding: 1rem;
    min-height: 200px;
}

.no-suggestions {
    text-align: center;
    padding: 2rem 1rem;
    color: var(--gray-500);
}

.no-suggestions i {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: var(--gray-300);
    animation: pulse 2s ease-in-out infinite;
}

.no-suggestions p {
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: var(--gray-600);
}

.no-suggestions span {
    font-size: 0.9rem;
    color: var(--gray-400);
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 0.7; }
    50% { transform: scale(1.1); opacity: 1; }
}

/* Smart Suggestion Items */
.suggestion-item {
    background: var(--gray-100);
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    border: 1px solid var(--gray-200);
    transition: all 0.3s ease;
    position: relative;
    cursor: pointer;
}

.suggestion-item:hover {
    background: var(--gray-200);
    transform: translateY(-2px);
    box-shadow: var(--card-shadow);
}

.suggestion-item.fading-out {
    animation: fadeOut 0.6s ease-out forwards;
}

@keyframes fadeOut {
    0% { 
        opacity: 1; 
        transform: translateY(0) scale(1); 
    }
    50% { 
        opacity: 0.5; 
        transform: translateY(-10px) scale(0.98); 
    }
    100% { 
        opacity: 0; 
        transform: translateY(-20px) scale(0.95); 
    }
}

.suggestion-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.suggestion-title {
    font-weight: 600;
    color: var(--gray-800);
    font-size: 0.95rem;
    line-height: 1.3;
    flex: 1;
}

.suggestion-menu-btn {
    background: transparent;
    border: none;
    color: var(--gray-400);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    position: relative;
}

.suggestion-menu-btn:hover {
    background: var(--gray-300);
    color: var(--gray-700);
    transform: scale(1.1);
}

.suggestion-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    color: var(--gray-600);
    margin-bottom: 0.5rem;
}

.suggestion-category {
    background: var(--primary-light);
    color: var(--primary);
    padding: 0.2rem 0.5rem;
    border-radius: 6px;
    font-weight: 500;
}

.suggestion-frequency {
    color: var(--gray-500);
}

.suggestion-description {
    font-size: 0.85rem;
    color: var(--gray-600);
    line-height: 1.4;
}

/* Suggestion Menu Dropdown */
.suggestion-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: var(--gray-50);
    border-radius: 8px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    border: 1px solid var(--gray-200);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px) scale(0.9);
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    z-index: 1000;
    min-width: 120px;
    overflow: hidden;
}

.suggestion-menu.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
}

.suggestion-menu-item {
    padding: 0.75rem 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    border-bottom: 1px solid var(--gray-200);
}

.suggestion-menu-item:last-child {
    border-bottom: none;
}

.suggestion-menu-item:hover {
    background: var(--primary);
    color: white;
    transform: translateX(3px);
}

.suggestion-menu-item.add:hover {
    background: var(--success);
}

.suggestion-menu-item.modify:hover {
    background: var(--secondary);
}

.suggestion-menu-item.forget:hover {
    background: var(--danger);
}

/* Responsive */
@media (max-width: 768px) {
    .smart-suggestions-container {
        width: 100%;
        margin-top: 1rem;
        position: relative;
        top: 0;
    }
}

        /* Main Content */
        .main-content {
            display: flex;
            margin-top: 1rem;
            gap: 2rem;
            height: calc(100vh - 90px);
            width: 100%;
            transition: all 0.3s ease-in-out;
        }

        .sidebar {
    width: fit-content;
    min-width: 260px;
    max-width: 320px;
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
    backdrop-filter: blur(15px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 20px;
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        0 2px 16px rgba(0, 0, 0, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.4),
        inset 0 -1px 0 rgba(0, 0, 0, 0.05);
    padding: 1.5rem 1rem;
    position: sticky;
    top: 90px;
    height: fit-content;
    max-height: calc(100vh - 120px);
    overflow: hidden; /* Changed from overflow-y: auto to hidden to contain categories */
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    position: relative;
}

.sidebar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, 
        rgba(79, 70, 229, 0.05) 0%, 
        rgba(118, 75, 162, 0.03) 30%,
        rgba(6, 182, 212, 0.02) 60%,
        rgba(79, 70, 229, 0.05) 100%);
    border-radius: 20px;
    z-index: -1;
    transition: opacity 0.3s ease;
    opacity: 0;
}

.sidebar:hover::before {
    opacity: 1;
}

.sidebar:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 
        0 16px 40px rgba(0, 0, 0, 0.2),
        0 8px 24px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.5),
        inset 0 -1px 0 rgba(0, 0, 0, 0.1);
    border-color: rgba(79, 70, 229, 0.4);
}

        .sidebar-header {
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    z-index: 2;
}

.sidebar-header h3 {
    font-size: 1.25rem;
    color: var(--gray-800);
    font-weight: 600;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

body.dark-mode .sidebar-header h3 {
    color: var(--gray-200);
}

body.dark-mode .sidebar-header {
    border-bottom-color: rgba(75, 85, 99, 0.3);
}

        /* Improved Category Selection with Sliding Indicator */
        .categories-container {
            position: relative;
            overflow: hidden;
        }

        .category-slider {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.5rem;
    width: 100%;
    max-width: 100%;
    overflow: hidden;
}

.category-slider .category {
    width: 100%;
    margin-bottom: 0; /* Remove margin since we're using gap */
}

        .category {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.875rem 1rem; /* Slightly reduced padding */
    border-radius: 12px;
    margin-bottom: 0.5rem; /* Reduced margin */
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: var(--gray-700);
    font-weight: 500;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    width: 100%; /* Ensure full width usage */
    max-width: 100%; /* Prevent overflow */
    box-sizing: border-box; /* Include padding and border in width */
}

.category::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255, 255, 255, 0.3) 50%, 
        transparent 100%);
    transition: left 0.6s ease;
    z-index: 1;
}

.category:hover::before {
    left: 100%;
}

/* Hover effect with contained movement */
.category:hover:not(.active) {
    background: rgba(255, 255, 255, 0.2);
    transform: translateX(2px) scale(1.01); /* Much smaller movement */
    border-color: rgba(79, 70, 229, 0.3);
    box-shadow: 
        0 4px 12px rgba(79, 70, 229, 0.1), /* Reduced shadow */
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
}

.category.active {
    background: 
        linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%) !important;
    color: white !important;
    transform: translateX(4px) scale(1.02) !important; /* Reduced from translateX(8px) scale(1.05) */
    box-shadow: 
        0 8px 20px rgba(79, 70, 229, 0.4), /* Reduced shadow spread */
        0 4px 12px rgba(79, 70, 229, 0.2),
        0 0 0 1px rgba(79, 70, 229, 0.3), /* Reduced border width */
        inset 0 1px 0 rgba(255, 255, 255, 0.4),
        inset 0 -1px 0 rgba(0, 0, 0, 0.2) !important;
    border-color: rgba(255, 255, 255, 0.6) !important;
    position: relative;
    z-index: 10;
    transition: none !important;
    margin-left: 0; /* Ensure no margin overflow */
    margin-right: 0;
}

/* Full highlight glow effect */
.category.active::before {
    left: 100%;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255, 255, 255, 0.4) 50%, 
        transparent 100%);
    animation: activeShimmer 2s ease-in-out infinite;
}

@keyframes activeShimmer {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}

.category.active::after {
    content: '';
    position: absolute;
    top: 50%;
    right: -6px; /* Reduced from -12px to stay closer */
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border-top: 6px solid transparent; /* Smaller arrow */
    border-bottom: 6px solid transparent;
    border-left: 8px solid var(--primary);
    filter: drop-shadow(2px 0 4px rgba(0, 0, 0, 0.2));
    z-index: 2;
}

/* ADD THE RIPPLE EFFECT CSS HERE */
.category {
    position: relative;
    overflow: hidden;
}

.category.ripple::after {
    content: '';
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.6);
    transform: scale(0);
    animation: rippleEffect 0.6s linear;
    pointer-events: none;
}

@keyframes rippleEffect {
    to {
        transform: scale(4);
        opacity: 0;
    }
}

/* Full-width highlight bar */
.category.active::before {
    content: '';
    position: absolute;
    top: 0;
    left: -1.5rem;
    right: -1.5rem;
    bottom: 0;
    background: 
        linear-gradient(90deg, 
            transparent 0%, 
            rgba(79, 70, 229, 0.1) 10%,
            rgba(79, 70, 229, 0.2) 50%,
            rgba(79, 70, 229, 0.1) 90%,
            transparent 100%);
    border-radius: 20px;
    z-index: -1;
    animation: pulseGlow 3s ease-in-out infinite;
}

@keyframes pulseGlow {
    0%, 100% { 
        opacity: 0.6;
        transform: scale(1);
    }
    50% { 
        opacity: 1;
        transform: scale(1.02);
    }
}

        .task-count {
    background: rgba(255, 255, 255, 0.2);
    color: var(--gray-700);
    font-size: 0.75rem;
    font-weight: 600;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    position: relative;
    z-index: 2;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.category.active .task-count {
    background: rgba(255, 255, 255, 0.4);
    color: white;
    box-shadow: 
        0 4px 12px rgba(0, 0, 0, 0.3),
        0 0 0 2px rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
    font-weight: 700;
}

.category:hover:not(.active) .task-count {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

/* Full container highlight when category is active */
.sidebar:has(.category.active) {
    background: 
        linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.05) 100%),
        linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
    border-color: rgba(79, 70, 229, 0.4);
    box-shadow: 
        0 12px 40px rgba(79, 70, 229, 0.2),
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

/* Fallback for browsers that don't support :has() */
.sidebar.has-active-category {
    background: 
        linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.05) 100%),
        linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
    border-color: rgba(79, 70, 229, 0.4);
    box-shadow: 
        0 12px 40px rgba(79, 70, 229, 0.2),
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

        /* Dark Mode Glass Sidebar */
body.dark-mode .sidebar {
    background: 
        linear-gradient(135deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.15) 100%);
    border-color: rgba(75, 85, 99, 0.4);
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        0 2px 16px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        inset 0 -1px 0 rgba(0, 0, 0, 0.2);
}

body.dark-mode .sidebar:hover {
    box-shadow: 
        0 16px 40px rgba(0, 0, 0, 0.4),
        0 8px 24px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.15),
        inset 0 -1px 0 rgba(0, 0, 0, 0.3);
    border-color: rgba(79, 70, 229, 0.5);
}

body.dark-mode .category {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(75, 85, 99, 0.3);
    color: var(--gray-300);
}

body.dark-mode .category:hover:not(.active) {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(79, 70, 229, 0.4);
    box-shadow: 
        0 8px 25px rgba(79, 70, 229, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

body.dark-mode .task-count {
    background: rgba(255, 255, 255, 0.1);
    color: var(--gray-300);
}

body.dark-mode .category:hover:not(.active) .task-count {
    background: rgba(255, 255, 255, 0.2);
}

/* Dark Mode Full Highlighting */
body.dark-mode .category.active {
    box-shadow: 
        0 15px 35px rgba(79, 70, 229, 0.4),
        0 8px 20px rgba(79, 70, 229, 0.2),
        0 0 0 2px rgba(79, 70, 229, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2),
        inset 0 -1px 0 rgba(0, 0, 0, 0.3);
}

body.dark-mode .sidebar:has(.category.active),
body.dark-mode .sidebar.has-active-category {
    background: 
        linear-gradient(135deg, rgba(79, 70, 229, 0.15) 0%, rgba(118, 75, 162, 0.1) 100%),
        linear-gradient(135deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.15) 100%);
    border-color: rgba(79, 70, 229, 0.5);
    box-shadow: 
        0 12px 40px rgba(79, 70, 229, 0.3),
        0 8px 25px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

body.dark-mode .category.active::before {
    background: 
        linear-gradient(90deg, 
            transparent 0%, 
            rgba(79, 70, 229, 0.2) 10%,
            rgba(79, 70, 229, 0.3) 50%,
            rgba(79, 70, 229, 0.2) 90%,
            transparent 100%);
}

/* Analytics Container */
.analytics-container {
    width: 260px;
    min-width: 260px;
    margin-top: 1.5rem;
    display: flex;
    justify-content: center;
    opacity: 0;
    transform: translateY(20px);
    animation: slideInFromBottom 1s ease-out 1.5s forwards;
}

@keyframes slideInFromBottom {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.analytics-square {
    width: 200px;
    height: 200px;
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
    backdrop-filter: blur(15px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 20px;
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        0 2px 16px rgba(0, 0, 0, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
    padding: 1.5rem;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
}

.analytics-square::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, 
        rgba(79, 70, 229, 0.05) 0%, 
        rgba(118, 75, 162, 0.03) 50%,
        rgba(6, 182, 212, 0.02) 100%);
    border-radius: 20px;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: -1;
}

.analytics-square:hover::before {
    opacity: 1;
}

.analytics-square:hover {
    transform: translateY(-5px) scale(1.02);
    box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.2),
        0 8px 25px rgba(79, 70, 229, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.5);
    border-color: rgba(79, 70, 229, 0.4);
}

.analytics-icon {
    width: 60px;
    height: 60px;
    background: var(--primary-gradient);
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1rem;
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
    position: relative;
    z-index: 2;
}

.analytics-icon i {
    font-size: 1.5rem;
    color: white;
}

.analytics-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--gray-800);
    margin-bottom: 1rem;
    position: relative;
    z-index: 2;
}

.analytics-preview {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    position: relative;
    z-index: 2;
}

.mini-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.mini-stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary);
    line-height: 1;
}

.mini-stat-label {
    font-size: 0.8rem;
    color: var(--gray-600);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.mini-chart {
    display: flex;
    align-items: flex-end;
    gap: 3px;
    height: 30px;
}

.mini-bar {
    width: 6px;
    background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: 3px;
    animation: barGrow 1s ease-out;
    animation-delay: calc(var(--delay, 0) * 0.1s);
}

@keyframes barGrow {
    from { height: 0; }
    to { height: var(--final-height); }
}

/* Dark Mode Analytics */
body.dark-mode .analytics-square {
    background: 
        linear-gradient(135deg, rgba(0, 0, 0, 0.25) 0%, rgba(0, 0, 0, 0.15) 100%);
    border-color: rgba(75, 85, 99, 0.4);
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.3),
        0 2px 16px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

body.dark-mode .analytics-title {
    color: var(--gray-200);
}

body.dark-mode .mini-stat-label {
    color: var(--gray-400);
}

/* iOS-style Animation Overlay */
.ios-animation-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--gray-50);
    z-index: 2500;
    opacity: 0;
    visibility: hidden;
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    transform-origin: center center;
    border-radius: 50%;
    transform: scale(0);
}

.ios-animation-overlay.animate {
    opacity: 1;
    visibility: visible;
    transform: scale(3);
    border-radius: 0;
}

/* Full-Screen Analytics Modal */
.analytics-fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--gray-50);
    z-index: 3000;
    opacity: 0;
    visibility: hidden;
    transform: scale(0.8);
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    overflow-y: auto;
}

.analytics-fullscreen.show {
    opacity: 1;
    visibility: visible;
    transform: scale(1);
}

.analytics-fullscreen-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 2rem;
    border-bottom: 1px solid var(--gray-200);
    background: var(--primary-gradient);
    color: white;
    position: sticky;
    top: 0;
    z-index: 100;
}

.analytics-fullscreen-header h2 {
    margin: 0;
    font-size: 1.5rem;
    color: white;
}

.analytics-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 1.1rem;
}

.analytics-close:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

.analytics-fullscreen-content {
    padding: 2rem;
}

.analytics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    max-width: 1200px;
    margin: 0 auto;
}

.analytics-card {
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 16px;
    padding: 2rem;
    box-shadow: var(--card-shadow);
    transition: all 0.3s ease;
}

.analytics-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--card-shadow-hover);
}

.analytics-card h3 {
    margin-bottom: 1.5rem;
    color: var(--gray-800);
    font-size: 1.2rem;
}

/* Chart Styles */
.analytics-chart {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    height: 150px;
    gap: 1rem;
}

.chart-bar {
    flex: 1;
    background: var(--primary-gradient);
    border-radius: 8px 8px 0 0;
    position: relative;
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 0.5rem;
    transition: all 0.3s ease;
    animation: chartBarGrow 1s ease-out;
}

.chart-bar:hover {
    transform: scale(1.05);
}

.chart-value {
    color: white;
    font-weight: 600;
    font-size: 0.9rem;
}

@keyframes chartBarGrow {
    from { height: 0; }
    to { height: var(--final-height); }
}

/* Category Stats */
.category-stats {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.category-stat {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.category-stat:hover {
    background: rgba(255, 255, 255, 0.8);
    transform: translateX(5px);
}

.category-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.category-dot.work { background: var(--work-color); }
.category-dot.personal { background: var(--personal-color); }
.category-dot.health { background: var(--health-color); }
.category-dot.shopping { background: var(--shopping-color); }

/* Trend Chart */
.trend-chart {
    position: relative;
    height: 150px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    padding: 1rem;
}

.trend-line {
    position: absolute;
    top: 50%;
    left: 10%;
    right: 10%;
    height: 2px;
    background: var(--primary);
    transform: translateY(-50%);
}

.trend-point {
    position: absolute;
    width: 8px;
    height: 8px;
    background: var(--primary);
    border-radius: 50%;
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.3);
    animation: trendPointPulse 2s ease-in-out infinite;
}

@keyframes trendPointPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

/* Quick Stats */
.quick-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 1rem;
}

.quick-stat {
    text-align: center;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.quick-stat:hover {
    background: rgba(255, 255, 255, 0.8);
    transform: translateY(-3px);
}

.quick-stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary);
    display: block;
    margin-bottom: 0.5rem;
}

.quick-stat-label {
    font-size: 0.8rem;
    color: var(--gray-600);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Dark Mode Analytics Full Screen */
body.dark-mode .analytics-fullscreen {
    background: var(--gray-50);
}

body.dark-mode .analytics-card {
    background: 
        linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(31, 41, 55, 0.7) 100%);
    border-color: rgba(75, 85, 99, 0.4);
}

body.dark-mode .analytics-card h3 {
    color: var(--gray-200);
}

body.dark-mode .ios-animation-overlay {
    background: var(--gray-50);
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .analytics-container {
        width: 100%;
        margin-top: 1rem;
    }
    
    .analytics-square {
        width: 180px;
        height: 180px;
        padding: 1rem;
    }
    
    .analytics-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .analytics-fullscreen-content {
        padding: 1rem;
    }
}

/* View More Button for Stat Cards */
.stat-card {
    position: relative;
    overflow: visible;
}

/* View More Button Styles - UPDATED */
.view-more-btn {
    position: absolute;
    bottom: 0.75rem;
    right: 0.75rem;
    background: rgba(79, 70, 229, 0.1);
    border: 1px solid rgba(79, 70, 229, 0.3);
    color: var(--primary);
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    opacity: 0;
    transform: translateY(10px) scale(0.9);
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    backdrop-filter: blur(10px);
    letter-spacing: 0.5px;
    text-transform: uppercase;
    z-index: 10; /* Ensure button is clickable */
}

.stat-card:hover .view-more-btn {
    opacity: 1;
    transform: translateY(0) scale(1);
}

.view-more-btn:hover {
    background: rgba(79, 70, 229, 0.2);
    border-color: rgba(79, 70, 229, 0.5);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
}

/* Ensure stat cards have proper positioning */
.stat-card {
    position: relative;
    overflow: visible;
}

/* Full Screen Analytics Modal - UPDATED */
.analytics-fullscreen-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(135deg, 
        rgba(0, 0, 0, 0.95) 0%, 
        rgba(15, 23, 42, 0.98) 100%);
    backdrop-filter: blur(20px) saturate(180%);
    z-index: 9999; /* Very high z-index */
    opacity: 0;
    visibility: hidden;
    transform: translateY(100vh); /* Start from bottom */
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.analytics-fullscreen-modal.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0); /* Slide up to normal position */
}

.analytics-modal-header {
    position: relative;
    padding: 2rem;
    background: linear-gradient(135deg, 
        rgba(79, 70, 229, 0.1) 0%, 
        rgba(118, 75, 162, 0.05) 100%);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    flex-shrink: 0;
}

.analytics-modal-title {
    color: white;
    font-size: 2rem;
    font-weight: 700;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 1rem;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.analytics-modal-title i {
    font-size: 1.8rem;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.analytics-close-btn {
    position: absolute;
    top: 2rem;
    right: 2rem;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 1.2rem;
    backdrop-filter: blur(10px);
    z-index: 10001;
}

.analytics-close-btn:hover {
    background: rgba(239, 68, 68, 0.2);
    border-color: rgba(239, 68, 68, 0.4);
    transform: scale(1.1) rotate(90deg);
    color: #ef4444;
}

.analytics-modal-content {
    padding: 2rem;
    flex: 1;
    overflow-y: auto;
    color: white;
}

/* Real-time Stats Grid */
.realtime-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.realtime-stat-card {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.1) 0%, 
        rgba(255, 255, 255, 0.05) 100%);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 2rem;
    position: relative;
    overflow: hidden;
    animation: cardSlideIn 0.6s ease-out;
}

.realtime-stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(79, 70, 229, 0.1), 
        transparent);
    animation: shimmer 3s ease-in-out infinite;
}

.realtime-stat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.realtime-stat-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

.realtime-stat-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    background: var(--primary-gradient);
    color: white;
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
}

.realtime-stat-value {
    font-size: 3rem;
    font-weight: 800;
    color: white;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
}

.realtime-stat-details {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.7);
}

/* Animated Progress Rings */
.progress-ring-container {
    margin: 2rem 0;
    display: flex;
    justify-content: center;
    gap: 3rem;
    flex-wrap: wrap;
}

.progress-ring {
    position: relative;
    width: 120px;
    height: 120px;
}

.progress-ring svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.progress-ring-bg,
.progress-ring-fill {
    fill: none;
    stroke-width: 8;
    r: 50;
    cx: 60;
    cy: 60;
}

.progress-ring-bg {
    stroke: rgba(255, 255, 255, 0.1);
}

.progress-ring-fill {
    stroke: url(#gradient);
    stroke-linecap: round;
    stroke-dasharray: 314;
    stroke-dashoffset: 314;
    animation: progressRingFill 2s ease-out forwards;
}

.progress-ring-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: white;
}

.progress-ring-value {
    font-size: 1.5rem;
    font-weight: 700;
    display: block;
}

.progress-ring-label {
    font-size: 0.8rem;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* Interactive Chart Container */
.interactive-chart-container {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.08) 0%, 
        rgba(255, 255, 255, 0.03) 100%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 2rem;
    margin: 2rem 0;
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.chart-title {
    font-size: 1.3rem;
    font-weight: 600;
    color: white;
}

.chart-controls {
    display: flex;
    gap: 0.5rem;
}

.chart-control-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
}

.chart-control-btn.active,
.chart-control-btn:hover {
    background: var(--primary);
    border-color: var(--primary);
}

/* Animations */
@keyframes cardSlideIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

@keyframes progressRingFill {
    from {
        stroke-dashoffset: 314;
    }
    to {
        stroke-dashoffset: var(--progress-offset);
    }
}

/* Enhanced Oval Bar Animations */
@keyframes barGrow {
    from { 
        height: 0%; 
        transform: scaleY(0);
        opacity: 0;
    }
    to { 
        height: var(--final-height, 50%); 
        transform: scaleY(1);
        opacity: 1;
    }
}

@keyframes labelFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(10px) scale(0.8);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }
}

/* Oval Bar Hover Effects */
.trends-chart-container:hover .oval-bar {
    transform: scaleX(1.05);
    transition: transform 0.3s ease;
}

/* Mobile responsive for oval bars */
@media (max-width: 768px) {
    .oval-bar {
        max-width: 35px !important;
    }
    
    .trends-chart-container {
        gap: 0.5rem !important;
    }
}

/* Dark mode adjustments */
body.dark-mode .analytics-fullscreen-modal {
    background: linear-gradient(135deg, 
        rgba(0, 0, 0, 0.98) 0%, 
        rgba(15, 23, 42, 0.95) 100%);
}

/* Mobile responsive */
@media (max-width: 768px) {
    .analytics-modal-title {
        font-size: 1.5rem;
    }
    
    .realtime-stats-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .progress-ring-container {
        gap: 2rem;
    }
    
    .progress-ring {
        width: 100px;
        height: 100px;
    }
}

        /* Broad View Mode Styles */
.main-content.broad-view {
    transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
}

.main-content.broad-view .sidebar {
    transform: translateX(-100%);
    opacity: 0;
    pointer-events: none;
    transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
}

.main-content.broad-view .tasks-container {
    margin-left: -280px; /* Compensate for hidden sidebar */
    width: calc(100% + 280px);
    transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
}

.main-content.broad-view .task-item {
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
}

.main-content.broad-view .task-title {
    font-size: 1.2rem;
}

.main-content.broad-view .task-description {
    font-size: 1rem;
    margin-bottom: 1rem;
}

.main-content.broad-view .task-meta {
    gap: 1rem;
}

/* Broad view toggle button */
.broad-view-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--primary-gradient);
    color: white;
    border: none;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    font-size: 1.2rem;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
    transition: all 0.3s ease;
    z-index: 1000;
    display: none;
}

.broad-view-toggle.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.broad-view-toggle:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
}

        /* Tasks Container */
        .tasks-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: opacity 0.4s ease;
        }

        .tasks-header {
            margin-bottom: 1.5rem;
            position: relative;
            transition: transform 0.3s ease;
        }

       /* Enhanced Search Container */
/* Static Search Container */
.search-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 1.5rem;
    position: relative;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    z-index: 1003;
}


/* Static Search Input - No Movement */
.search-input {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 2.5rem;
    border: 1px solid var(--gray-300);
    border-radius: 12px;
    font-size: 1rem;
    background-color: var(--gray-50);
    box-shadow: var(--card-shadow);
    color: var(--gray-700);
    transition: border-color 0.3s ease, box-shadow 0.3s ease; /* Only border and shadow transition */
}

.search-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 
        0 0 0 3px rgba(79, 70, 229, 0.2),
        var(--card-shadow);
    background-color: white;
    /* NO transform or scale - stays exactly in place */
}

.search-input::placeholder {
    color: var(--gray-500);
    transition: opacity 0.3s ease;
}

.search-input:focus::placeholder {
    opacity: 0.6;
}

/* Static Search Icon */
.search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--gray-500);
    font-size: 1.1rem;
    z-index: 2;
    transition: color 0.3s ease;
    /* NO scale or movement */
}

.search-input:focus + .search-icon {
    color: var(--primary);
    /* NO transform changes */
}

/* Enhanced Search Suggestions */
/* Enhanced Spaced Search Suggestions */
.search-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.98);
    border: 1px solid rgba(79, 70, 229, 0.3);
    border-top: none;
    border-radius: 0 0 16px 16px;
    max-height: 400px; /* Increased height */
    overflow: hidden;
    overflow-y: auto;
    z-index: 1002;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    backdrop-filter: blur(20px);
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(255, 255, 255, 0.8) inset;
}

.search-suggestions.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

/* Enhanced Search Suggestion Items with Metadata */
.search-suggestion-item {
    padding: 1.25rem 1.5rem;
    cursor: pointer;
    transition: all 0.25s ease;
    border-bottom: 1px solid rgba(0, 0, 0, 0.06);
    position: relative;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    min-height: 75px; /* Increased for metadata */
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.search-suggestion-item:last-child {
    border-bottom: none;
    border-radius: 0 0 16px 16px;
}

.search-suggestion-item:hover {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.05) 100%);
    transform: translateX(5px);
    border-left: 4px solid var(--primary);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.15);
}

/* Suggestion Content Layout */
.suggestion-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.suggestion-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
}

.suggestion-title {
    font-weight: 600;
    color: var(--gray-800);
    font-size: 1.05rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    line-height: 1.3;
    flex: 1;
}

.search-suggestion-item:hover .suggestion-title {
    color: var(--primary);
}

.suggestion-title::before {
    content: '🔍';
    font-size: 1rem;
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s ease;
}

.search-suggestion-item:hover .suggestion-title::before {
    opacity: 1;
    transform: scale(1);
}

.suggestion-description {
    font-size: 0.9rem;
    color: var(--gray-600);
    line-height: 1.5;
    margin-left: 2rem;
    transition: color 0.3s ease;
}

.search-suggestion-item:hover .suggestion-description {
    color: var(--gray-700);
}

/* Priority Oval */
.suggestion-priority {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.25rem 0.75rem;
    border-radius: 50px; /* Oval shape */
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    min-width: 60px;
    transition: all 0.3s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.suggestion-priority.high {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
}

.suggestion-priority.medium {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
}

.suggestion-priority.low {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.search-suggestion-item:hover .suggestion-priority {
    transform: scale(1.05);
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
}

/* Metadata Row */
.suggestion-metadata {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
    font-size: 0.8rem;
    opacity: 0.9;
    transition: all 0.3s ease;
    margin-left: 2rem;
}

.search-suggestion-item:hover .suggestion-metadata {
    opacity: 1;
    transform: translateX(2px);
}

/* Category Badge */
.suggestion-category {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    background: rgba(79, 70, 229, 0.1);
    color: var(--primary);
    padding: 0.25rem 0.6rem;
    border-radius: 12px;
    font-weight: 500;
    transition: all 0.3s ease;
    border: 1px solid rgba(79, 70, 229, 0.2);
}

.suggestion-category-icon {
    font-size: 0.9rem;
}

.search-suggestion-item:hover .suggestion-category {
    background: rgba(79, 70, 229, 0.15);
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);
}

/* Due Date Display */
.suggestion-due-date {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    color: var(--gray-600);
    padding: 0.25rem 0.6rem;
    border-radius: 12px;
    background: rgba(0, 0, 0, 0.05);
    font-weight: 500;
    transition: all 0.3s ease;
    border: 1px solid rgba(0, 0, 0, 0.1);
}

.suggestion-due-date.overdue {
    background: rgba(239, 68, 68, 0.1);
    color: #dc2626;
    border-color: rgba(239, 68, 68, 0.2);
}

.suggestion-due-date.due-soon {
    background: rgba(245, 158, 11, 0.1);
    color: #d97706;
    border-color: rgba(245, 158, 11, 0.2);
}

.suggestion-due-date.due-today {
    background: rgba(236, 72, 153, 0.1);
    color: #db2777;
    border-color: rgba(236, 72, 153, 0.2);
}

.suggestion-due-icon {
    font-size: 0.85rem;
}

.search-suggestion-item:hover .suggestion-due-date {
    transform: scale(1.05);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

/* Enhanced highlighting with better spacing */
mark {
    background: linear-gradient(135deg, rgba(236, 72, 153, 0.25) 0%, rgba(236, 72, 153, 0.15) 100%);
    color: var(--highlight-color);
    padding: 0.15rem 0.3rem;
    border-radius: 6px;
    font-weight: 600;
    box-shadow: 0 1px 3px rgba(236, 72, 153, 0.2);
}

/* Mobile Responsive Adjustments */
@media (max-width: 768px) {
    .search-suggestion-item {
        padding: 1rem 1.25rem;
        min-height: 70px;
    }
    
    .suggestion-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .suggestion-priority {
        align-self: flex-end;
        margin-top: -0.5rem;
    }
    
    .suggestion-metadata {
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-left: 1.5rem;
    }
    
    .suggestion-description {
        margin-left: 1.5rem;
    }
    
    .suggestion-category,
    .suggestion-due-date {
        font-size: 0.75rem;
        padding: 0.2rem 0.5rem;
    }
}

/* Enhanced Blur Overlay */
.search-blur-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3); /* Slightly darker */
    backdrop-filter: blur(8px);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s ease;
    pointer-events: none;
}

.search-blur-overlay.active {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

/* No Results State with Better Spacing */
.search-no-results {
    padding: 2rem 1.5rem;
    text-align: center;
    color: var(--gray-500);
    background: rgba(255, 255, 255, 0.9);
    min-height: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
}

.search-no-results .icon {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    color: var(--gray-400);
}

/* Mobile Responsive Spacing */
@media (max-width: 768px) {
    .search-suggestion-item {
        padding: 1rem 1.25rem;
        min-height: 55px;
    }
    
    .search-suggestion-item > div:first-child {
        font-size: 1rem;
        margin-bottom: 0.3rem;
    }
    
    .search-suggestion-item > div:nth-child(2) {
        font-size: 0.85rem;
        margin-left: 1.5rem;
    }
    
    .search-suggestions {
        max-height: 350px;
    }
}

/* Dark Mode Search Suggestions */
body.dark-mode .search-suggestions {
    background: rgba(31, 41, 55, 0.95);
    border-color: rgba(79, 70, 229, 0.4);
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(75, 85, 99, 0.8) inset;
}

body.dark-mode .search-suggestion-item {
    background: rgba(55, 65, 81, 0.8);
    border-bottom-color: rgba(75, 85, 99, 0.3);
    color: var(--gray-300);
}

body.dark-mode .search-suggestion-item:hover {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.15) 0%, rgba(118, 75, 162, 0.1) 100%);
    border-left-color: var(--primary);
}

body.dark-mode .suggestion-title {
    color: var(--gray-200);
}

body.dark-mode .search-suggestion-item:hover .suggestion-title {
    color: var(--primary-light);
}

body.dark-mode .suggestion-description {
    color: var(--gray-400);
}

body.dark-mode .search-suggestion-item:hover .suggestion-description {
    color: var(--gray-300);
}

body.dark-mode .search-no-results {
    background: rgba(55, 65, 81, 0.9);
    color: var(--gray-400);
}

body.dark-mode .suggestion-category {
    background: rgba(79, 70, 229, 0.2);
    border-color: rgba(79, 70, 229, 0.3);
}

body.dark-mode .suggestion-due-date {
    background: rgba(75, 85, 99, 0.3);
    border-color: rgba(75, 85, 99, 0.4);
    color: var(--gray-300);
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
}

/* Enhanced highlighting for search terms */
mark {
    background: linear-gradient(135deg, var(--highlight-light) 0%, rgba(236, 72, 153, 0.2) 100%);
    color: var(--highlight-color);
    padding: 0.1rem 0.2rem;
    border-radius: 3px;
    font-weight: 600;
    animation: highlightPulse 2s ease-in-out infinite;
}

@keyframes highlightPulse {
    0%, 100% { background-size: 100% 100%; }
    50% { background-size: 110% 110%; }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .search-suggestions {
        border-radius: 0 0 15px 15px;
        max-height: 300px;
    }
    
    .search-suggestion-item {
        padding: 0.75rem 1rem;
    }
    
    .search-suggestion-title {
        font-size: 0.9rem;
    }
    
    .search-suggestion-description {
        font-size: 0.8rem;
        padding-left: 1rem;
    }
    
    .search-suggestion-meta {
        padding-left: 1rem;
    }
}

        /* AI Button Styles */
        .ai-task-button-container {
            position: relative;
            display: flex;
            justify-content: center;
            margin: 1.5rem auto 1.5rem auto;
            max-width: 600px;
            opacity: 0;
            transform: translateY(-30px) scale(0.95);
            transition: all 1.2s cubic-bezier(0.23, 1, 0.32, 1);
            padding-top: 20px;
        }

        .ai-task-button-container.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .ai-task-button {
            background: transparent;
            border: 2px solid rgba(102, 126, 234, 0.2);
            color: rgba(102, 126, 234, 0.7);
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .ai-task-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            width: 0%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 25px;
            transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            transform: translateX(-50%);
            z-index: -1;
        }

        .ai-task-button.curtain-fill::before {
            width: 100%;
        }

        .ai-task-button.curtain-fill {
            color: white;
            border-color: transparent;
        }

        .ai-task-button.filled {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .ai-task-button:hover {
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.4);
            border-color: rgba(102, 126, 234, 0.6);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .ai-task-button.filled:hover {
            box-shadow: 
                0 12px 30px rgba(102, 126, 234, 0.5),
                0 0 20px rgba(118, 75, 162, 0.3);
            transition: all 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
        }

        .beta-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff8c00;
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 0.2rem 0.4rem;
            border-radius: 8px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            box-shadow: 0 2px 6px rgba(255, 140, 0, 0.4);
            z-index: 10;
            animation: betaPulse 2s ease-in-out infinite;
        }

        @keyframes betaPulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
        }

        /* Section Title */
        .section-title {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
            gap: 1rem;
        }

        .section-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title h2 {
            font-size: 1.75rem;
            color: var(--gray-800);
            position: relative;
            padding-left: 1rem;
            display: flex;
            align-items: center;
        }

        .section-title h2::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 70%;
            width: 6px;
            background: var(--primary-gradient);
            border-radius: 3px;
            transition: background 0.3s ease;
        }

        .section-title h2 i {
            margin-right: 0.75rem;
            font-size: 1.75rem;
        }

        .category-description {
            color: var(--gray-600);
            margin-top: 0.5rem;
            font-size: 1.1rem;
        }

        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.01em;
            font-size: 1rem;
            touch-action: manipulation;
            min-height: 44px;
        }

        .btn-icon {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(79, 70, 229, 0.4);
        }

        .btn-primary:active {
            transform: translateY(1px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(14, 165, 233, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(14, 165, 233, 0.4);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(239, 68, 68, 0.4);
        }

        .btn-cancel {
            background-color: var(--gray-200);
            color: var(--gray-700);
        }

        .btn-cancel:hover {
            background-color: var(--gray-300);
        }

        .btn-select {
            background-color: var(--gray-50);
            border: 1px solid var(--gray-300);
            padding: 0.5rem 2.5rem 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            appearance: none;
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: calc(100% - 0.75rem) center;
            background-size: 14px;
            transition: all 0.3s ease;
            color: var(--gray-700);
        }

        .btn-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }

        /* Dashboard Section */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            opacity: 1;
            transform: translateY(0);
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        .dashboard.hidden {
            opacity: 0;
            transform: translateY(-20px);
            max-height: 0;
            margin: 0;
            overflow: hidden;
        }

        @keyframes fade-slide-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card {
            background-color: var(--gray-50);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow-hover);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 1.1rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.total {
            background-color: var(--primary);
        }

        .stat-icon.completed {
            background-color: var(--success);
        }

        .stat-icon.pending {
            background-color: var(--warning);
        }

        .stat-icon.overdue {
            background-color: var(--danger);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        .stat-change i {
            margin-right: 0.25rem;
        }

        /* To Be Added Stats Card */
.stat-card.to-be-added-card {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 1px solid #f59e0b;
    transform: translateY(0);
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
}

.stat-card.to-be-added-card.slide-in {
    animation: slideInFromRight 0.8s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

.stat-card.to-be-added-card.slide-out {
    animation: slideOutToRight 0.6s cubic-bezier(0.23, 1, 0.32, 1) forwards;
}

@keyframes slideInFromRight {
    0% {
        opacity: 0;
        transform: translateX(100px) scale(0.9);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

@keyframes slideOutToRight {
    0% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
    100% {
        opacity: 0;
        transform: translateX(100px) scale(0.9);
    }
}

.stat-icon.to-be-added {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
}

/* Replace the existing tickTock animation with this clockwise spin */
.animated-clock {
    animation: clockwiseSpin 3s linear infinite;
    transform-origin: center;
}

@keyframes clockwiseSpin {
    0% { 
        transform: rotate(0deg); 
    }
    100% { 
        transform: rotate(360deg); 
    }
}

.stat-change.scheduled {
    color: #d97706;
    font-weight: 600;
}

/* Dark mode support */
body.dark-mode .stat-card.to-be-added-card {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(217, 119, 6, 0.15) 100%);
    border-color: rgba(245, 158, 11, 0.4);
}

/* Dark mode support */
body.dark-mode .view-tasks-btn {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.8) 0%, rgba(217, 119, 6, 0.8) 100%);
    border-color: rgba(245, 158, 11, 0.6);
}

body.dark-mode .view-tasks-btn:hover {
    background: linear-gradient(135deg, rgba(217, 119, 6, 0.9) 0%, rgba(180, 83, 9, 0.9) 100%);
}

body.dark-mode .scheduled-tasks-modal .modal-header {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.9) 0%, rgba(217, 119, 6, 0.9) 100%);
}

/* Task Options Button and Popup */
.scheduled-task-actions {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    position: relative;
}

.task-options-btn {
    background: rgba(0, 0, 0, 0.1);
    border: none;
    width: 32px;
    height: 32px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    opacity: 0;
    transform: scale(0.8);
    color: var(--text-secondary);
}

.scheduled-task-item:hover .task-options-btn {
    opacity: 1;
    transform: scale(1);
}

.task-options-btn:hover {
    background: rgba(0, 0, 0, 0.2);
    color: var(--text-color);
    transform: scale(1.1);
}

.task-options-btn:active {
    transform: scale(0.95);
}

.task-options-popup {
    position: absolute;
    top: -10px;
    right: 40px;
    background: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.15),
        0 4px 15px rgba(0, 0, 0, 0.1);
    z-index: 1000;
    overflow: hidden;
    backdrop-filter: blur(10px);
    transform: translateY(-10px) scale(0.9);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    min-width: 140px;
}

.task-options-popup.show {
    transform: translateY(0) scale(1);
    opacity: 1;
}

.option-btn {
    width: 100%;
    padding: 0.75rem 1rem;
    border: none;
    background: transparent;
    color: var(--text-color);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    font-weight: 500;
    transition: all 0.2s ease;
    border-bottom: 1px solid var(--border-color);
}

.option-btn:last-child {
    border-bottom: none;
}

.option-btn:hover {
    background: var(--hover-color);
    color: var(--primary-color);
    transform: translateX(2px);
}

.option-btn i {
    font-size: 0.8rem;
    width: 16px;
}

.add-now-btn:hover {
    background: rgba(34, 197, 94, 0.1);
    color: #059669;
}

.reschedule-btn:hover {
    background: rgba(245, 158, 11, 0.1);
    color: #d97706;
}

/* Dark mode support */
body.dark-mode .task-options-btn {
    background: rgba(255, 255, 255, 0.1);
}

body.dark-mode .task-options-btn:hover {
    background: rgba(255, 255, 255, 0.2);
}

body.dark-mode .task-options-popup {
    background: var(--card-background);
    border-color: var(--border-color);
    box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.3),
        0 4px 15px rgba(0, 0, 0, 0.2);
}

/* Reschedule Modal */
.reschedule-modal {
    width: 90%;
    max-width: 500px;
}

.reschedule-modal .modal-header {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
}

.reschedule-form {
    padding: 1.5rem;
}

.task-preview {
    background: var(--hover-color);
    padding: 0.75rem;
    border-radius: 8px;
    font-weight: 600;
    color: var(--text-color);
    border: 1px solid var(--border-color);
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.form-actions {
    display: flex;
    gap: 0.75rem;
    justify-content: flex-end;
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--border-color);
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .form-actions {
        flex-direction: column;
    }
}

/* Mobile responsive */
@media (max-width: 768px) {
    .scheduled-tasks-modal {
        width: 95%;
        max-height: 85vh;
    }
    
    .scheduled-task-item {
        padding: 1rem;
    }
    
    .scheduled-task-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .scheduled-task-title {
        margin-right: 0;
    }
    
    .scheduled-task-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
}

        /* Task List */
        .task-list-wrapper {
            flex: 1;
            overflow-y: auto;
            padding-right: 0.5rem;
            opacity: 1;
            transform: translateY(0);
            transition: transform 0.3s ease, opacity 0.3s ease, padding-top 0.3s ease;
            height: calc(100vh - 400px);
            max-height: 600px;
        }

        .task-list-wrapper.expanded {
            padding-top: 0;
        }

        .task-list-wrapper::-webkit-scrollbar {
            width: 6px;
        }

        .task-list-wrapper::-webkit-scrollbar-track {
            background: var(--gray-200);
            border-radius: 3px;
        }

        .task-list-wrapper::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        .task-list-wrapper::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }

        .task-list {
            background-color: var(--gray-50);
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--gray-200);
            min-height: 300px;
            transition: opacity 0.3s ease;
        }

        /* Task Item Styles */
        .task-item {
            display: flex;
            align-items: center;
            padding: 1.25rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            background-color: var(--gray-100);
            transition: all 0.3s ease;
            border: 1px solid var(--gray-200);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            animation: fade-in 0.5s ease-out, slide-in 0.5s ease-out;
            position: relative;
        }

        .task-item:hover {
            box-shadow: var(--card-shadow-hover);
            transform: translateY(-2px);
            background-color: var(--gray-200);
        }

        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slide-in {
            from { transform: translateX(-20px); }
            to { transform: translateX(0); }
        }

        .task-checkbox {
            margin-right: 1.25rem;
        }

        .task-checkbox input {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid var(--gray-400);
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .task-checkbox input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .task-checkbox input:checked::after {
            content: '✓';
            position: absolute;
            color: white;
            font-size: 16px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .task-content {
            flex: 1;
            position: relative;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--gray-800);
            transition: all 0.2s ease;
            font-size: 1.1rem;
            position: relative;
        }

        .task-description {
            color: var(--gray-600);
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
        }

        .completed .task-title {
            text-decoration: line-through;
            color: var(--gray-400);
        }

        .completed .task-description {
            color: var(--gray-400);
        }

        .task-meta {
            display: flex;
            font-size: 0.9rem;
            color: var(--gray-500);
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .task-category, .task-date, .task-time {
            display: flex;
            align-items: center;
            padding: 0.3rem 0.75rem;
            background-color: var(--gray-50);
            border-radius: 6px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-200);
        }

        .task-category i, .task-date i, .task-time i {
            margin-right: 0.35rem;
            font-size: 0.95rem;
        }

        .task-priority {
            padding: 0.3rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .task-actions {
            display: flex;
            gap: 0.75rem;
        }

        .task-action-btn {
            width: 40px;
            height: 40px;
            background-color: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-600);
            transition: all 0.3s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            font-size: 1.1rem;
            z-index: 2;
            min-width: 44px;
            min-height: 44px;
        }

        .task-action-btn:hover {
            background-color: var(--gray-200);
            color: var(--primary);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .task-action-btn.edit:hover {
            color: var(--secondary);
        }

        .task-action-btn.delete:hover {
            color: var(--danger);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--gray-500);
            background-color: var(--gray-100);
            border-radius: 12px;
            border: 2px dashed var(--gray-300);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .empty-state:hover {
            border-color: var(--primary);
            background-color: var(--gray-200);
            transform: translateY(-5px);
        }

        .empty-state i {
            font-size: 4.5rem;
            margin-bottom: 1.5rem;
            color: var(--gray-300);
            background: linear-gradient(135deg, var(--gray-300) 0%, var(--gray-400) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state h3 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
            color: var(--gray-700);
        }

        .empty-state p {
            font-size: 1.1rem;
            color: var(--gray-500);
        }

        /* Modal Styles */
        .modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    padding: 1rem; /* Add padding for mobile */
}

.modal.active {
    opacity: 1;
    visibility: visible;
    z-index: 2000 !important;
}

.modal-content {
    background-color: var(--gray-50);
    border-radius: 16px;
    width: 100%;
    max-width: 650px;
    max-height: 90vh;
    box-shadow: var(--card-shadow-hover);
    transform: scale(0.9);
    transition: all 0.3s ease;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    border: 1px solid var(--gray-200);
    margin: 0 auto; /* Ensure centering */
}

.modal.active .modal-content {
    transform: scale(1);
}

        .modal-header {
            padding: 1.75rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-gradient);
            color: white;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
        }

        .modal-close {
            background: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: rotate(90deg);
        }

        .modal-body {
    padding: 1.75rem;
    overflow-y: auto;
    background: var(--gray-50);
    flex: 1; /* Allow it to grow */
    display: flex;
    flex-direction: column;
}

.form-group {
    margin-bottom: 1.5rem;
    width: 100%;
    position: relative;
}

.form-control {
    width: 100%;
    padding: 0.9rem 1rem;
    border: 1px solid var(--gray-300);
    border-radius: 8px;
    font-size: 1.05rem;
    transition: all 0.3s ease;
    background-color: var(--gray-50);
    font-size: 16px;
    color: var(--gray-700);
    box-sizing: border-box; /* Ensure padding is included in width */
}

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            background-color: var(--gray-100);
        }

        .form-control::placeholder {
            color: var(--gray-500);
        }

        .form-error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .input-group {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-500);
            font-size: 1.1rem;
        }

        .input-with-icon {
            padding-left: 2.75rem;
        }

        .datetime-input-group {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .date-input {
            flex: 2;
        }

        .time-input {
            flex: 1;
        }

        .time-input-container {
            display: flex;
            flex-direction: column;
        }

        .time-input-field {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px;
            background-color: var(--gray-50);
            transition: all 0.3s ease;
            color: var(--gray-700);
        }

        .time-input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            background-color: var(--gray-100);
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* Priority selector */
        .priority-selector {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .priority-option {
            flex: 1;
            padding: 0.9rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-size: 1.05rem;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--gray-50);
            color: var(--gray-700);
        }

        .priority-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .priority-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .priority-option.low {
            color: var(--success);
        }

        .priority-option.medium {
            color: var(--warning);
        }

        .priority-option.high {
            color: var(--danger);
        }

        .priority-option.low.selected {
            background-color: var(--success-light);
            border-color: var(--success);
        }

        .priority-option.medium.selected {
            background-color: var(--warning-light);
            border-color: var(--warning);
        }

        .priority-option.high.selected {
            background-color: var(--danger-light);
            border-color: var(--danger);
        }

        .priority-option i {
            margin-right: 0.5rem;
        }

        /* Category selector */
        .category-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .category-option {
            padding: 1rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
            color: var(--gray-700);
            position: relative;
            font-size: 1rem;
            min-height: 44px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--gray-50);
        }

        .category-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .category-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .category-option.selected {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        .category-option.work.selected {
            background-color: var(--work-light);
            border-color: var(--work-color);
            color: var(--work-color);
        }

        .category-option.personal.selected {
            background-color: var(--personal-light);
            border-color: var(--personal-color);
            color: var(--personal-color);
        }

        .category-option.shopping.selected {
            background-color: var(--shopping-light);
            border-color: var(--shopping-color);
            color: var(--shopping-color);
        }

        .category-option.health.selected {
            background-color: var(--health-light);
            border-color: var(--health-color);
            color: var(--health-color);
        }

        .category-option.finance.selected {
            background-color: var(--finance-light);
            border-color: var(--finance-color);
            color: var(--finance-color);
        }

        .category-option.education.selected {
            background-color: var(--education-light);
            border-color: var(--education-color);
            color: var(--education-color);
        }

        .category-option i {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        /* Enhanced Task Form Tabs */
.task-form-tabs {
    display: flex;
    border-bottom: 1px solid var(--gray-200);
    margin-bottom: 1.5rem;
    position: relative;
    background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
    border-radius: 12px 12px 0 0;
    padding: 0.5rem;
    box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
}

.task-form-tab {
    padding: 1rem 1.5rem;
    font-weight: 500;
    cursor: pointer;
    position: relative;
    color: var(--gray-600);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    min-height: 44px;
    display: flex;
    align-items: center;
    background: var(--gray-50);
    border-radius: 8px;
    margin: 0 0.25rem;
    transform-origin: center bottom;
    overflow: hidden;
}

.task-form-tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(79, 70, 229, 0.1), transparent);
    transition: left 0.6s ease;
}

.task-form-tab:hover::before {
    left: 100%;
}

.task-form-tab:hover:not(.active) {
    color: var(--gray-800);
    background-color: var(--gray-200);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.15);
}

.task-form-tab.active {
    color: white;
    font-weight: 600;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    transform: translateY(0);
    box-shadow: 
        0 4px 15px rgba(79, 70, 229, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.task-form-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    width: 100%;
    height: 3px;
    background-color: var(--primary);
    border-top-left-radius: 3px;
    border-top-right-radius: 3px;
    box-shadow: 0 2px 8px rgba(79, 70, 229, 0.4);
}

.task-form-content {
    display: none; /* Change from 'block' to 'none' */
    opacity: 0;
    transition: all 0.3s ease;
    width: 100%;
    position: relative; /* Remove absolute positioning */
}

.task-form-content.active {
    display: block;
    opacity: 1;
    position: relative;
    z-index: 2;
}
        /* Filter buttons */
        .task-filters-wrapper {
            position: sticky;
            top: 70px;
            background-color: var(--gray-50);
            z-index: 20;
            padding: 1rem 0;
            margin-bottom: 1rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            transform: translateY(0);
            border-radius: 0 0 12px 12px;
        }

        .task-filters-wrapper.fixed {
            box-shadow: var(--card-shadow);
        }

        .task-filters {
            display: flex;
            gap: 1rem;
        }

        .filter-btn {
            background-color: var(--gray-50);
            border: 1px solid var(--gray-300);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--gray-700);
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background-color: var(--gray-100);
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .task-sort {
            display: flex;
            align-items: center;
            background-color: var(--gray-50);
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--gray-200);
        }

        .sort-label {
            margin-right: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        /* Delete Modal */
        .delete-modal .modal-header {
            background: linear-gradient(135deg, var(--danger) 0%, #ff6b6b 100%);
        }

        .delete-modal .modal-close {
            color: var(--danger);
        }

        .delete-icon {
            font-size: 4rem;
            color: var(--danger);
            margin-bottom: 1.5rem;
            text-align: center;
            display: block;
        }

        .delete-message {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.1rem;
            color: var(--gray-700);
        }

        .delete-message strong {
            color: var(--gray-900);
            display: block;
            font-size: 1.2rem;
            margin-top: 0.5rem;
        }

        /* Notification System */
        .notification-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            width: auto;
            pointer-events: none;
        }

        .notification {
            padding: 0.75rem 1.25rem;
            border-radius: 25px;
            background-color: var(--gray-50);
            color: var(--gray-800);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            font-weight: 500;
            display: flex;
            align-items: center;
            transform: translateY(50px) scale(0.9);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            max-width: 300px;
            width: auto;
            min-width: 200px;
            border: 1px solid var(--gray-200);
            backdrop-filter: blur(10px);
            pointer-events: auto;
            position: relative;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .notification.show {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .notification-icon {
            margin-right: 0.5rem;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .notification.success {
            background-color: var(--success-light);
            color: var(--success);
            border-color: var(--success);
        }

        .notification.warning {
            background-color: var(--warning-light);
            color: var(--warning);
            border-color: var(--warning);
        }

        .notification.error {
            background-color: var(--danger-light);
            color: var(--danger);
            border-color: var(--danger);
        }

        .notification.info {
            background-color: var(--secondary-light);
            color: var(--secondary);
            border-color: var(--secondary);
        }

        /* AI Modal */
        .intelligent-prio-container {
            padding: 2rem;
        }

        .intelligent-prio-options {
            margin-bottom: 2rem;
        }

        .intelligent-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--gray-100);
            border: 2px solid var(--gray-200);
            position: relative;
        }

        .intelligent-option:hover {
            background: var(--gray-200);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .intelligent-option.active {
            background: var(--primary-light);
            border-color: var(--primary);
        }

        .intelligent-option-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .intelligent-option-icon {
            width: 48px;
            height: 48px;
            background: var(--primary);
            color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .intelligent-option-content {
            flex: 1;
        }

        .intelligent-option-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.25rem;
        }

        .intelligent-option-description {
            font-size: 0.9rem;
            color: var(--gray-600);
            line-height: 1.4;
        }

        .intelligent-option-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
            background-color: var(--gray-300);
            border-radius: 24px;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .toggle-switch.active {
            background-color: var(--primary);
        }

        .toggle-switch-handle {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-switch-handle {
            transform: translateX(24px);
        }

        /* Reminder Tab Styles */
        .reminder-time-selector {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-top: 0.5rem;
        }

        .reminder-option {
            flex: 1;
            min-width: 80px;
            padding: 0.75rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
            background: var(--gray-50);
            position: relative;
        }

        .reminder-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .reminder-option label {
            cursor: pointer;
            font-weight: 500;
            color: var(--gray-700);
            margin: 0;
        }

        .reminder-option:hover {
            border-color: var(--primary);
            background: var(--gray-100);
        }

        .reminder-option.selected {
            background: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        .reminder-option.custom {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            color: white;
            border-color: var(--accent);
        }

        .reminder-option.custom.selected {
            background: linear-gradient(135deg, var(--accent-dark) 0%, var(--accent) 100%);
        }

        /* Reminder Notification Banner */
       .reminder-notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    color: #1e293b;
    padding: 1.5rem 2rem;
    border-radius: 12px;
    box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.15),
        0 8px 25px rgba(0, 0, 0, 0.1),
        0 0 0 1px rgba(0, 0, 0, 0.05);
    z-index: 2100;
    transform: translateX(150%);
    opacity: 0;
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    max-width: 420px;
    min-width: 350px;
    border: 1px solid rgba(148, 163, 184, 0.2);
    backdrop-filter: blur(20px);
    font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
}

.reminder-notification.show {
    transform: translateX(0);
    opacity: 1;
}

.reminder-notification-content {
    display: flex;
    align-items: flex-start;
    gap: 1.25rem;
}

.reminder-notification-icon {
    font-size: 1.5rem;
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.reminder-notification-text {
    flex: 1;
    line-height: 1.5;
}

.reminder-notification-title {
    font-weight: 700;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
    color: #0f172a;
    letter-spacing: -0.025em;
}

.reminder-notification-message {
    font-size: 0.95rem;
    color: #475569;
    line-height: 1.6;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

.reminder-notification-time {
    font-size: 0.8rem;
    color: #64748b;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background: rgba(59, 130, 246, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 6px;
    display: inline-block;
}

.reminder-notification-close {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: rgba(148, 163, 184, 0.1);
    border: none;
    width: 28px;
    height: 28px;
    border-radius: 6px;
    color: #64748b;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    font-size: 0.85rem;
    font-weight: 600;
}

.reminder-notification-close:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
    transform: scale(1.1);
}

/* Professional hover effect */
.reminder-notification:hover {
    transform: translateX(-5px) scale(1.02);
    box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.2),
        0 12px 35px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(0, 0, 0, 0.08);
}

/* Dark mode support */
body.dark-mode .reminder-notification {
    background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
    color: #e2e8f0;
    border-color: rgba(71, 85, 105, 0.3);
    box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.4),
        0 8px 25px rgba(0, 0, 0, 0.3),
        0 0 0 1px rgba(71, 85, 105, 0.3);
}

body.dark-mode .reminder-notification-title {
    color: #f1f5f9;
}

body.dark-mode .reminder-notification-message {
    color: #cbd5e1;
}

body.dark-mode .reminder-notification-time {
    color: #94a3b8;
    background: rgba(59, 130, 246, 0.2);
}

body.dark-mode .reminder-notification-close {
    background: rgba(71, 85, 105, 0.2);
    color: #94a3b8;
}

body.dark-mode .reminder-notification-close:hover {
    background: rgba(239, 68, 68, 0.2);
    color: #fca5a5;
}

/* Enhanced animations */
@keyframes reminderPulse {
    0%, 100% { 
        box-shadow: 
            0 10px 30px rgba(0, 0, 0, 0.25),
            0 4px 20px rgba(79, 70, 229, 0.3);
    }
    50% { 
        box-shadow: 
            0 15px 40px rgba(0, 0, 0, 0.3),
            0 8px 30px rgba(79, 70, 229, 0.5);
    }
}

@keyframes bellRing {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-10deg); }
    75% { transform: rotate(10deg); }
}

/* Mobile responsive */
@media (max-width: 768px) {
    .reminder-notification {
        bottom: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
        min-width: none;
        width: calc(100% - 20px);
        padding: 1.25rem 1.5rem;
        transform: translateX(100%);
    }
    
    .reminder-notification.show {
        transform: translateX(0);
    }
    
    .reminder-notification-content {
        gap: 1rem;
    }
    
    .reminder-notification-icon {
        width: 36px;
        height: 36px;
        font-size: 1.25rem;
    }
    
    .reminder-notification-title {
        font-size: 1rem;
    }
    
    .reminder-notification-message {
        font-size: 0.9rem;
    }
}

/* Add Later Styles */
.add-later-options {
    transition: all 0.3s ease;
}

.add-later-preview {
    margin-top: 1rem;
    animation: fadeInUp 0.3s ease-out;
}

.add-later-notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1rem 2.5rem 1rem 1.25rem; /* Added more right padding for close button */
    border-radius: 12px;
    box-shadow: 
        0 8px 25px rgba(102, 126, 234, 0.4),
        0 4px 15px rgba(0, 0, 0, 0.2);
    z-index: 2200;
    transform: translateX(150%);
    opacity: 0;
    transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    max-width: 320px;
    min-width: 280px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(15px);
    font-size: 0.9rem;
}

.add-later-notification.show {
    transform: translateX(0);
    opacity: 1;
}

.add-later-notification-content {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
}

.add-later-notification-icon {
    font-size: 1.25rem;
    flex-shrink: 0;
    width: 32px;
    height: 32px;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: pulse 2s ease-in-out infinite;
}

.add-later-notification-text {
    flex: 1;
    line-height: 1.5;
}

.add-later-notification-title {
    font-weight: 600;
    margin-bottom: 0.25rem;
    font-size: 1rem;
}

.add-later-notification-message {
    font-size: 0.85rem;
    opacity: 0.95;
    margin-bottom: 0.25rem;
    line-height: 1.3;
}

.add-later-notification-details {
    font-size: 0.75rem;
    opacity: 0.8;
    background: rgba(255, 255, 255, 0.1);
    padding: 0.4rem 0.6rem;
    border-radius: 6px;
    margin-top: 0.25rem;
    line-height: 1.2;
}

.add-later-notification-close {
    position: absolute;
    top: 0.75rem;
    right: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    width: 24px;
    height: 24px;
    border-radius: 6px;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    font-size: 0.8rem;
    font-weight: 600;
    z-index: 10; /* Ensure it's on top */
}

.add-later-notification-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

.add-later-notification-close:focus {
    outline: 2px solid rgba(255, 255, 255, 0.5);
    outline-offset: 2px;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Mobile responsive for Add Later notifications */
@media (max-width: 768px) {
    .add-later-notification {
        bottom: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
        min-width: none;
        width: calc(100% - 20px);
        transform: translateY(100%);
        font-size: 0.85rem;
        padding: 1rem 2rem 1rem 1rem; /* Adjusted padding for mobile */
    }
    
    .add-later-notification.show {
        transform: translateY(0);
    }
    
    .add-later-notification-content {
        gap: 0.5rem;
    }
    
    .add-later-notification-icon {
        width: 28px;
        height: 28px;
        font-size: 1.1rem;
    }
    
    .add-later-notification-details {
        font-size: 0.7rem;
        padding: 0.3rem 0.5rem;
    }
    
    .add-later-notification-close {
        top: 0.5rem;
        right: 0.5rem;
        width: 20px;
        height: 20px;
        font-size: 0.75rem;
    }
}

        /* Enhanced Mobile Styles */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                height: auto;
                gap: 1rem;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 300px;
                margin-bottom: 1.5rem;
                overflow-y: auto;
                position: relative;
                top: 0;
            }
            
            .tasks-container {
                height: auto;
            }

            .section-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .section-title h2 {
                font-size: 1.5rem;
            }

            .ai-task-button-container {
                margin: 1rem auto;
                padding-top: 15px;
            }

            .ai-task-button {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .beta-badge {
                font-size: 0.6rem;
                padding: 0.15rem 0.3rem;
                top: -12px;
            }
        }

        /* AI Detection Popup Styles */
.ai-detection-popup {
    position: absolute;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 0.75rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    z-index: 1000;
    opacity: 0;
    transform: translateY(10px) scale(0.9);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: pointer;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    white-space: nowrap;
}

.ai-detection-popup.show {
    opacity: 1;
    transform: translateY(0) scale(1);
}

.ai-detection-popup:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
}

.ai-detection-popup::before {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 50%;
    transform: translateX(-50%);
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-top: 8px solid #667eea;
}

.ai-detection-popup i {
    margin-right: 0.5rem;
    animation: sparkle 1.5s ease-in-out infinite;
}

@keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); }
    50% { transform: scale(1.2) rotate(180deg); }
}

/* Perfect Highlight Wave Animation Styles */
.prioritizing-wave-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%);
    border: 2px solid rgba(102, 126, 234, 0.4);
    border-radius: 8px;
    z-index: 1000;
    pointer-events: none;
    opacity: 0;
    transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(8px);
    box-shadow: 
        0 0 20px rgba(102, 126, 234, 0.3),
        inset 0 0 20px rgba(255, 255, 255, 0.1);
}

.prioritizing-wave-container.active {
    opacity: 1;
    border-color: rgba(102, 126, 234, 0.6);
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
    box-shadow: 
        0 0 30px rgba(102, 126, 234, 0.4),
        inset 0 0 30px rgba(255, 255, 255, 0.15);
}

.task-title-wave {
    font-size: 0.95rem;
    font-weight: 600;
    color: #333;
    text-align: center;
    margin-bottom: 0.5rem;
    animation: titleWave 2s ease-in-out;
    padding: 0 0.75rem;
    text-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    max-width: 90%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    line-height: 1.2;
}

.prioritizing-text {
    font-size: 0.85rem;
    font-weight: 700;
    color: #667eea;
    text-align: center;
    margin-bottom: 0.5rem;
    animation: textWave 2s ease-in-out;
    text-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

.wave-bars {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 0.15rem;
    height: 20px;
    margin-top: 0.25rem;
}

.wave-bar {
    width: 3px;
    background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
    border-radius: 2px;
    animation: waveMotion 1.5s ease-in-out infinite;
    box-shadow: 0 0 8px rgba(102, 126, 234, 0.4);
}

.wave-bar:nth-child(1) { animation-delay: 0s; }
.wave-bar:nth-child(2) { animation-delay: 0.1s; }
.wave-bar:nth-child(3) { animation-delay: 0.2s; }
.wave-bar:nth-child(4) { animation-delay: 0.3s; }
.wave-bar:nth-child(5) { animation-delay: 0.4s; }
.wave-bar:nth-child(6) { animation-delay: 0.3s; }
.wave-bar:nth-child(7) { animation-delay: 0.2s; }
.wave-bar:nth-child(8) { animation-delay: 0.1s; }

/* Perfect container fitting */
.form-group.task-title-container {
    position: relative;
    overflow: visible; /* Allow highlight to show */
}

.form-group.task-title-container .input-group {
    position: relative;
    z-index: 1;
}

/* Enhanced wave animations */
@keyframes textWave {
    0%, 100% { 
        transform: scale(1) translateY(0);
        text-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        opacity: 1;
    }
    25% { 
        transform: scale(1.03) translateY(-1px);
        text-shadow: 0 0 20px rgba(102, 126, 234, 0.7);
        opacity: 0.95;
    }
    50% { 
        transform: scale(1.06) translateY(-2px);
        text-shadow: 0 0 25px rgba(102, 126, 234, 0.9);
        opacity: 1;
    }
    75% { 
        transform: scale(1.03) translateY(-1px);
        text-shadow: 0 0 20px rgba(102, 126, 234, 0.7);
        opacity: 0.95;
    }
}

@keyframes titleWave {
    0%, 100% { 
        transform: scale(1) translateY(0);
        opacity: 0.9;
        color: #333;
    }
    25% { 
        transform: scale(1.02) translateY(-0.5px);
        opacity: 0.95;
        color: #444;
    }
    50% { 
        transform: scale(1.04) translateY(-1px);
        opacity: 1;
        color: #555;
    }
    75% { 
        transform: scale(1.02) translateY(-0.5px);
        opacity: 0.95;
        color: #444;
    }
}

@keyframes waveMotion {
    0%, 100% { 
        height: 6px;
        opacity: 0.6;
        transform: scaleY(1);
    }
    50% { 
        height: 18px;
        opacity: 1;
        transform: scaleY(1.1);
    }
}

/* Smooth fade out animation */
.prioritizing-wave-container.fade-out {
    animation: smoothFadeOut 0.8s ease-out forwards;
}

@keyframes smoothFadeOut {
    0% { 
        opacity: 1; 
        transform: scale(1);
        border-color: rgba(102, 126, 234, 0.6);
    }
    50% { 
        opacity: 0.7; 
        transform: scale(0.99);
        border-color: rgba(102, 126, 234, 0.4);
    }
    100% { 
        opacity: 0; 
        transform: scale(0.97);
        border-color: rgba(102, 126, 234, 0.1);
    }
}

/* Enhanced input styling during animation */
.form-control.wave-active {
    border-color: rgba(102, 126, 234, 0.6);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    background: rgba(102, 126, 234, 0.03);
    transition: all 0.3s ease;
}

/* Perfect highlighting overlay */
.prioritizing-wave-container::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, 
        rgba(102, 126, 234, 0.1) 0%, 
        rgba(118, 75, 162, 0.1) 25%,
        rgba(102, 126, 234, 0.1) 50%,
        rgba(118, 75, 162, 0.1) 75%,
        rgba(102, 126, 234, 0.1) 100%);
    border-radius: 10px;
    z-index: -1;
    animation: highlightPulse 2s ease-in-out infinite;
}

@keyframes highlightPulse {
    0%, 100% { 
        opacity: 0.3;
        transform: scale(1);
    }
    50% { 
        opacity: 0.6;
        transform: scale(1.02);
    }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .task-title-wave {
        font-size: 0.85rem;
        padding: 0 0.5rem;
    }
    
    .prioritizing-text {
        font-size: 0.75rem;
    }
    
    .wave-bars {
        height: 16px;
        gap: 0.1rem;
    }
    
    .wave-bar {
        width: 2.5px;
    }
}

/* Enhanced Version Splash Screen Styles - Compact Version */
.version-splash-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(118, 75, 162, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(6, 182, 212, 0.2) 0%, transparent 50%),
        linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.9) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.8s cubic-bezier(0.23, 1, 0.32, 1);
    backdrop-filter: blur(20px) saturate(180%);
}

.version-splash-overlay.show {
    opacity: 1;
    visibility: visible;
}

/* Enhanced Version Splash Screen Styles with Scrolling */
.version-splash-content {
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);
    backdrop-filter: blur(25px) saturate(200%);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 24px;
    padding: 2rem 2.5rem;
    text-align: center;
    max-width: 580px; /* Slightly wider */
    width: 90%;
    max-height: 85vh; /* Limit height for scrolling */
    overflow: hidden; /* Hide outer scroll */
    display: flex;
    flex-direction: column;
    box-shadow: 
        0 25px 60px rgba(0, 0, 0, 0.3),
        0 10px 30px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: translateY(50px) scale(0.9);
    transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
}

/* Scrollable content area */
.version-splash-scrollable {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding-right: 0.5rem;
    margin-right: -0.5rem;
}

/* Custom scrollbar for splash screen */
.version-splash-scrollable::-webkit-scrollbar {
    width: 8px;
}

.version-splash-scrollable::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.version-splash-scrollable::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
}

.version-splash-scrollable::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}

/* Fixed header and footer */
.version-splash-header {
    flex-shrink: 0;
    margin-bottom: 1.5rem;
}

.version-splash-footer {
    flex-shrink: 0;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Enhanced features list */
.version-splash-features {
    text-align: left;
    margin-bottom: 1.5rem;
}

.version-splash-features li {
    padding: 0.75rem 0;
    color: rgba(255, 255, 255, 0.9);
    display: flex;
    align-items: flex-start;
    font-size: 1rem;
    line-height: 1.5;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    position: relative;
    transition: all 0.3s ease;
}

.version-splash-features li:hover {
    background: rgba(255, 255, 255, 0.05);
    transform: translateX(5px);
    padding-left: 0.5rem;
    border-radius: 8px;
}

/* Add Later Feature Animation */
.add-later-demo-container {
    margin: 1rem 0;
    display: flex;
    justify-content: center;
    opacity: 0;
    animation: fadeInUp 1s ease-out 2s forwards;
}

.mini-add-later-preview {
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 12px;
    padding: 1rem;
    width: 280px;
    position: relative;
    overflow: hidden;
}

.mini-add-later-preview::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    animation: shimmerSweep 3s ease-in-out infinite;
}

@keyframes shimmerSweep {
    0% { left: -100%; }
    100% { left: 100%; }
}

.mini-task-scheduler {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.mini-task-input {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.85rem;
    transition: all 0.3s ease;
}

.mini-schedule-row {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.mini-date-input, .mini-time-input {
    flex: 1;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 6px;
    padding: 0.4rem;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.8rem;
    text-align: center;
}

.mini-schedule-btn {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    border: none;
    border-radius: 8px;
    padding: 0.5rem 1rem;
    color: white;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    animation: pulse 2s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.mini-schedule-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
}

/* Enhanced mobile responsiveness */
@media (max-width: 768px) {
    .version-splash-content {
        padding: 1.5rem;
        margin: 0.5rem;
        max-height: 90vh;
    }
    
    .version-splash-title {
        font-size: 1.5rem;
    }
    
    .version-splash-description {
        font-size: 0.95rem;
    }
    
    .add-later-demo-container {
        margin: 0.5rem 0;
    }
    
    .mini-add-later-preview {
        width: 100%;
        max-width: 260px;
    }
    
    .mini-schedule-row {
        flex-direction: column;
        gap: 0.4rem;
    }
    
    .mini-date-input, .mini-time-input {
        width: 100%;
    }
}

/* Enhanced Action Buttons */
.version-splash-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 2rem;
    flex-wrap: wrap;
}

.version-splash-close,
.version-splash-skip {
    padding: 1rem 2rem;
    border-radius: 20px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(15px);
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    min-width: 180px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.version-splash-close::before,
.version-splash-skip::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
}

.version-splash-close:hover::before,
.version-splash-skip:hover::before {
    left: 100%;
}

.version-splash-close.primary {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
    color: white;
    box-shadow: 0 8px 25px rgba(79, 70, 229, 0.4);
    border-color: rgba(255, 255, 255, 0.4);
}

.version-splash-close.primary:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 15px 40px rgba(79, 70, 229, 0.6);
    background: linear-gradient(135deg, rgba(79, 70, 229, 1) 0%, rgba(118, 75, 162, 1) 100%);
    border-color: rgba(255, 255, 255, 0.6);
}

.version-splash-skip {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.9);
    border-color: rgba(255, 255, 255, 0.3);
}

.version-splash-skip:hover {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    transform: translateY(-2px) scale(1.02);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 8px 20px rgba(255, 255, 255, 0.2);
}

/* Enhanced Add Later Demo */
.enhanced-add-later-demo {
    margin: 1.5rem 0;
    display: flex;
    justify-content: center;
    opacity: 0;
    animation: slideInFromBottom 1s ease-out 2s forwards;
}

@keyframes slideInFromBottom {
    0% {
        opacity: 0;
        transform: translateY(30px) scale(0.9);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.mini-add-later-interface {
    background: 
        linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
    backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 16px;
    padding: 1.5rem;
    width: 320px;
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.4);
}

.mini-add-later-interface::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    animation: interfaceShimmer 4s ease-in-out infinite;
}

@keyframes interfaceShimmer {
    0%, 100% { left: -100%; }
    50% { left: 100%; }
}

.demo-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.demo-title {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.demo-toggle {
    width: 48px;
    height: 24px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 24px;
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.demo-toggle.active {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    border-color: rgba(255, 255, 255, 0.5);
    box-shadow: 0 0 15px rgba(79, 70, 229, 0.4);
}

.demo-toggle-handle {
    position: absolute;
    top: 2px;
    left: 2px;
    width: 18px;
    height: 18px;
    background: white;
    border-radius: 50%;
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.demo-toggle.active .demo-toggle-handle {
    transform: translateX(24px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.demo-form {
    transition: all 0.4s ease;
    opacity: 0.3;
    pointer-events: none;
}

.demo-form.active {
    opacity: 1;
    pointer-events: auto;
}

.demo-task-input {
    width: 100%;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    padding: 0.75rem;
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
    margin-bottom: 1rem;
    transition: all 0.3s ease;
    font-family: inherit;
}

.demo-task-input:focus {
    outline: none;
    border-color: rgba(79, 70, 229, 0.6);
    background: rgba(255, 255, 255, 0.15);
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
}

.demo-datetime-row {
    display: flex;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.demo-date-input, .demo-time-input {
    flex: 1;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    padding: 0.6rem;
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.85rem;
    text-align: center;
    transition: all 0.3s ease;
    font-family: inherit;
}

.demo-preview-box {
    background: rgba(79, 70, 229, 0.15);
    border: 1px solid rgba(79, 70, 229, 0.3);
    border-radius: 10px;
    padding: 0.75rem;
    margin-bottom: 1rem;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.4s ease;
}

.demo-preview-box.show {
    opacity: 1;
    transform: translateY(0);
}

.demo-preview-text {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.8rem;
    line-height: 1.4;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.demo-schedule-btn {
    width: 100%;
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    border: none;
    border-radius: 12px;
    padding: 0.75rem;
    color: white;
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
}

.demo-schedule-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(79, 70, 229, 0.5);
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
}

.demo-schedule-btn:active {
    transform: translateY(0);
    animation: buttonSuccess 0.6s ease-out;
}

@keyframes buttonSuccess {
    0% { background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%); }
    50% { background: linear-gradient(135deg, rgba(16, 185, 129, 0.8) 0%, rgba(5, 150, 105, 0.8) 100%); }
    100% { background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%); }
}

/* Success Animation */
.demo-success-animation {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(16, 185, 129, 0.9);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    font-weight: 600;
    font-size: 0.9rem;
    opacity: 0;
    pointer-events: none;
    transition: all 0.4s ease;
    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
}

.demo-success-animation.show {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1.05);
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .mini-add-later-interface {
        width: 100%;
        max-width: 300px;
        padding: 1.25rem;
    }
    
    .version-splash-actions {
        flex-direction: column;
        align-items: center;
    }
    
    .version-splash-close,
    .version-splash-skip {
        width: 100%;
        max-width: 280px;
    }
    
    .demo-datetime-row {
        flex-direction: column;
        gap: 0.5rem;
    }
}

/* Category Chart Tabs */
.category-chart-tabs {
    display: flex;
    gap: 0.5rem;
    background: rgba(255, 255, 255, 0.05);
    padding: 0.25rem;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.category-tab-btn {
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.7);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    position: relative;
    overflow: hidden;
}

.category-tab-btn:hover {
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.05);
}

.category-tab-btn.active {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
    box-shadow: 0 2px 10px rgba(79, 70, 229, 0.3);
}

.category-tab-btn.active::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* Category Chart Container */
.category-chart-container {
    position: relative;
    overflow: hidden;
}

.category-chart-view {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transform: translateX(50px);
    transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    pointer-events: none;
}

.category-chart-view.active {
    opacity: 1;
    transform: translateX(0);
    pointer-events: all;
    position: relative;
}

/* Category Legend */
.category-legend {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.9);
}

.legend-color {
    width: 16px;
    height: 16px;
    border-radius: 4px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

/* Animated Chart Styles */
.animated-category-item {
    margin-bottom: 1.5rem;
    opacity: 0;
    transform: translateY(20px);
    animation: slideInUp 0.6s ease-out forwards;
}

.animated-category-item:nth-child(1) { animation-delay: 0.1s; }
.animated-category-item:nth-child(2) { animation-delay: 0.2s; }
.animated-category-item:nth-child(3) { animation-delay: 0.3s; }
.animated-category-item:nth-child(4) { animation-delay: 0.4s; }
.animated-category-item:nth-child(5) { animation-delay: 0.5s; }
.animated-category-item:nth-child(6) { animation-delay: 0.6s; }

@keyframes slideInUp {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.category-item-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.5rem;
}

.category-name {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
    text-transform: capitalize;
}

.category-icon {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    color: white;
}

.category-count {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
}

.animated-progress-bar {
    height: 40px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 20px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.animated-progress-fill {
    height: 100%;
    border-radius: 20px;
    position: relative;
    overflow: hidden;
    animation: fillAnimation 1.5s ease-out forwards;
    transform-origin: left;
    transform: scaleX(0);
}

@keyframes fillAnimation {
    to {
        transform: scaleX(1);
    }
}

.animated-progress-fill::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    animation: progressShimmer 2s infinite 1s;
}

@keyframes progressShimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* Fixed Bar Chart Styles */
.bar-chart-container {
    padding: 1rem;
    max-height: 400px;
    overflow-y: auto;
}

.bar-chart-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
    min-height: 50px;
}

.bar-label {
    min-width: 120px;
    max-width: 120px;
    color: rgba(255,255,255,0.9);
    text-transform: capitalize;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    font-weight: 600;
}

.bar-label i {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    font-size: 0.8rem;
    color: white;
}

.bar-container {
    flex: 1;
    height: 35px;
    background: rgba(255,255,255,0.08);
    border-radius: 18px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(255,255,255,0.1);
}

.bar-fill {
    height: 100%;
    border-radius: 18px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 1rem;
    transition: width 0.8s ease-out;
}

.bar-count {
    color: white;
    font-weight: 600;
    font-size: 0.85rem;
    text-shadow: 0 1px 3px rgba(0,0,0,0.4);
    z-index: 2;
    position: relative;
}

/* Animated Line Chart Styles - SPLIT LAYOUT */
.line-chart-container {
    padding: 1rem;
    position: relative;
    height: 400px;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    display: flex;
    gap: 1rem;
}

/* Left side - Category filters */
.category-filters-panel {
    width: 40%;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    max-height: 100%;
    overflow-y: auto;
}

.filters-panel-title {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.category-filter-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.8);
    padding: 0.75rem 1rem;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: space-between;
    text-transform: capitalize;
    width: 100%;
    position: relative;
    overflow: hidden;
}

.category-filter-btn:hover {
    color: rgba(255, 255, 255, 1);
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(4px);
    border-color: rgba(255, 255, 255, 0.2);
}

.category-filter-btn.active {
    color: white;
    transform: translateX(6px);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.category-filter-btn.all-data {
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
    border-color: rgba(79, 70, 229, 0.5);
}

.category-filter-btn.all-data.active {
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
    box-shadow: 0 6px 25px rgba(79, 70, 229, 0.4);
}

.filter-btn-left {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.filter-btn-icon {
    width: 24px;
    height: 24px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    color: white;
    font-weight: 600;
}

.filter-btn-count {
    background: rgba(255, 255, 255, 0.15);
    padding: 0.2rem 0.6rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 700;
    min-width: 24px;
    text-align: center;
}

/* Right side - Chart */
.chart-panel {
    width: 60%;
    display: flex;
    flex-direction: column;
    position: relative;
}

.chart-svg {
    width: 100%;
    height: 280px;
    overflow: visible;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.chart-axis {
    stroke: rgba(255,255,255,0.15);
    stroke-width: 1;
}

.chart-grid {
    stroke: rgba(255,255,255,0.06);
    stroke-width: 0.5;
}

.chart-line {
    fill: none;
    stroke-width: 3;
    stroke-linecap: round;
    stroke-linejoin: round;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
}

.chart-area {
    opacity: 0.08;
}

/* Chart labels at bottom */
.chart-labels-container {
    display: flex;
    justify-content: space-between;
    padding: 0.75rem;
    margin-top: 0.5rem;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.chart-label-item {
    text-align: center;
    color: rgba(255,255,255,0.7);
    font-size: 0.7rem;
    opacity: 0;
    transform: translateY(10px);
    animation: labelFadeIn 0.6s ease-out forwards;
    transition: all 0.3s ease;
}

.chart-label-item .label-icon {
    margin-bottom: 0.2rem;
    font-size: 0.8rem;
}

.chart-label-item .label-name {
    text-transform: capitalize;
    font-weight: 600;
    margin-bottom: 0.1rem;
    font-size: 0.65rem;
}

.chart-label-item .label-count {
    color: rgba(255,255,255,0.5);
    font-size: 0.6rem;
}

/* Active state indicators */
.category-filter-btn.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
    border-radius: 0 2px 2px 0;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .line-chart-container {
        flex-direction: column;
        height: auto;
    }
    
    .category-filters-panel,
    .chart-panel {
        width: 100%;
    }
    
    .chart-svg {
        height: 250px;
    }
}

@keyframes labelFadeIn {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Line chart animations - UPDATED */
@keyframes drawLine {
    from {
        stroke-dasharray: 1500;
        stroke-dashoffset: 1500;
    }
    to {
        stroke-dashoffset: 0;
    }
}

@keyframes fillArea {
    from {
        opacity: 0;
    }
    to {
        opacity: 0.08;
    }
}

@keyframes popPoint {
    0% {
        r: 0;
        opacity: 0;
    }
    80% {
        r: 8;
    }
    100% {
        r: 6;
        opacity: 1;
    }
}

/* Light Mode Analytics Styling */
body:not(.dark-mode) .analytics-fullscreen-modal {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.98) 0%, 
        rgba(248, 250, 252, 0.95) 100%);
    color: var(--gray-800);
}

body:not(.dark-mode) .analytics-modal-header {
    background: linear-gradient(135deg, 
        rgba(79, 70, 229, 0.9) 0%, 
        rgba(118, 75, 162, 0.9) 100%);
    color: white;
}

body:not(.dark-mode) .realtime-stat-card {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.8) 0%, 
        rgba(248, 250, 252, 0.6) 100%);
    border: 1px solid rgba(79, 70, 229, 0.1);
    color: var(--gray-800);
}

body:not(.dark-mode) .realtime-stat-title {
    color: var(--gray-600);
}

body:not(.dark-mode) .realtime-stat-value {
    color: var(--gray-900);
}

body:not(.dark-mode) .realtime-stat-details {
    color: var(--gray-600);
}

body:not(.dark-mode) .interactive-chart-container {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.6) 0%, 
        rgba(248, 250, 252, 0.4) 100%);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .chart-title {
    color: var(--gray-800);
}

body:not(.dark-mode) .chart-control-btn {
    background: rgba(79, 70, 229, 0.1);
    border: 1px solid rgba(79, 70, 229, 0.2);
    color: var(--gray-700);
}

body:not(.dark-mode) .chart-control-btn.active,
body:not(.dark-mode) .chart-control-btn:hover {
    background: var(--primary);
    color: white;
}

body:not(.dark-mode) .category-legend {
    background: rgba(255, 255, 255, 0.4);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .legend-item {
    color: var(--gray-700);
}

body:not(.dark-mode) .bar-chart-container {
    color: var(--gray-800);
}

body:not(.dark-mode) .bar-label {
    color: var(--gray-700);
}

body:not(.dark-mode) .bar-container {
    background: rgba(79, 70, 229, 0.05);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

/* Progress Rings Light Mode */
body:not(.dark-mode) .progress-ring-text {
    color: var(--gray-800);
}

body:not(.dark-mode) .progress-ring-label {
    color: var(--gray-600);
}

/* Chart text colors for light mode */
body:not(.dark-mode) .chart-svg text {
    fill: var(--gray-700);
}

body:not(.dark-mode) .chart-labels-container {
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .chart-label-item {
    color: var(--gray-600);
}

/* Animation keyframes for smooth bar growth */
@keyframes barShimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

@keyframes barGrowHorizontal {
    from { 
        width: 0%; 
        transform: scaleX(0);
    }
    to { 
        width: var(--final-width, 50%); 
        transform: scaleX(1);
    }
}

@keyframes barGrow {
    from { 
        height: 0%; 
        transform: scaleY(0);
    }
    to { 
        height: var(--final-height, 50%); 
        transform: scaleY(1);
    }
}

@keyframes labelFadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* No data state styling */
.no-data-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 300px;
    color: var(--gray-500);
}

body:not(.dark-mode) .no-data-state {
    color: var(--gray-400);
}

.no-data-state i {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.3;
}

.no-data-state h3 {
    margin-bottom: 0.5rem;
    font-size: 1.3rem;
}

.no-data-state p {
    text-align: center;
    max-width: 300px;
    line-height: 1.5;
    opacity: 0.8;
}

/* Compact Category Chart Styles */
.category-legend-compact {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.5rem;
    margin-bottom: 1rem;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.legend-item-compact {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.9);
    padding: 0.25rem;
}

.legend-color-compact {
    width: 12px;
    height: 12px;
    border-radius: 3px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    flex-shrink: 0;
}

.legend-text {
    font-weight: 500;
}

/* Compact Bar Chart Container */
.bar-chart-container-compact {
    padding: 0.5rem 1rem;
    max-height: 220px; /* Ensures perfect fit for 6 bars */
    overflow: hidden;
}

.bar-chart-row-compact {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.75rem; /* Reduced spacing */
    min-height: 32px; /* Compact height */
    max-height: 32px;
}

.bar-label-compact {
    min-width: 100px;
    max-width: 100px;
    color: rgba(255,255,255,0.9);
    display: flex;
    align-items: center;
    font-size: 0.85rem;
    font-weight: 600;
}

.category-name {
    text-transform: capitalize;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.bar-container-compact {
    flex: 1;
    height: 24px; /* Compact bar height */
    background: rgba(255,255,255,0.08);
    border-radius: 12px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(255,255,255,0.1);
}

.bar-fill-compact {
    height: 100%;
    border-radius: 12px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 0.5rem;
    transition: width 0.8s ease-out;
    min-width: 0;
}

.bar-count-compact {
    color: white;
    font-weight: 600;
    font-size: 0.75rem;
    text-shadow: 0 1px 2px rgba(0,0,0,0.4);
    z-index: 2;
    position: relative;
    white-space: nowrap;
}

/* No Data State - Compact */
.no-data-state-compact {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 180px;
    color: rgba(255,255,255,0.6);
    text-align: center;
}

.no-data-state-compact i {
    font-size: 2.5rem;
    margin-bottom: 1rem;
    opacity: 0.3;
}

.no-data-state-compact p {
    margin: 0.25rem 0;
    font-size: 0.9rem;
}

.no-data-state-compact strong {
    color: rgba(255,255,255,0.8);
}

/* Light Mode Compact Styles */
body:not(.dark-mode) .category-legend-compact {
    background: rgba(79, 70, 229, 0.05);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .legend-item-compact {
    color: var(--gray-700);
}

body:not(.dark-mode) .bar-label-compact {
    color: var(--gray-700);
}

body:not(.dark-mode) .bar-container-compact {
    background: rgba(79, 70, 229, 0.05);
    border: 1px solid rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .no-data-state-compact {
    color: var(--gray-500);
}

body:not(.dark-mode) .no-data-state-compact strong {
    color: var(--gray-700);
}

/* View More Button for Category Chart */
.category-view-more-container {
    display: flex;
    justify-content: center;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

.category-view-more-btn {
    background: rgba(79, 70, 229, 0.1);
    border: 1px solid rgba(79, 70, 229, 0.3);
    color: var(--primary);
    padding: 0.6rem 1.2rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    backdrop-filter: blur(10px);
    letter-spacing: 0.5px;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.category-view-more-btn:hover {
    background: rgba(79, 70, 229, 0.2);
    border-color: rgba(79, 70, 229, 0.5);
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
}

.category-view-more-btn i {
    transition: transform 0.3s ease;
}

.category-view-more-btn.expanded i {
    transform: rotate(180deg);
}

/* Expandable Rows */
.expandable-rows {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    opacity: 0;
}

.expandable-rows.expanded {
    max-height: 200px; /* Adjust based on content */
    opacity: 1;
    transition: max-height 0.6s cubic-bezier(0.23, 1, 0.32, 1), 
                opacity 0.4s ease 0.2s;
}

.expandable-rows .bar-chart-row-dynamic {
    transform: translateY(-20px);
    opacity: 0;
    transition: all 0.4s ease;
}

.expandable-rows.expanded .bar-chart-row-dynamic {
    transform: translateY(0);
    opacity: 1;
}

.expandable-rows.expanded .bar-chart-row-dynamic:nth-child(1) {
    transition-delay: 0.1s;
}

.expandable-rows.expanded .bar-chart-row-dynamic:nth-child(2) {
    transition-delay: 0.2s;
}

/* Dark mode support for view more button */
body.dark-mode .category-view-more-btn {
    background: rgba(79, 70, 229, 0.15);
    border-color: rgba(79, 70, 229, 0.4);
}

body.dark-mode .category-view-more-btn:hover {
    background: rgba(79, 70, 229, 0.25);
    border-color: rgba(79, 70, 229, 0.6);
}

/* Responsive Design for Smaller Screens */
@media (max-width: 768px) {
    .category-legend-compact {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.4rem;
        padding: 0.5rem;
    }
    
    .legend-item-compact {
        font-size: 0.75rem;
    }
    
    .bar-chart-row-compact {
        margin-bottom: 0.5rem;
        min-height: 28px;
        max-height: 28px;
    }
    
    .bar-label-compact {
        min-width: 80px;
        max-width: 80px;
        font-size: 0.8rem;
    }
    
    .bar-container-compact {
        height: 20px;
    }
    
    .bar-count-compact {
        font-size: 0.7rem;
        padding-right: 0.4rem;
    }
}

/* Perfect Fit Animation */
@keyframes barGrowHorizontal {
    from { 
        width: 0%; 
        transform: scaleX(0);
        transform-origin: left;
    }
    to { 
        width: var(--final-width, 50%); 
        transform: scaleX(1);
        transform-origin: left;
    }
}

@keyframes barShimmer {
    0% { left: -100%; }
    100% { left: 100%; }
}

.interactive-chart-container {
    max-height: 560px; /* Increased for better category visibility */
    overflow: hidden;
}

#categoryBarChart {
    height: 320px !important; /* Force exact height */
    max-height: 320px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* Dynamic Category Chart Styles */
.chart-status-header {
    margin-bottom: 1rem;
    padding: 0.75rem 1rem;
    border-radius: 10px;
    text-align: center;
    font-weight: 600;
    transition: all 0.3s ease;
}

.chart-active-status {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%);
    color: rgba(16, 185, 129, 0.9);
    border: 1px solid rgba(16, 185, 129, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.chart-empty-status {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.15) 0%, rgba(107, 114, 128, 0.1) 100%);
    color: rgba(156, 163, 175, 0.9);
    border: 1px solid rgba(156, 163, 175, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.bar-chart-container-dynamic {
    padding: 0.5rem 1rem;
    max-height: 280px; /* Reduced since we're only showing 4 initially */
    overflow: hidden;
}

.bar-chart-row-dynamic {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.75rem; /* Reduced from 0.9rem to fit more bars */
    min-height: 36px; /* Reduced from 40px */
    max-height: 36px;
    transition: all 0.3s ease;
    position: relative;
    padding: 0.2rem 0; /* Reduced padding */
}

.bar-chart-row-dynamic.has-data {
    transform: scale(1.02);
}

.bar-chart-row-dynamic.no-data {
    opacity: 0.7;
}

.bar-label-dynamic {
    min-width: 110px;
    max-width: 110px;
    color: rgba(255,255,255,0.9);
    display: flex;
    align-items: center;
    font-size: 0.9rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

.category-name-dynamic {
    text-transform: capitalize;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: color 0.3s ease;
}

.bar-chart-row-dynamic.has-data .category-name-dynamic {
    color: rgba(255,255,255,1);
}

.bar-chart-row-dynamic.no-data .category-name-dynamic {
    color: rgba(255,255,255,0.6);
}

.bar-container-dynamic {
    flex: 1;
    height: 28px;
    position: relative;
    border-radius: 14px;
    overflow: hidden;
}

.bar-fill-dynamic {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 0.6rem;
    z-index: 2;
    min-width: 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.bar-count-dynamic {
    color: white;
    font-weight: 700;
    font-size: 0.8rem;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    z-index: 3;
    position: relative;
    white-space: nowrap;
}

.bar-shimmer-dynamic {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmerMove 2.5s infinite;
    z-index: 1;
}

.no-data-indicator {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: rgba(255,255,255,0.4);
    font-size: 0.8rem;
    font-style: italic;
    z-index: 1;
    pointer-events: none;
}

.progress-percentage {
    min-width: 50px;
    text-align: right;
    color: rgba(255,255,255,0.8);
    font-size: 0.8rem;
    font-weight: 600;
}

.chart-footer-dynamic {
    margin-top: 1rem;
    padding: 0.75rem;
    text-align: center;
    border-radius: 8px;
    font-size: 0.85rem;
    transition: all 0.3s ease;
}

.activity-summary {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%);
    color: rgba(79, 70, 229, 0.9);
    border: 1px solid rgba(79, 70, 229, 0.2);
    padding: 0.5rem;
    border-radius: 8px;
}

.empty-state-message {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.1) 0%, rgba(107, 114, 128, 0.05) 100%);
    color: rgba(156, 163, 175, 0.8);
    border: 1px solid rgba(156, 163, 175, 0.2);
    padding: 0.5rem;
    border-radius: 8px;
    font-style: italic;
}

/* Dynamic Animations */
@keyframes barGrowDynamic {
    from { 
        width: 0%; 
        transform: scaleX(0);
        transform-origin: left;
        box-shadow: none;
    }
    50% {
        transform: scaleX(1.05);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    to { 
        width: var(--final-width, 50%); 
        transform: scaleX(1);
        transform-origin: left;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
}

@keyframes shimmerMove {
    0% { left: -100%; }
    100% { left: 100%; }
}

/* Light Mode Dynamic Styles */
body:not(.dark-mode) .chart-active-status {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
    color: rgba(5, 150, 105, 0.9);
    border-color: rgba(16, 185, 129, 0.2);
}

body:not(.dark-mode) .chart-empty-status {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(75, 85, 99, 0.05) 100%);
    color: rgba(75, 85, 99, 0.8);
    border-color: rgba(107, 114, 128, 0.2);
}

body:not(.dark-mode) .bar-label-dynamic {
    color: var(--gray-700);
}

body:not(.dark-mode) .bar-chart-row-dynamic.has-data .category-name-dynamic {
    color: var(--gray-800);
}

body:not(.dark-mode) .bar-chart-row-dynamic.no-data .category-name-dynamic {
    color: var(--gray-500);
}

body:not(.dark-mode) .no-data-indicator {
    color: var(--gray-400);
}

body:not(.dark-mode) .progress-percentage {
    color: var(--gray-600);
}

body:not(.dark-mode) .activity-summary {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.04) 100%);
    color: rgba(79, 70, 229, 0.9);
    border-color: rgba(79, 70, 229, 0.15);
}

body:not(.dark-mode) .empty-state-message {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.08) 0%, rgba(75, 85, 99, 0.04) 100%);
    color: var(--gray-600);
    border-color: rgba(107, 114, 128, 0.15);
}

body:not(.dark-mode) .bar-track {
    background: rgba(79, 70, 229, 0.05) !important;
    border-color: rgba(79, 70, 229, 0.1) !important;
}

/* Responsive Design */
@media (max-width: 768px) {
    .bar-chart-row-dynamic {
        margin-bottom: 0.6rem; /* Even more compact on mobile */
        min-height: 32px;
        max-height: 32px;
    }
    
    .bar-label-dynamic {
        min-width: 90px;
        max-width: 90px;
        font-size: 0.8rem;
    }
    
    .bar-container-dynamic {
        height: 24px;
    }
    
    .bar-count-dynamic {
        font-size: 0.75rem;
        padding-right: 0.4rem;
    }
    
    .progress-percentage {
        min-width: 40px;
        font-size: 0.75rem;
    }
    
    .chart-status-header {
        font-size: 0.85rem;
        padding: 0.6rem 0.8rem;
    }
}

/* Hover Effects */
.bar-chart-row-dynamic:hover {
    transform: translateX(3px);
}

.bar-chart-row-dynamic.has-data:hover {
    transform: translateX(3px) scale(1.02);
}

.bar-chart-row-dynamic:hover .bar-fill-dynamic {
    box-shadow: 0 4px 15px rgba(0,0,0,0.25);
}

/* Enhanced Category Chart Styles */
.chart-status-header-enhanced {
    margin-bottom: 1.2rem;
    padding: 1rem;
    border-radius: 12px;
    transition: all 0.3s ease;
}

.chart-active-status-enhanced {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 12px;
    padding: 0.75rem;
}

.status-main {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    color: rgba(16, 185, 129, 0.9);
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

.status-breakdown {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    font-size: 0.9rem;
}

.completed-badge {
    background: rgba(16, 185, 129, 0.2);
    color: rgba(16, 185, 129, 1);
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-weight: 600;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.pending-badge {
    background: rgba(245, 158, 11, 0.2);
    color: rgba(245, 158, 11, 1);
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-weight: 600;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.chart-empty-status-enhanced {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.15) 0%, rgba(107, 114, 128, 0.1) 100%);
    color: rgba(156, 163, 175, 0.9);
    border: 1px solid rgba(156, 163, 175, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 12px;
    font-weight: 600;
}

.bar-chart-container-enhanced {
    padding: 0.5rem 1rem;
    max-height: 360px;
    overflow: hidden;
}

.bar-chart-row-enhanced {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.9rem;
    min-height: 40px;
    max-height: 40px;
    transition: all 0.3s ease;
    position: relative;
    padding: 0.25rem 0;
}

.bar-chart-row-enhanced.has-data {
    transform: scale(1.01);
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px;
}

.bar-chart-row-enhanced.no-data {
    opacity: 0.7;
}

.bar-label-enhanced {
    min-width: 130px;
    max-width: 130px;
    display: flex;
    align-items: center;
    transition: all 0.3s ease;
}

.category-info {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
}

.category-name-enhanced {
    text-transform: capitalize;
    font-size: 0.9rem;
    font-weight: 600;
    color: rgba(255,255,255,0.9);
    line-height: 1.2;
}

.category-count {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.6);
    font-weight: 500;
}

.bar-chart-row-enhanced.has-data .category-name-enhanced {
    color: rgba(255,255,255,1);
}

.bar-chart-row-enhanced.has-data .category-count {
    color: rgba(255,255,255,0.8);
}

.bar-container-enhanced {
    flex: 1;
    height: 32px;
    position: relative;
    border-radius: 16px;
    overflow: hidden;
}

.bar-track-enhanced {
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.05);
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.1);
    position: absolute;
    top: 0;
    left: 0;
}

.bar-stack {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 16px;
    overflow: hidden;
}

.bar-fill-completed {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    transition: width 0.8s ease-out;
}

.bar-fill-pending {
    position: absolute;
    top: 0;
    height: 100%;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    transition: all 0.8s ease-out;
    overflow: hidden;
}

.bar-segment-count {
    color: white;
    font-weight: 700;
    font-size: 0.75rem;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    z-index: 4;
    position: relative;
    white-space: nowrap;
}

.bar-shimmer-enhanced {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmerMove 2.5s infinite;
    z-index: 1;
}

.no-data-indicator-enhanced {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: rgba(255,255,255,0.4);
    font-size: 0.8rem;
    font-style: italic;
    z-index: 1;
    pointer-events: none;
    transition: opacity 0.4s ease;
}

.task-breakdown {
    min-width: 60px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
}

.breakdown-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    font-size: 0.75rem;
}

.breakdown-item.completed {
    color: rgba(16, 185, 129, 0.9);
}

.breakdown-item.pending {
    color: rgba(245, 158, 11, 0.9);
}

.breakdown-count {
    font-weight: 700;
    min-width: 20px;
    text-align: center;
}

.breakdown-label {
    font-size: 0.7rem;
}

.breakdown-empty {
    color: rgba(255,255,255,0.3);
    font-size: 0.8rem;
}

/* Enhanced Footer */
.chart-footer-enhanced {
    margin-top: 1.2rem;
    padding: 0.75rem;
    text-align: center;
    border-radius: 10px;
    transition: all 0.3s ease;
}

.chart-legend {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 0.75rem;
}

.legend-item-enhanced {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: rgba(255,255,255,0.8);
}

.legend-color {
    width: 14px;
    height: 14px;
    border-radius: 7px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}

.legend-color.completed {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.legend-color.pending {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.activity-summary-enhanced {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%);
    color: rgba(79, 70, 229, 0.9);
    border: 1px solid rgba(79, 70, 229, 0.2);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    display: inline-block;
}

.empty-state-message-enhanced {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.1) 0%, rgba(107, 114, 128, 0.05) 100%);
    color: rgba(156, 163, 175, 0.8);
    border: 1px solid rgba(156, 163, 175, 0.2);
    padding: 0.75rem 1rem;
    border-radius: 20px;
    font-style: italic;
    font-size: 0.9rem;
}

/* Enhanced Animations */
@keyframes barGrowEnhanced {
    from { 
        width: 0%; 
        transform: scaleX(0);
        transform-origin: left;
        box-shadow: none;
    }
    50% {
        transform: scaleX(1.03);
    }
    to { 
        width: var(--final-width, 50%); 
        transform: scaleX(1);
        transform-origin: left;
    }
}

/* Light Mode Enhanced Styles */
body:not(.dark-mode) .chart-active-status-enhanced {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
    border-color: rgba(16, 185, 129, 0.2);
}

body:not(.dark-mode) .status-main {
    color: rgba(5, 150, 105, 0.9);
}

body:not(.dark-mode) .completed-badge {
    background: rgba(16, 185, 129, 0.15);
    color: rgba(5, 150, 105, 1);
    border-color: rgba(16, 185, 129, 0.25);
}

body:not(.dark-mode) .pending-badge {
    background: rgba(245, 158, 11, 0.15);
    color: rgba(217, 119, 6, 1);
    border-color: rgba(245, 158, 11, 0.25);
}

body:not(.dark-mode) .chart-empty-status-enhanced {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(75, 85, 99, 0.05) 100%);
    color: rgba(75, 85, 99, 0.8);
    border-color: rgba(107, 114, 128, 0.2);
}

body:not(.dark-mode) .category-name-enhanced {
    color: var(--gray-700);
}

body:not(.dark-mode) .category-count {
    color: var(--gray-500);
}

body:not(.dark-mode) .bar-chart-row-enhanced.has-data .category-name-enhanced {
    color: var(--gray-800);
}

body:not(.dark-mode) .bar-chart-row-enhanced.has-data .category-count {
    color: var(--gray-600);
}

body:not(.dark-mode) .bar-track-enhanced {
    background: rgba(79, 70, 229, 0.05) !important;
    border-color: rgba(79, 70, 229, 0.1) !important;
}

body:not(.dark-mode) .no-data-indicator-enhanced {
    color: var(--gray-400);
}

body:not(.dark-mode) .breakdown-item.completed {
    color: rgba(5, 150, 105, 0.9);
}

body:not(.dark-mode) .breakdown-item.pending {
    color: rgba(217, 119, 6, 0.9);
}

body:not(.dark-mode) .breakdown-empty {
    color: var(--gray-300);
}

body:not(.dark-mode) .legend-item-enhanced {
    color: var(--gray-600);
}

body:not(.dark-mode) .activity-summary-enhanced {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.04) 100%);
    color: rgba(79, 70, 229, 0.9);
    border-color: rgba(79, 70, 229, 0.15);
}

body:not(.dark-mode) .empty-state-message-enhanced {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.08) 0%, rgba(75, 85, 99, 0.04) 100%);
    color: var(--gray-600);
    border-color: rgba(107, 114, 128, 0.15);
}

/* Responsive Design */
@media (max-width: 768px) {
    .bar-chart-row-enhanced {
        margin-bottom: 0.7rem;
        min-height: 36px;
        max-height: 36px;
    }
    
    .bar-label-enhanced {
        min-width: 110px;
        max-width: 110px;
    }
    
    .category-name-enhanced {
        font-size: 0.8rem;
    }
    
    .category-count {
        font-size: 0.7rem;
    }
    
    .bar-container-enhanced {
        height: 28px;
    }
    
    .bar-segment-count {
        font-size: 0.7rem;
    }
    
    .task-breakdown {
        min-width: 50px;
    }
    
    .breakdown-item {
        font-size: 0.7rem;
    }
    
    .chart-legend {
        gap: 1rem;
    }
    
    .legend-item-enhanced {
        font-size: 0.8rem;
    }
    
    .status-breakdown {
        gap: 1rem;
        font-size: 0.8rem;
    }
}

/* Hover Effects */
.bar-chart-row-enhanced:hover {
    transform: translateX(2px);
    background: rgba(255, 255, 255, 0.04) !important;
}

.bar-chart-row-enhanced.has-data:hover {
    transform: translateX(2px) scale(1.01);
}

.bar-chart-row-enhanced:hover .bar-fill-completed,
.bar-chart-row-enhanced:hover .bar-fill-pending {
    box-shadow: 0 4px 15px rgba(0,0,0,0.25);
}

/* Scrollable Category Chart Styles */
.chart-status-header-scrollable {
    position: sticky;
    top: 0;
    z-index: 10;
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 1rem;
    backdrop-filter: blur(15px);
}

.chart-active-status-scrollable {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.overall-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
}

.stat-group {
    text-align: center;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.15);
    transition: all 0.3s ease;
}

.stat-group:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.stat-group.danger {
    background: rgba(239, 68, 68, 0.15);
    border-color: rgba(239, 68, 68, 0.3);
}

.stat-number {
    display: block;
    font-size: 1.5rem;
    font-weight: 700;
    color: rgba(16, 185, 129, 1);
    margin-bottom: 0.25rem;
}

.stat-group.danger .stat-number {
    color: rgba(239, 68, 68, 1);
}

.stat-label {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.completion-progress {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.progress-bar-container {
    flex: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    overflow: hidden;
}

.progress-bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981 0%, #059669 100%);
    border-radius: 4px;
    transition: width 1s ease-out;
    box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
}

.progress-text {
    font-weight: 600;
    color: rgba(16, 185, 129, 1);
    font-size: 0.9rem;
    min-width: 80px;
}

.chart-empty-status-scrollable {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.15) 0%, rgba(107, 114, 128, 0.1) 100%);
    border: 1px solid rgba(156, 163, 175, 0.3);
    border-radius: 12px;
    color: rgba(156, 163, 175, 0.9);
    font-weight: 600;
}

/* Scrollable Container */
.category-analytics-scrollable {
    max-height: 300px;
    overflow-y: auto;
    overflow-x: hidden;
    position: relative;
    padding-right: 0.5rem;
    margin-right: -0.5rem;
}

.category-analytics-scrollable::-webkit-scrollbar {
    width: 8px;
}

.category-analytics-scrollable::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

.category-analytics-scrollable::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.6) 0%, rgba(118, 75, 162, 0.6) 100%);
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.category-analytics-scrollable::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
}

.scroll-hint {
    position: sticky;
    top: 0;
    background: rgba(79, 70, 229, 0.1);
    color: rgba(79, 70, 229, 0.9);
    padding: 0.5rem;
    text-align: center;
    font-size: 0.8rem;
    border-radius: 8px;
    margin-bottom: 0.75rem;
    border: 1px solid rgba(79, 70, 229, 0.2);
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    z-index: 5;
}

.scroll-hint.visible {
    opacity: 1;
    transform: translateY(0);
}

.scroll-hint i {
    margin-right: 0.5rem;
    animation: bounce 2s infinite;
}

/* Category Analytics Cards */
.category-cards-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.category-analytics-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 1.5rem;
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(20px);
    animation: cardSlideIn 0.6s ease-out forwards;
    backdrop-filter: blur(10px);
}

.category-analytics-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border-color: rgba(255, 255, 255, 0.2);
}

.category-analytics-card.has-data {
    border-left: 4px solid;
}

.category-analytics-card.has-data:nth-child(1) { border-left-color: #4f46e5; }
.category-analytics-card.has-data:nth-child(2) { border-left-color: #8b5cf6; }
.category-analytics-card.has-data:nth-child(3) { border-left-color: #06b6d4; }
.category-analytics-card.has-data:nth-child(4) { border-left-color: #10b981; }
.category-analytics-card.has-data:nth-child(5) { border-left-color: #f59e0b; }
.category-analytics-card.has-data:nth-child(6) { border-left-color: #ef4444; }

/* Card Header */
.card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.25rem;
}

.category-icon-large {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

.category-title-section {
    flex: 1;
}

.category-title {
    font-size: 1.2rem;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.95);
    margin-bottom: 0.25rem;
    text-transform: capitalize;
}

.category-subtitle {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
}

.completion-badge {
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: 700;
    font-size: 0.9rem;
    text-align: center;
    min-width: 60px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.completion-badge.high {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
}

.completion-badge.medium {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
}

.completion-badge.low {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    color: white;
}

.completion-badge.none {
    background: rgba(107, 114, 128, 0.2);
    color: rgba(107, 114, 128, 0.8);
    border: 1px solid rgba(107, 114, 128, 0.3);
}

/* Progress Section */
.card-progress-section {
    margin-bottom: 1.25rem;
}

.mini-chart {
    height: 20px;
    position: relative;
}

.mini-bar-track {
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.15);
}

.mini-bar-completed,
.mini-bar-pending {
    position: absolute;
    top: 0;
    height: 100%;
    border-radius: 10px;
    transition: width 0.8s ease-out;
}

.mini-bar-completed {
    left: 0;
    z-index: 2;
}

.mini-bar-pending {
    z-index: 1;
}

/* Analytics Grid */
.analytics-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 1.25rem;
}

.analytics-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.analytics-item:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
}

.analytics-item.danger {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.3);
}

.analytics-item.highlight {
    background: rgba(139, 92, 246, 0.1);
    border-color: rgba(139, 92, 246, 0.3);
}

.analytics-item i {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
}

.analytics-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.95);
    margin-bottom: 0.25rem;
}

.analytics-label {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.7);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    text-align: center;
}

/* Priority Breakdown */
.priority-breakdown {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 1rem;
    border: 1px solid rgba(255, 255, 255, 0.08);
}

.priority-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
    margin-bottom: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.priority-bars {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.priority-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.priority-label {
    min-width: 60px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.priority-label.high { color: #ef4444; }
.priority-label.medium { color: #f59e0b; }
.priority-label.low { color: #10b981; }

.priority-bar {
    flex: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.priority-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.8s ease-out;
}

.priority-fill.high { background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%); }
.priority-fill.medium { background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%); }
.priority-fill.low { background: linear-gradient(90deg, #10b981 0%, #059669 100%); }

.priority-count {
    min-width: 30px;
    text-align: center;
    font-size: 0.8rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.8);
}

/* No Data State */
.no-data-analytics {
    text-align: center;
    padding: 2rem 1rem;
    color: rgba(255, 255, 255, 0.6);
}

.no-data-analytics i {
    font-size: 3rem;
    margin-bottom: 1rem;
    color: rgba(255, 255, 255, 0.3);
}

.no-data-analytics p {
    margin-bottom: 1.5rem;
    font-size: 0.9rem;
    line-height: 1.4;
}

.create-task-btn {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 20px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
}

.create-task-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
}

/* Fixed Footer */
.category-summary-footer {
    position: sticky;
    bottom: 0;
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%);
    border: 1px solid rgba(79, 70, 229, 0.2);
    border-radius: 12px;
    padding: 1rem;
    margin-top: 1rem;
    text-align: center;
    backdrop-filter: blur(15px);
}

.summary-stats {
    color: rgba(79, 70, 229, 0.9);
    font-weight: 600;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.empty-summary {
    color: rgba(156, 163, 175, 0.8);
    font-style: italic;
    font-size: 0.9rem;
}

/* Animations */
@keyframes cardSlideIn {
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes miniBarGrow {
    from { width: 0%; }
    to { width: var(--final-width, 50%); }
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-10px);
    }
    60% {
        transform: translateY(-5px);
    }
}

/* Light Mode Styles */
body:not(.dark-mode) .chart-status-header-scrollable {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
    border-color: rgba(16, 185, 129, 0.2);
}

body:not(.dark-mode) .stat-group {
    background: rgba(255, 255, 255, 0.8);
    border-color: rgba(79, 70, 229, 0.15);
}

body:not(.dark-mode) .stat-number {
    color: rgba(5, 150, 105, 1);
}

body:not(.dark-mode) .stat-label {
    color: var(--gray-600);
}

body:not(.dark-mode) .progress-text {
    color: rgba(5, 150, 105, 1);
}

body:not(.dark-mode) .category-analytics-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.8) 100%);
    border-color: rgba(79, 70, 229, 0.1);
    color: var(--gray-800);
}

body:not(.dark-mode) .category-title {
    color: var(--gray-800);
}

body:not(.dark-mode) .category-subtitle {
    color: var(--gray-600);
}

body:not(.dark-mode) .analytics-value {
    color: var(--gray-800);
}

body:not(.dark-mode) .analytics-label {
    color: var(--gray-600);
}

body:not(.dark-mode) .priority-title {
    color: var(--gray-700);
}

body:not(.dark-mode) .priority-count {
    color: var(--gray-600);
}

body:not(.dark-mode) .no-data-analytics {
    color: var(--gray-500);
}

body:not(.dark-mode) .summary-stats {
    color: rgba(79, 70, 229, 0.9);
}

body:not(.dark-mode) .empty-summary {
    color: var(--gray-500);
}

/* Responsive Design */
@media (max-width: 768px) {
    .overall-stats {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
    }
    
    .stat-number {
        font-size: 1.25rem;
    }
    
    .completion-progress {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .analytics-grid {
        grid-template-columns: 1fr;
        gap: 0.75rem;
    }
    
    .card-header {
        flex-direction: column;
        text-align: center;
        gap: 0.75rem;
    }
    
    .category-icon-large {
        width: 40px;
        height: 40px;
        font-size: 1.25rem;
    }
    
    .summary-stats {
        flex-direction: column;
        gap: 0.5rem;
    }
}

/* Enhanced Category Chart Styles */
.chart-status-header-enhanced {
    margin-bottom: 1.2rem;
    padding: 1rem;
    border-radius: 12px;
    transition: all 0.3s ease;
}

.chart-active-status-enhanced {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.1) 100%);
    border: 1px solid rgba(16, 185, 129, 0.3);
    border-radius: 12px;
    padding: 0.75rem;
}

.status-main {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    color: rgba(16, 185, 129, 0.9);
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

.status-breakdown {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    font-size: 0.9rem;
}

.completed-badge {
    background: rgba(16, 185, 129, 0.2);
    color: rgba(16, 185, 129, 1);
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-weight: 600;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.pending-badge {
    background: rgba(245, 158, 11, 0.2);
    color: rgba(245, 158, 11, 1);
    padding: 0.3rem 0.75rem;
    border-radius: 20px;
    font-weight: 600;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.chart-empty-status-enhanced {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.15) 0%, rgba(107, 114, 128, 0.1) 100%);
    color: rgba(156, 163, 175, 0.9);
    border: 1px solid rgba(156, 163, 175, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    padding: 1rem;
    border-radius: 12px;
    font-weight: 600;
}

/* Enhanced Bar Chart Container */
.bar-chart-container-enhanced {
    padding: 0.5rem 1rem;
    max-height: 260px;
    overflow: hidden;
}

.bar-chart-row-enhanced {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.9rem;
    min-height: 40px;
    max-height: 40px;
    transition: all 0.3s ease;
    position: relative;
    padding: 0.25rem 0;
}

.bar-chart-row-enhanced.has-data {
    transform: scale(1.01);
    background: rgba(255, 255, 255, 0.02);
    border-radius: 8px;
}

.bar-chart-row-enhanced.no-data {
    opacity: 0.7;
}

.bar-label-enhanced {
    min-width: 130px;
    max-width: 130px;
    display: flex;
    align-items: center;
    transition: all 0.3s ease;
}

.category-info {
    display: flex;
    flex-direction: column;
    gap: 0.1rem;
}

.category-name-enhanced {
    text-transform: capitalize;
    font-size: 0.9rem;
    font-weight: 600;
    color: rgba(255,255,255,0.9);
    line-height: 1.2;
}

.category-count {
    font-size: 0.75rem;
    color: rgba(255,255,255,0.6);
    font-weight: 500;
}

.bar-chart-row-enhanced.has-data .category-name-enhanced {
    color: rgba(255,255,255,1);
}

.bar-chart-row-enhanced.has-data .category-count {
    color: rgba(255,255,255,0.8);
}

.bar-container-enhanced {
    flex: 1;
    height: 32px;
    position: relative;
    border-radius: 16px;
    overflow: hidden;
}

.bar-track-enhanced {
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.05);
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,0.1);
    position: absolute;
    top: 0;
    left: 0;
}

.bar-stack {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 16px;
    overflow: hidden;
}

.bar-fill-completed {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 3;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    transition: width 0.8s ease-out;
}

.bar-fill-pending {
    position: absolute;
    top: 0;
    height: 100%;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    transition: all 0.8s ease-out;
    overflow: hidden;
}

.bar-segment-count {
    color: white;
    font-weight: 700;
    font-size: 0.75rem;
    text-shadow: 0 1px 3px rgba(0,0,0,0.5);
    z-index: 4;
    position: relative;
    white-space: nowrap;
}

.bar-shimmer-enhanced {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation: shimmerMove 2.5s infinite;
    z-index: 1;
}

.no-data-indicator-enhanced {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: rgba(255,255,255,0.4);
    font-size: 0.8rem;
    font-style: italic;
    z-index: 1;
    pointer-events: none;
    transition: opacity 0.4s ease;
}

.task-breakdown {
    min-width: 60px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
}

.breakdown-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    font-size: 0.75rem;
}

.breakdown-item.completed {
    color: rgba(16, 185, 129, 0.9);
}

.breakdown-item.pending {
    color: rgba(245, 158, 11, 0.9);
}

.breakdown-count {
    font-weight: 700;
    min-width: 20px;
    text-align: center;
}

.breakdown-label {
    font-size: 0.7rem;
}

.breakdown-empty {
    color: rgba(255,255,255,0.3);
    font-size: 0.8rem;
}

/* Enhanced Footer */
.chart-footer-enhanced {
    margin-top: 1.2rem;
    padding: 0.75rem;
    text-align: center;
    border-radius: 10px;
    transition: all 0.3s ease;
}

.chart-legend {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 0.75rem;
}

.legend-item-enhanced {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: rgba(255,255,255,0.8);
}

.legend-color {
    width: 14px;
    height: 14px;
    border-radius: 7px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}

.legend-color.completed {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.legend-color.pending {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.activity-summary-enhanced {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%);
    color: rgba(79, 70, 229, 0.9);
    border: 1px solid rgba(79, 70, 229, 0.2);
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    display: inline-block;
}

.empty-state-message-enhanced {
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.1) 0%, rgba(107, 114, 128, 0.05) 100%);
    color: rgba(156, 163, 175, 0.8);
    border: 1px solid rgba(156, 163, 175, 0.2);
    padding: 0.75rem 1rem;
    border-radius: 20px;
    font-style: italic;
    font-size: 0.9rem;
}

/* Enhanced Animations */
@keyframes barGrowEnhanced {
    from { 
        width: 0%; 
        transform: scaleX(0);
        transform-origin: left;
        box-shadow: none;
    }
    50% {
        transform: scaleX(1.03);
    }
    to { 
        width: var(--final-width, 50%); 
        transform: scaleX(1);
        transform-origin: left;
    }
}

/* Light Mode Enhanced Styles */
body:not(.dark-mode) .chart-active-status-enhanced {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(5, 150, 105, 0.05) 100%);
    border-color: rgba(16, 185, 129, 0.2);
}

body:not(.dark-mode) .status-main {
    color: rgba(5, 150, 105, 0.9);
}

body:not(.dark-mode) .completed-badge {
    background: rgba(16, 185, 129, 0.15);
    color: rgba(5, 150, 105, 1);
    border-color: rgba(16, 185, 129, 0.25);
}

body:not(.dark-mode) .pending-badge {
    background: rgba(245, 158, 11, 0.15);
    color: rgba(217, 119, 6, 1);
    border-color: rgba(245, 158, 11, 0.25);
}

body:not(.dark-mode) .chart-empty-status-enhanced {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.1) 0%, rgba(75, 85, 99, 0.05) 100%);
    color: rgba(75, 85, 99, 0.8);
    border-color: rgba(107, 114, 128, 0.2);
}

body:not(.dark-mode) .category-name-enhanced {
    color: var(--gray-700);
}

body:not(.dark-mode) .category-count {
    color: var(--gray-500);
}

body:not(.dark-mode) .bar-chart-row-enhanced.has-data .category-name-enhanced {
    color: var(--gray-800);
}

body:not(.dark-mode) .bar-chart-row-enhanced.has-data .category-count {
    color: var(--gray-600);
}

body:not(.dark-mode) .bar-track-enhanced {
    background: rgba(79, 70, 229, 0.05) !important;
    border-color: rgba(79, 70, 229, 0.1) !important;
}

body:not(.dark-mode) .no-data-indicator-enhanced {
    color: var(--gray-400);
}

body:not(.dark-mode) .breakdown-item.completed {
    color: rgba(5, 150, 105, 0.9);
}

body:not(.dark-mode) .breakdown-item.pending {
    color: rgba(217, 119, 6, 0.9);
}

body:not(.dark-mode) .breakdown-empty {
    color: var(--gray-300);
}

body:not(.dark-mode) .legend-item-enhanced {
    color: var(--gray-600);
}

body:not(.dark-mode) .activity-summary-enhanced {
    background: linear-gradient(135deg, rgba(79, 70, 229, 0.08) 0%, rgba(118, 75, 162, 0.04) 100%);
    color: rgba(79, 70, 229, 0.9);
    border-color: rgba(79, 70, 229, 0.15);
}

body:not(.dark-mode) .empty-state-message-enhanced {
    background: linear-gradient(135deg, rgba(107, 114, 128, 0.08) 0%, rgba(75, 85, 99, 0.04) 100%);
    color: var(--gray-600);
    border-color: rgba(107, 114, 128, 0.15);
}

/* Responsive Design */
@media (max-width: 768px) {
    .bar-chart-row-enhanced {
        margin-bottom: 0.7rem;
        min-height: 36px;
        max-height: 36px;
    }
    
    .bar-label-enhanced {
        min-width: 110px;
        max-width: 110px;
    }
    
    .category-name-enhanced {
        font-size: 0.8rem;
    }
    
    .category-count {
        font-size: 0.7rem;
    }
    
    .bar-container-enhanced {
        height: 28px;
    }
    
    .bar-segment-count {
        font-size: 0.7rem;
    }
    
    .task-breakdown {
        min-width: 50px;
    }
    
    .breakdown-item {
        font-size: 0.7rem;
    }
    
    .chart-legend {
        gap: 1rem;
    }
    
    .legend-item-enhanced {
        font-size: 0.8rem;
    }
    
    .status-breakdown {
        gap: 1rem;
        font-size: 0.8rem;
    }
}

/* Hover Effects */
.bar-chart-row-enhanced:hover {
    transform: translateX(2px);
    background: rgba(255, 255, 255, 0.04) !important;
}

.bar-chart-row-enhanced.has-data:hover {
    transform: translateX(2px) scale(1.01);
}

.bar-chart-row-enhanced:hover .bar-fill-completed,
.bar-chart-row-enhanced:hover .bar-fill-pending {
    box-shadow: 0 4px 15px rgba(0,0,0,0.25);
}

/* Color-Coded Category Header */
.category-header-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    padding: 0 0.5rem;
}

.category-header-item {
    padding: 1rem;
    border-radius: 12px;
    color: white;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.category-header-item:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.category-header-icon {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.category-header-info {
    flex: 1;
}

.category-header-name {
    font-weight: 700;
    font-size: 0.9rem;
    text-transform: capitalize;
    margin-bottom: 0.25rem;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

.category-header-count {
    font-size: 0.8rem;
    opacity: 0.9;
    font-weight: 500;
}

/* Chart Section Title */
.chart-section-title {
    text-align: center;
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.chart-section-title h4 {
    color: rgba(255, 255, 255, 0.95);
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
}

.chart-section-title span {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    font-weight: 500;
}

/* Updated View More Button Position */
.category-view-more-container {
    display: flex;
    justify-content: center;
    margin: 1rem 0;
    padding: 0 1rem;
}

/* Summary Footer */
.chart-summary-footer {
    margin-top: 1.5rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    text-align: center;
}

.summary-stats {
    display: flex;
    justify-content: center;
    gap: 2rem;
    flex-wrap: wrap;
}

.summary-stats span {
    font-size: 0.85rem;
    font-weight: 600;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.summary-completed {
    background: rgba(16, 185, 129, 0.15);
    color: #10b981;
    border-color: rgba(16, 185, 129, 0.3);
}

.summary-pending {
    background: rgba(245, 158, 11, 0.15);
    color: #f59e0b;
    border-color: rgba(245, 158, 11, 0.3);
}

.summary-total {
    background: rgba(79, 70, 229, 0.15);
    color: #4f46e5;
    border-color: rgba(79, 70, 229, 0.3);
}

/* Animation for category headers */
@keyframes categoryHeaderSlide {
    from {
        opacity: 0;
        transform: translateY(-20px) scale(0.9);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Enhanced expandable rows for smooth transition */
.expandable-rows {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.6s cubic-bezier(0.23, 1, 0.32, 1);
    opacity: 0;
    margin-top: 0;
}

.expandable-rows.expanded {
    max-height: 160px; /* Adjusted for 2 bars */
    opacity: 1;
    transition: max-height 0.6s cubic-bezier(0.23, 1, 0.32, 1), 
                opacity 0.4s ease 0.2s;
    margin-top: 0.5rem;
}

/* Mobile responsive */
@media (max-width: 768px) {
    .category-header-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
    }
    
    .category-header-item {
        padding: 0.75rem;
        gap: 0.5rem;
    }
    
    .category-header-icon {
        width: 32px;
        height: 32px;
        font-size: 1rem;
    }
    
    .category-header-name {
        font-size: 0.8rem;
    }
    
    .category-header-count {
        font-size: 0.75rem;
    }
    
    .summary-stats {
        gap: 1rem;
    }
    
    .summary-stats span {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
    }
}

/* Active/Inactive States for Category Headers */
.category-header-item.inactive {
    background: rgba(255, 255, 255, 0.05) !important;
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.6);
}

.category-header-item.inactive:hover {
    background: rgba(255, 255, 255, 0.08) !important;
    transform: translateY(-1px) scale(1.01);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.category-header-item.active {
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.category-header-icon.inactive {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.4);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.category-header-icon.active {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.category-header-count.inactive {
    color: rgba(255, 255, 255, 0.5);
    font-style: italic;
}

.category-header-count.active {
    color: rgba(255, 255, 255, 0.95);
    font-weight: 600;
}

/* Activity Indicators */
.activity-indicator {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.1rem;
    animation: activityPulse 2s ease-in-out infinite;
}

.inactive-indicator {
    color: rgba(255, 255, 255, 0.3);
    font-size: 1rem;
}

@keyframes activityPulse {
    0%, 100% { 
        opacity: 0.9; 
        transform: scale(1); 
    }
    50% { 
        opacity: 1; 
        transform: scale(1.1); 
    }
}

/* Empty State Styling */
.category-empty-state {
    text-align: center;
    padding: 3rem 2rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 16px;
    border: 2px dashed rgba(255, 255, 255, 0.1);
    margin: 2rem 0;
}

.category-empty-state i {
    font-size: 4rem;
    color: rgba(255, 255, 255, 0.2);
    margin-bottom: 1.5rem;
    display: block;
}

.category-empty-state h4 {
    color: rgba(255, 255, 255, 0.8);
    font-size: 1.3rem;
    margin-bottom: 1rem;
    font-weight: 600;
}

.category-empty-state p {
    color: rgba(255, 255, 255, 0.6);
    font-size: 1rem;
    margin-bottom: 1.5rem;
    line-height: 1.5;
}

.empty-state-hint {
    background: rgba(245, 158, 11, 0.1);
    color: rgba(245, 158, 11, 0.9);
    padding: 0.75rem 1.5rem;
    border-radius: 20px;
    border: 1px solid rgba(245, 158, 11, 0.2);
    display: inline-block;
    font-size: 0.9rem;
    font-weight: 500;
}

/* Dark Mode Support for Empty States */
body:not(.dark-mode) .category-header-item.inactive {
    background: rgba(0, 0, 0, 0.03) !important;
    border-color: rgba(0, 0, 0, 0.08);
    color: var(--gray-500);
}

body:not(.dark-mode) .category-header-icon.inactive {
    background: rgba(0, 0, 0, 0.05);
    color: var(--gray-400);
}

body:not(.dark-mode) .category-header-count.inactive {
    color: var(--gray-400);
}

body:not(.dark-mode) .inactive-indicator {
    color: var(--gray-300);
}

body:not(.dark-mode) .category-empty-state {
    background: rgba(79, 70, 229, 0.02);
    border-color: rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .category-empty-state i {
    color: var(--gray-200);
}

body:not(.dark-mode) .category-empty-state h4 {
    color: var(--gray-700);
}

body:not(.dark-mode) .category-empty-state p {
    color: var(--gray-600);
}

/* Dark mode support */
body:not(.dark-mode) .chart-section-title {
    background: rgba(79, 70, 229, 0.05);
    border-color: rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .chart-section-title h4 {
    color: var(--gray-800);
}

body:not(.dark-mode) .chart-section-title span {
    color: var(--gray-600);
}

body:not(.dark-mode) .chart-summary-footer {
    background: rgba(79, 70, 229, 0.03);
    border-color: rgba(79, 70, 229, 0.08);
}

/* Chart Type Tabs */
.chart-controls-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.chart-type-tabs {
    display: flex;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 0.25rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.chart-type-tab {
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.7);
    padding: 0.75rem 1.25rem;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    position: relative;
    overflow: hidden;
}

.chart-type-tab::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.6s ease;
}

.chart-type-tab:hover::before {
    left: 100%;
}

.chart-type-tab:hover {
    color: rgba(255, 255, 255, 0.9);
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-1px);
}

.chart-type-tab.active {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
    transform: translateY(-2px);
}

.chart-type-tab i {
    font-size: 1rem;
    transition: transform 0.3s ease;
}

.chart-type-tab.active i {
    transform: scale(1.1);
}

/* Line Chart Styles */
.line-chart-container {
    position: relative;
    width: 100%;
    height: 100%;
    padding: 2rem;
}

.line-chart-svg {
    width: 100%;
    height: 100%;
    overflow: visible;
}

.chart-grid-line {
    stroke: rgba(255, 255, 255, 0.1);
    stroke-width: 1;
    stroke-dasharray: 2,2;
}

.chart-axis-line {
    stroke: rgba(255, 255, 255, 0.2);
    stroke-width: 2;
}

.trend-line {
    fill: none;
    stroke-width: 3;
    stroke-linecap: round;
    stroke-linejoin: round;
    filter: drop-shadow(0 2px 8px rgba(79, 70, 229, 0.4));
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    animation: drawTrendLine 2s ease-out forwards;
}

.trend-line.total {
    stroke: url(#totalGradient);
}

.trend-line.completed {
    stroke: url(#completedGradient);
}

.trend-area {
    opacity: 0.1;
    animation: fillTrendArea 1.5s ease-out 0.5s forwards;
}

.trend-area.total {
    fill: url(#totalAreaGradient);
}

.trend-area.completed {
    fill: url(#completedAreaGradient);
}

.trend-point {
    fill: white;
    stroke-width: 3;
    r: 5;
    opacity: 0;
    animation: popTrendPoint 0.6s ease-out forwards;
    cursor: pointer;
    transition: all 0.3s ease;
}

.trend-point:hover {
    r: 7;
    filter: drop-shadow(0 0 10px currentColor);
}

.trend-point.total {
    stroke: var(--primary);
}

.trend-point.completed {
    stroke: var(--success);
}

.point-label {
    fill: rgba(255, 255, 255, 0.9);
    font-size: 12px;
    font-weight: 600;
    text-anchor: middle;
    opacity: 0;
    animation: fadeInLabel 0.5s ease-out forwards;
    pointer-events: none;
}

.axis-label {
    fill: rgba(255, 255, 255, 0.7);
    font-size: 11px;
    font-weight: 500;
    text-anchor: middle;
}

/* Line Chart Animations */
@keyframes drawTrendLine {
    to {
        stroke-dashoffset: 0;
    }
}

@keyframes fillTrendArea {
    from {
        opacity: 0;
    }
    to {
        opacity: 0.1;
    }
}

@keyframes popTrendPoint {
    0% {
        opacity: 0;
        transform: scale(0);
    }
    80% {
        transform: scale(1.2);
    }
    100% {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes fadeInLabel {
    to {
        opacity: 1;
    }
}

/* Mobile responsive for chart tabs */
@media (max-width: 768px) {
    .chart-controls-row {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .chart-type-tabs {
        width: 100%;
        justify-content: center;
    }
    
    .chart-type-tab {
        flex: 1;
        justify-content: center;
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
    }
    
    .chart-controls {
        width: 100%;
        justify-content: center;
    }
}

/* Dark mode support */
body:not(.dark-mode) .chart-type-tabs {
    background: rgba(79, 70, 229, 0.05);
    border-color: rgba(79, 70, 229, 0.1);
}

body:not(.dark-mode) .chart-type-tab {
    color: var(--gray-600);
}

body:not(.dark-mode) .chart-type-tab:hover {
    color: var(--gray-800);
    background: rgba(79, 70, 229, 0.08);
}

/* Enhanced Oval Bar Animations */
@keyframes barGrow {
    from { 
        height: 0%; 
        transform: scaleY(0);
        opacity: 0;
    }
    to { 
        height: var(--final-height, 50%); 
        transform: scaleY(1);
        opacity: 1;
    }
}

@keyframes labelFadeIn {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(10px) scale(0.8);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }
}

/* Oval Bar Hover Effects */
.trends-chart-container:hover .oval-bar {
    transform: scaleX(1.05);
    transition: transform 0.3s ease;
}

/* Mobile responsive for oval bars */
@media (max-width: 768px) {
    .oval-bar {
        max-width: 35px !important;
    }
    
    .trends-chart-container {
        gap: 0.5rem !important;
    }
}
    </style>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Poppins -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
</head>
<body>
    <!-- Professional Welcome Animation -->
    <div class="welcome-overlay" id="welcomeOverlay">
        <div class="professional-welcome-container">
            <!-- Logo Animation -->
            <div class="logo-animation-container">
                <div class="animated-logo">
                    <div class="logo-circle">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="logo-particles">
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                    </div>
                </div>
            </div>
            
            <!-- Company Name with Professional Typography -->
            <div class="company-branding">
                <h1 class="company-name">
                    <span class="letter">T</span>
                    <span class="letter">a</span>
                    <span class="letter">s</span>
                    <span class="letter">k</span>
                    <span class="letter">l</span>
                    <span class="letter">y</span>
                    <span class="letter">t</span>
                    <span class="letter">i</span>
                    <span class="letter">c</span>
                </h1>
                <p class="company-tagline">Professional Task Management</p>
            </div>
            
            <!-- Loading Progress Bar -->
            <div class="loading-container">
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
                <p class="loading-text">Initializing your workspace...</p>
            </div>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container" id="appContainer">
        <header>
            <div class="container">
                <div class="logo">
                    <i class="fas fa-tasks"></i>
                    <span>Tasklytic</span>
                </div>
                
                <div class="header-actions">
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle Theme">
        <i class="fas fa-moon"></i>
    </button>
    <button class="settings-btn" id="settingsBtn" aria-label="Settings">
        <i class="fas fa-cog"></i>
    </button>
</div>
        </header>

        <!-- Settings Panel -->
        <div class="settings-panel" id="settingsPanel">
            <div class="settings-content">
                <div class="settings-header">
                    <h3>Settings</h3>
                    <button class="settings-close" id="settingsClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="settings-options">
                    <div class="setting-item" id="autoSaveToggle">
                        <div class="setting-info">
                            <i class="fas fa-save"></i>
                            <span>Auto Save</span>
                        </div>
                        <div class="setting-toggle">
                            <div class="toggle-switch active">
                                <div class="toggle-switch-handle"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-item" id="notificationsToggle">
                        <div class="setting-info">
                            <i class="fas fa-bell"></i>
                            <span>Notifications</span>
                        </div>
                        <div class="setting-toggle">
                            <div class="toggle-switch active">
                                <div class="toggle-switch-handle"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-item" id="compactViewToggle">
                        <div class="setting-info">
                            <i class="fas fa-compress-alt"></i>
                            <span>Compact View</span>
                        </div>
                        <div class="setting-toggle">
                            <div class="toggle-switch">
                                <div class="toggle-switch-handle"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="setting-item" id="exportData">
                        <div class="setting-info">
                            <i class="fas fa-download"></i>
                            <span>Export Data</span>
                        </div>
                        <div class="setting-action">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="settings-overlay" id="settingsOverlay"></div>

        <div class="container">
            <div class="main-content">
                <aside class="sidebar" id="sidebar">
                    <div class="sidebar-header">
                        <h3>Categories</h3>
                    </div>

                    <div class="categories-container">                        
                        <div class="category-slider" id="categorySlider">
                            <div class="category active" data-category="all" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-layer-group"></i>
                                    All Tasks
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="work" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-briefcase"></i>
                                    Work
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="personal" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-user"></i>
                                    Personal
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="shopping" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-shopping-cart"></i>
                                    Shopping
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="health" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-heartbeat"></i>
                                    Health
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="finance" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-dollar-sign"></i>
                                    Finance
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="education" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-graduation-cap"></i>
                                    Education
                                </div>
                                <div class="task-count">0</div>
                            </div>
                        </div>
                    </div>
                </aside>

                <div class="tasks-container">
                    <div class="tasks-header" id="tasksHeader">
                        <div class="search-container">
    <i class="fas fa-search search-icon" aria-hidden="true"></i>
    <input type="text" class="search-input" id="searchInput" placeholder="Search tasks..." aria-label="Search tasks">
    <div class="search-suggestions" id="searchSuggestions"></div>
</div>

                        <div class="search-blur-overlay" id="searchBlurOverlay"></div>

                        <!-- AI Intelligent Prioritization Button -->
                        <div class="ai-task-button-container" id="aiTaskButtonContainer">
                            <button class="ai-task-button" id="aiTaskButton">
                                <i class="fas fa-wand-magic-sparkles btn-icon"></i>
                                Intelligent Prioritization
                            </button>
                            <div class="beta-badge">Beta</div>
                        </div>
                        
                        <div class="category-container" id="categoryContainer">
                            <div class="section-title">
                                <div>
                                    <h2 id="currentCategory"><i class="fas fa-layer-group"></i> All Tasks</h2>
                                    <p class="category-description" id="categoryDescription">View and manage all your tasks in one place.</p>
                                </div>
                                <div class="section-actions">
                                    <div class="task-sort">
                                        <span class="sort-label">Sort by:</span>
                                        <select id="sortSelect" class="btn-select" aria-label="Sort tasks">
                                            <option value="date">Due Date</option>
                                            <option value="priority">Priority</option>
                                            <option value="name">Name</option>
                                        </select>
                                    </div>
                                    <button class="btn btn-primary" id="addTaskBtn" aria-label="Add New Task">
                                        <i class="fas fa-plus btn-icon" aria-hidden="true"></i> Add Task
                                    </button>
                                </div>
                            </div>

                            <!-- Dashboard Section -->
                            <div class="dashboard" id="dashboard">
                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div class="stat-title">Total Tasks</div>
                                        <div class="stat-icon total"><i class="fas fa-tasks"></i></div>
                                    </div>
                                    <div class="stat-value" id="totalTasksValue">0</div>
                                    <div class="stat-change positive">
                                        <i class="fas fa-arrow-up"></i> 5% from last week
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div class="stat-title">Completed Tasks</div>
                                        <div class="stat-icon completed"><i class="fas fa-check-circle"></i></div>
                                    </div>
                                    <div class="stat-value" id="completedTasksValue">0</div>
                                    <div class="stat-change positive">
                                        <i class="fas fa-arrow-up"></i> 12% from last week
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div class="stat-title">Pending Tasks</div>
                                        <div class="stat-icon pending"><i class="fas fa-clock"></i></div>
                                    </div>
                                    <div class="stat-value" id="pendingTasksValue">0</div>
                                    <div class="stat-change negative">
                                        <i class="fas fa-arrow-down"></i> 3% from last week
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-header">
                                        <div class="stat-title">Overdue Tasks</div>
                                        <div class="stat-icon overdue"><i class="fas fa-exclamation-circle"></i></div>
                                    </div>
                                    <div class="stat-value" id="overdueTasksValue">0</div>
                                    <div class="stat-change negative">
                                        <i class="fas fa-arrow-down"></i> 8% from last week
                                    </div>
                                </div>

                                 <!-- NEW TO BE ADDED STAT CARD WITH VIEW TASKS BUTTON -->
<div class="stat-card to-be-added-card" id="toBeAddedCard" style="display: none;">
    <div class="stat-header">
        <div class="stat-title">To Be Added</div>
        <div class="stat-icon to-be-added">
            <i class="fas fa-clock animated-clock"></i>
        </div>
    </div>
    <div class="stat-value" id="toBeAddedValue">0</div>
    <div class="stat-change scheduled">
        <i class="fas fa-calendar-plus"></i> Scheduled tasks
    </div>
</div>
                            </div>

                            <!-- Filter buttons -->
                            <div class="task-filters-wrapper" id="taskFiltersWrapper">
                                <div class="task-filters" id="taskFilters">
                                    <button class="filter-btn active" data-filter="all">All</button>
                                    <button class="filter-btn" data-filter="pending">Pending</button>
                                    <button class="filter-btn" data-filter="completed">Completed</button>
                                    <button class="filter-btn" data-filter="overdue">Overdue</button>
                                    <button class="filter-btn" data-filter="today">Due Today</button>
                                </div>
                            </div>

                            <div class="task-list-wrapper" id="taskListWrapper">
                                <div class="task-list" id="taskList" aria-live="polite">
                                    <!-- Tasks will be populated here by JavaScript -->
                                    <div class="empty-state" id="emptyState">
                                        <i class="fas fa-clipboard-list" aria-hidden="true"></i>
                                        <h3>No tasks yet</h3>
                                        <p>Add your first task to get started</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add/Edit Task Modal -->
        <div class="modal" id="taskModal" aria-modal="true" role="dialog">
            <div class="modal-content">
                <div class="modal-header" id="modalHeader">
                    <h3 class="modal-title" id="modalTitle">Add New Task</h3>
                    <button class="modal-close" id="modalClose" aria-label="Close modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Task form tabs -->
<div class="task-form-tabs">
    <div class="task-form-tab active" data-tab="details">
        <i class="fas fa-tasks"></i> Task Details
    </div>
    <div class="task-form-tab" data-tab="reminders">
        <i class="fas fa-bell"></i> Reminders
    </div>
    <div class="task-form-tab" data-tab="addlater">
        <i class="fas fa-clock"></i> Add Later
    </div>
</div>

<!-- Scheduled Tasks Modal -->
    <div class="modal" id="scheduledTasksModal">
        <div class="modal-content scheduled-tasks-modal">
            <div class="modal-header">
                <h2><i class="fas fa-clock"></i> Scheduled Tasks</h2>
                <button class="close-btn" onclick="closeScheduledTasksModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="scheduled-tasks-list" id="scheduledTasksList">
                    <!-- Scheduled tasks will be populated here -->
                </div>
                <div class="no-scheduled-tasks" id="noScheduledTasks" style="display: none;">
                    <i class="fas fa-calendar-check"></i>
                    <p>No tasks scheduled to be added</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Modal -->
<div class="modal" id="rescheduleModal">
    <div class="modal-content reschedule-modal">
        <div class="modal-header">
            <h2><i class="fas fa-clock"></i> Reschedule Task</h2>
            <button class="close-btn" onclick="closeRescheduleModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <form class="reschedule-form" onsubmit="event.preventDefault(); confirmReschedule();">
                <div class="form-group">
                    <label>Task:</label>
                    <div class="task-preview" id="rescheduleTaskTitle">Task title will appear here</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="rescheduleDate">New Date:</label>
                        <input type="date" id="rescheduleDate" required>
                    </div>
                    <div class="form-group">
                        <label for="rescheduleTime">New Time:</label>
                        <input type="time" id="rescheduleTime" required>
                    </div>
                </div>

                 <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeRescheduleModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Reschedule Task</button>
                </div>
            </form>
        </div>
    </div>
</div>


                    
                    <form id="taskForm">
                        <input type="hidden" id="taskId">

                        <!-- Task Details Tab -->
                        <div class="task-form-content active" id="detailsTab">
                            <div class="form-group">
                                <label for="taskTitle" class="form-label">Task Title</label>
                                <div class="input-group">
                                    <i class="fas fa-tasks input-icon" aria-hidden="true"></i>
                                    <input type="text" id="taskTitle" class="form-control input-with-icon" placeholder="What needs to be done?" required>
                                </div>
                                <div class="form-error" id="taskTitleError">Please enter a task title</div>
                            </div>

                            <div class="form-group">
                                <label for="taskDescription" class="form-label">Description (Optional)</label>
                                <textarea id="taskDescription" class="form-control" rows="3" placeholder="Add details about your task..."></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <div class="category-selector" id="categorySelector">
                                    <div class="category-option work" data-category="work">
                                        <input type="radio" id="categoryWork" name="taskCategory" value="work">
                                        <i class="fas fa-briefcase"></i>
                                        <span>Work</span>
                                    </div>
                                    <div class="category-option personal" data-category="personal">
                                        <input type="radio" id="categoryPersonal" name="taskCategory" value="personal">
                                        <i class="fas fa-user"></i>
                                        <span>Personal</span>
                                    </div>
                                    <div class="category-option shopping" data-category="shopping">
                                        <input type="radio" id="categoryShopping" name="taskCategory" value="shopping">
                                        <i class="fas fa-shopping-cart"></i>
                                        <span>Shopping</span>
                                    </div>
                                    <div class="category-option health" data-category="health">
                                        <input type="radio" id="categoryHealth" name="taskCategory" value="health">
                                        <i class="fas fa-heartbeat"></i>
                                        <span>Health</span>
                                    </div>
                                    <div class="category-option finance" data-category="finance">
                                        <input type="radio" id="categoryFinance" name="taskCategory" value="finance">
                                        <i class="fas fa-dollar-sign"></i>
                                        <span>Finance</span>
                                    </div>
                                    <div class="category-option education" data-category="education">
                                        <input type="radio" id="categoryEducation" name="taskCategory" value="education">
                                        <i class="fas fa-graduation-cap"></i>
                                        <span>Education</span>
                                    </div>
                                </div>
                                <div class="form-error" id="taskCategoryError">Please select a category</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <div class="priority-selector" id="prioritySelector">
                                    <div class="priority-option low" data-priority="low">
                                        <input type="radio" id="priorityLow" name="taskPriority" value="low">
                                        <i class="fas fa-arrow-down"></i>
                                        <span>Low</span>
                                    </div>
                                    <div class="priority-option medium" data-priority="medium">
                                        <input type="radio" id="priorityMedium" name="taskPriority" value="medium">
                                        <i class="fas fa-minus"></i>
                                        <span>Medium</span>
                                    </div>
                                    <div class="priority-option high" data-priority="high">
                                        <input type="radio" id="priorityHigh" name="taskPriority" value="high">
                                        <i class="fas fa-arrow-up"></i>
                                        <span>High</span>
                                    </div>
                                </div>
                                <div class="form-error" id="taskPriorityError">Please select a priority</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Due Date and Time</label>
                                <div class="datetime-input-group">
                                    <div class="date-input">
                                        <input type="date" id="taskDueDate" class="form-control" required>
                                        <div class="form-error" id="taskDueDateError">Please select a due date</div>
                                    </div>
                                    <div class="time-input">
                                        <div class="time-input-container">
                                            <input type="time" id="taskDueTime" class="time-input-field" value="09:00">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Reminders Tab -->
                        <div class="task-form-content" id="remindersTab">
                            <div class="form-group">
                                <div class="setting-item" id="reminderToggle">
                                    <div class="setting-info">
                                        <i class="fas fa-bell"></i>
                                        <span>Enable Reminder</span>
                                    </div>
                                    <div class="setting-toggle">
                                        <div class="toggle-switch" id="reminderSwitch">
                                            <div class="toggle-switch-handle"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="reminder-options" id="reminderOptions" style="display: none;">
                                <div class="form-group">
                                    <label class="form-label">Remind me before:</label>
                                    <div class="reminder-time-selector">
                                        <div class="reminder-option" data-minutes="5">
                                            <input type="radio" id="reminder5" name="reminderTime" value="5">
                                            <label for="reminder5">5 min</label>
                                        </div>
                                        <div class="reminder-option" data-minutes="15">
                                            <input type="radio" id="reminder15" name="reminderTime" value="15">
                                            <label for="reminder15">15 min</label>
                                        </div>
                                        <div class="reminder-option" data-minutes="30">
                                            <input type="radio" id="reminder30" name="reminderTime" value="30">
                                            <label for="reminder30">30 min</label>
                                        </div>
                                        <div class="reminder-option" data-minutes="60">
                                            <input type="radio" id="reminder60" name="reminderTime" value="60">
                                            <label for="reminder60">1 hour</label>
                                        </div>
                                        <div class="reminder-option custom" data-minutes="custom">
                                            <input type="radio" id="reminderCustom" name="reminderTime" value="custom">
                                            <label for="reminderCustom">Custom</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group" id="customReminderInput" style="display: none;">
                                    <label for="customMinutes" class="form-label">Custom reminder (minutes before):</label>
                                    <input type="number" id="customMinutes" class="form-control" min="1" max="10080" placeholder="e.g., 120">
                                </div>
                            </div>
                        </div>

                        <!-- ADD THIS ENTIRE ADD LATER TAB CONTENT HERE -->
<div class="task-form-content" id="addlaterTab">
    <div class="form-group">
        <div class="setting-item" id="addLaterToggle">
            <div class="setting-info">
                <i class="fas fa-clock"></i>
                <span>Schedule Task Creation</span>
            </div>
            <div class="setting-toggle">
                <div class="toggle-switch" id="addLaterSwitch">
                    <div class="toggle-switch-handle"></div>
                </div>
            </div>
        </div>
        <p style="font-size: 0.9rem; color: var(--gray-600); margin-top: 0.5rem;">
            Task will be automatically added to your list at the specified time
        </p>
    </div>
    
    <div class="add-later-options" id="addLaterOptions" style="display: none;">
        <div class="form-group">
            <label class="form-label">Add task on:</label>
            <div class="datetime-input-group">
                <div class="date-input">
                    <input type="date" id="addLaterDate" class="form-control">
                </div>
                <div class="time-input">
                    <input type="time" id="addLaterTime" class="time-input-field" value="09:00">
                </div>
            </div>
        </div>
        
        <div class="add-later-preview" id="addLaterPreview" style="display: none;">
            <div style="background: var(--primary-light); padding: 1rem; border-radius: 8px; border: 1px solid var(--primary);">
                <div style="font-weight: 600; color: var(--primary); margin-bottom: 0.5rem;">
                    <i class="fas fa-clock"></i> Scheduled Creation
                </div>
                <div id="addLaterPreviewText" style="font-size: 0.9rem; color: var(--gray-700);">
                    Task will be added automatically
                </div>
            </div>
        </div>
    </div>
</div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-cancel" id="cancelTaskBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="saveTaskBtn">Save Task</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Intelligent Prioritization Modal -->
        <div class="modal" id="intelligentPrioModal" aria-modal="true" role="dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">🧠 Intelligent Prioritization</h3>
                    <button class="modal-close" id="intelligentPrioClose" aria-label="Close modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="intelligent-prio-container">
                        <div class="intelligent-prio-options">
                            <div class="intelligent-option active" id="autoPriorityOption">
                                <div class="intelligent-option-info">
                                    <div class="intelligent-option-icon">
                                        <i class="fas fa-magic"></i>
                                    </div>
                                    <div class="intelligent-option-content">
                                        <div class="intelligent-option-title">Auto-Prioritize Tasks</div>
                                        <div class="intelligent-option-description">
                                            Automatically set priority levels based on task content and keywords
                                        </div>
                                    </div>
                                </div>
                                <div class="intelligent-option-controls">
                                    <div class="toggle-switch active" id="autoPrioritySwitch">
                                        <div class="toggle-switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="intelligent-option active" id="keywordDetectionOption">
                                <div class="intelligent-option-info">
                                    <div class="intelligent-option-icon">
                                        <i class="fas fa-search"></i>
                                    </div>
                                    <div class="intelligent-option-content">
                                        <div class="intelligent-option-title">Smart Keyword Detection</div>
                                        <div class="intelligent-option-description">
                                            Detect priority keywords in real-time with instant suggestions
                                        </div>
                                    </div>
                                </div>
                                <div class="intelligent-option-controls">
                                    <div class="toggle-switch active" id="keywordDetectionSwitch">
                                        <div class="toggle-switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="intelligent-option active" id="smartSuggestionsOption">
                                <div class="intelligent-option-info">
                                    <div class="intelligent-option-icon">
                                        <i class="fas fa-lightbulb"></i>
                                    </div>
                                    <div class="intelligent-option-content">
                                        <div class="intelligent-option-title">AI-Powered Suggestions</div>
                                        <div class="intelligent-option-description">
                                            Get intelligent recommendations for task categorization and timing
                                        </div>
                                    </div>
                                </div>
                                <div class="intelligent-option-controls">
                                    <div class="toggle-switch active" id="smartSuggestionsSwitch">
                                        <div class="toggle-switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-cancel" id="cancelIntelligentPrio">Cancel</button>
                            <button type="button" class="btn btn-primary" id="createTaskWithAI">Create Task</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="modal delete-modal" id="deleteModal" aria-modal="true" role="dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Delete Task</h3>
                    <button class="modal-close" id="deleteModalClose" aria-label="Close delete modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <i class="fas fa-trash-alt delete-icon" aria-hidden="true"></i>
                    <p class="delete-message">
                        Are you sure you want to delete this task?
                        <strong id="deleteTaskTitle"></strong>
                        This action cannot be undone.
                    </p>
                    <div class="form-actions">
                        <button type="button" class="btn btn-cancel" id="cancelDeleteBtn">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification System -->
        <div class="notification-container" id="notificationContainer"></div>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            'use strict';

           
        // Update these constants at the top of your JavaScript
const APP_VERSION = "2.4";
const VERSION_FEATURES = {
    "2.4": {
        title: "🚀 Enhanced Productivity Features",
        description: "Advanced task scheduling, intelligent AI improvements, new analytics section and refined user experience.",
        features: [
            "⏰ Add Later: Schedule tasks to be automatically created at future dates and times",
            "🐛 Critical Bug Fixes: Resolved modal display issues and improved stability",
            "✨ User Experience Improvements: Smoother animations and enhanced accessibility",
            "📊 New analytics section! see your data of tasks in more detail",
        ]
    },
    "2.2.0": {
        title: "✨ Glass Design Revolution",
        description: "Premium glassmorphism UI with smoother animations and enhanced dark mode experience.",
        features: [
            "🌟 Modern glassmorphism sidebar with smooth animations",
            "🌙 Enhanced dark mode with proper search suggestions",
            "🎨 Premium glass effects and backdrop blur technology",
            "🚀 Improved performance and smoother transitions",
            "🔧 Critical bug fixes and accessibility improvements"
        ]
    }
};

            // Global Variables
let currentDetectionPopup = null; // Add this line
            let tasks = [];
            let currentFilter = 'all';
            let currentCategory = 'all';
            let intelligentPrioEnabled = true;
            let keywordDetectionEnabled = true;
            let smartSuggestionsEnabled = true;
            let taskToDelete = null;
            let smartSuggestions = [];
            let suggestionPatterns = {};
            let reminderSoundEnabled = true; // Set to false to disable sound
            let reminderSoundUrl = 'sounds/Alert notification.mp3'; // Replace with your actual file path
            // ADD THESE NEW GLOBAL VARIABLES
let addLaterTasks = [];
let addLaterCheckInterval = null;
let currentRescheduleTaskId = null;
// ADD THE NEW ANALYTICS VARIABLES HERE:
    let analyticsModal = null;
    let currentAnalyticsType = null;
    let completionSoundEnabled = true;
let completionSoundUrl = 'sounds/mixkit-software-interface-start-2574.wav';

    const categoryColors = {
    work: { bg: '#4f46e5', gradient: 'linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%)', icon: '<i class="fas fa-briefcase"></i>' },
    personal: { bg: '#06b6d4', gradient: 'linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)', icon: '<i class="fas fa-user"></i>' },
    shopping: { bg: '#10b981', gradient: 'linear-gradient(135deg, #10b981 0%, #059669 100%)', icon: '<i class="fas fa-shopping-cart"></i>' },
    health: { bg: '#f59e0b', gradient: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)', icon: '<i class="fas fa-heartbeat"></i>' },
    finance: { bg: '#ef4444', gradient: 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)', icon: '<i class="fas fa-dollar-sign"></i>' },
    education: { bg: '#8b5cf6', gradient: 'linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)', icon: '<i class="fas fa-graduation-cap"></i>' }
};

            // Load data with error handling
            try {
                const savedTasks = localStorage.getItem('tasks');
                tasks = savedTasks ? JSON.parse(savedTasks) : [];
            } catch (error) {
                console.error('Failed to load tasks:', error);
                tasks = [];
            }

            // ADD THIS AFTER THE EXISTING LOCALSTORAGE LOADING
try {
    const savedAddLaterTasks = localStorage.getItem('addLaterTasks');
    addLaterTasks = savedAddLaterTasks ? JSON.parse(savedAddLaterTasks) : [];
} catch (error) {
    console.error('Failed to load add later tasks:', error);
    addLaterTasks = [];
}

            // DOM Elements
            const categorySlider = document.getElementById('categorySlider');
            const currentCategoryEl = document.getElementById('currentCategory');
            const categoryDescriptionEl = document.getElementById('categoryDescription');
            const addTaskBtn = document.getElementById('addTaskBtn');
            const taskModal = document.getElementById('taskModal');
            const modalClose = document.getElementById('modalClose');
            const taskForm = document.getElementById('taskForm');
            const saveTaskBtn = document.getElementById('saveTaskBtn');
            const cancelTaskBtn = document.getElementById('cancelTaskBtn');
            const taskList = document.getElementById('taskList');
            const emptyState = document.getElementById('emptyState');
            const taskFilterBtns = document.querySelectorAll('.filter-btn');
            const searchInput = document.getElementById('searchInput');
            const dashboard = document.getElementById('dashboard');
            const deleteModal = document.getElementById('deleteModal');
            const deleteModalClose = document.getElementById('deleteModalClose');
            const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            const notificationContainer = document.getElementById('notificationContainer');
            const modalHeader = document.getElementById('modalHeader');
            const totalTasksValue = document.getElementById('totalTasksValue');
            const completedTasksValue = document.getElementById('completedTasksValue');
            const pendingTasksValue = document.getElementById('pendingTasksValue');
            const overdueTasksValue = document.getElementById('overdueTasksValue');
            const taskCountElements = document.querySelectorAll('.task-count');
            const taskListWrapper = document.getElementById('taskListWrapper');
            const appContainer = document.getElementById('appContainer');

            // AI Elements
            const aiTaskButton = document.getElementById('aiTaskButton');
            const aiTaskButtonContainer = document.getElementById('aiTaskButtonContainer');
            const intelligentPrioModal = document.getElementById('intelligentPrioModal');
            const intelligentPrioClose = document.getElementById('intelligentPrioClose');
            const cancelIntelligentPrio = document.getElementById('cancelIntelligentPrio');
            const createTaskWithAI = document.getElementById('createTaskWithAI');

            // Settings Elements
            const settingsBtn = document.getElementById('settingsBtn');
            const settingsPanel = document.getElementById('settingsPanel');
            const settingsOverlay = document.getElementById('settingsOverlay');
            const settingsClose = document.getElementById('settingsClose');

            // Theme Elements
            const themeToggle = document.getElementById('themeToggle');

            // Category descriptions and icons
            const categoryDescriptions = {
                all: 'View and manage all your tasks in one place.',
                work: 'Work tasks related to your job, projects, and professional commitments.',
                personal: 'Personal tasks for your daily life and individual goals.',
                shopping: 'Shopping lists and items you need to purchase.',
                health: 'Health and wellness related tasks including exercise, appointments, and medications.',
                finance: 'Financial tasks like bills, payments, and budget management.',
                education: 'Tasks related to learning, courses, and educational activities.'
            };

            const categoryIcons = {
                all: '<i class="fas fa-layer-group"></i>',
                work: '<i class="fas fa-briefcase"></i>',
                personal: '<i class="fas fa-user"></i>',
                shopping: '<i class="fas fa-shopping-cart"></i>',
                health: '<i class="fas fa-heartbeat"></i>',
                finance: '<i class="fas fa-dollar-sign"></i>',
                education: '<i class="fas fa-graduation-cap"></i>'
            };

            // Priority Keywords for AI
            const priorityKeywords = {
                high: [
                    'urgent', 'immediately', 'asap', 'critical', 'emergency', 'deadline', 
                    'now', 'rush', 'overdue', 'must do', 'crisis', 'fire', 'red alert',
                    'top priority', 'crucial', 'vital', 'essential', 'pressing', 'dire', 'quickly'
                ],
                medium: [
                    'soon', 'important', 'this week', 'priority', 'significant',
                    'needed', 'meeting', 'appointment', 'required', 'necessary', 'should do'
                ],
                low: [
                    'sometime', 'later', 'eventually', 'when possible', 'optional', 'maybe',
                    'if time', 'whenever', 'consider', 'explore', 'think about', 'future', 'in a while'
                ]
            };

            function playTaskCompletionSound() {
    if (!completionSoundEnabled) return;
    
    try {
        if (completionSoundUrl) {
            console.log('🔊 Playing task completion sound:', completionSoundUrl);
            const audio = new Audio(completionSoundUrl);
            audio.volume = 0.6;
            audio.play().catch(e => {
                console.log('Custom completion sound failed, trying default:', e);
                playDefaultCompletionSound();
            });
        } else {
            playDefaultCompletionSound();
        }
    } catch (error) {
        console.log('Completion sound playback failed:', error);
        playDefaultCompletionSound();
    }
}

function playDefaultCompletionSound() {
    try {
        // Method 1: Try simple completion tone
        const audio = completionSoundUrl = 'sounds/mixkit-software-interface-start-2574'
        audio.volume = 0.4;
        audio.play().catch(() => {
            // Method 2: Web Audio API fallback
            createCompletionNotificationSound();
        });
    } catch (error) {
        createCompletionNotificationSound();
    }
}

function createCompletionNotificationSound() {
    try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Create a pleasant "ding" sound for task completion
        const playTone = (frequency, startTime, duration, volume = 0.3) => {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, startTime);
            oscillator.type = 'sine';
            
            // Smooth envelope for pleasant sound
            gainNode.gain.setValueAtTime(0, startTime);
            gainNode.gain.linearRampToValueAtTime(volume, startTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            
            oscillator.start(startTime);
            oscillator.stop(startTime + duration);
        };
        
        // Play a pleasant completion chord
        const now = audioContext.currentTime;
        playTone(523.25, now, 0.2, 0.2); // C5
        playTone(659.25, now + 0.1, 0.3, 0.15); // E5
        playTone(783.99, now + 0.2, 0.4, 0.1); // G5
        
    } catch (error) {
        console.log('All completion sound methods failed:', error);
    }
}

function setCustomCompletionSound(soundFilePath) {
    console.log('🎵 Testing completion sound file:', soundFilePath);
    
    const audio = new Audio();
    
    audio.addEventListener('canplaythrough', () => {
        completionSoundUrl = soundFilePath;
        completionSoundEnabled = true;
        console.log('✅ Custom completion sound loaded successfully!');
        showNotification('🎵 Completion sound loaded!', 'success');
        
        // Test play the sound
        audio.volume = 0.6;
        audio.play().catch(e => console.log('Test play failed:', e));
    });
    
    audio.addEventListener('error', (e) => {
        console.warn('❌ Could not load completion sound file:', soundFilePath);
        console.warn('Error:', e);
        completionSoundUrl = null;
        completionSoundEnabled = true;
        showNotification('⚠️ Custom sound failed, using default', 'warning');
    });
    
    audio.src = soundFilePath;
    audio.load();
}

function testCompletionSound() {
    console.log('🔊 Testing completion sound...');
    playTaskCompletionSound();
    showNotification('🔊 Completion sound test played!', 'info');
}

            // Initialize App
            function initializeApp() {
    hideWelcomeAnimation();
    showApp();
    showVersionSplashScreen();
    initializeAIButton();
    initializeIntelligentPrio();
    initializeTheme();
    initializeSettings();
    initializeSearch();
    initializeTaskForm();
    initializeCategoryAndFilters();
    initializeModals();
    initializeSmartSuggestions(); // ADD THIS LINE
    enhanceCategoryHighlighting(); // ADD THIS LINE
    initializeAddLater(); // ADD THIS LINE
    initializeAnalytics(); // ADD THIS LINE
    renderTasks();
    updateDashboard();
    updateCategoryCounts();

    // Animate mini chart after everything loads
    setTimeout(() => {
        animateMiniChart();
    }, 2000);
}

            // Welcome Animation
            function hideWelcomeAnimation() {
                setTimeout(() => {
                    const welcomeOverlay = document.getElementById('welcomeOverlay');
                    if (welcomeOverlay) {
                        welcomeOverlay.style.opacity = '0';
                        welcomeOverlay.style.visibility = 'hidden';
                    }
                }, 3500);
            }

            function showApp() {
                setTimeout(() => {
                    const appContainer = document.getElementById('appContainer');
                    if (appContainer) {
                        appContainer.classList.add('visible');
                    }
                }, 4000);
            }

            // AI Button Initialization
            function initializeAIButton() {
                if (!aiTaskButton || !aiTaskButtonContainer) return;

                // Show AI button after welcome animation
                setTimeout(() => {
                    if (aiTaskButtonContainer) {
                        aiTaskButtonContainer.classList.add('show');
                        
                        setTimeout(() => {
                            aiTaskButton.classList.add('curtain-fill');
                            
                            setTimeout(() => {
                                aiTaskButton.classList.remove('curtain-fill');
                                aiTaskButton.classList.add('filled');
                            }, 800);
                        }, 600);
                    }
                }, 4200);

                // AI button click handler
                aiTaskButton.addEventListener('click', () => {
                    if (intelligentPrioModal) {
                        intelligentPrioModal.classList.add('active');
                    }
                });
            }

            // Intelligent Prioritization
            function initializeIntelligentPrio() {
                // Close handlers
                [intelligentPrioClose, cancelIntelligentPrio].forEach(btn => {
                    if (btn) {
                        btn.addEventListener('click', () => {
                            intelligentPrioModal.classList.remove('active');
                        });
                    }
                });

                // Create task with AI
                if (createTaskWithAI) {
                    createTaskWithAI.addEventListener('click', () => {
                        intelligentPrioModal.classList.remove('active');
                        openAddTaskModal();
                        enableIntelligentTaskCreation();
                    });
                }

                setupIntelligentPrioToggles();
            }

            function setupIntelligentPrioToggles() {
                const autoPriorityOption = document.getElementById('autoPriorityOption');
                const keywordDetectionOption = document.getElementById('keywordDetectionOption');
                const smartSuggestionsOption = document.getElementById('smartSuggestionsOption');

                if (autoPriorityOption) {
                    autoPriorityOption.addEventListener('click', () => {
                        const toggle = autoPriorityOption.querySelector('.toggle-switch');
                        toggle.classList.toggle('active');
                        intelligentPrioEnabled = toggle.classList.contains('active');
                        autoPriorityOption.classList.toggle('active', intelligentPrioEnabled);
                    });
                }

                if (keywordDetectionOption) {
                    keywordDetectionOption.addEventListener('click', () => {
                        const toggle = keywordDetectionOption.querySelector('.toggle-switch');
                        toggle.classList.toggle('active');
                        keywordDetectionEnabled = toggle.classList.contains('active');
                        keywordDetectionOption.classList.toggle('active', keywordDetectionEnabled);
                    });
                }

                if (smartSuggestionsOption) {
                    smartSuggestionsOption.addEventListener('click', () => {
                        const toggle = smartSuggestionsOption.querySelector('.toggle-switch');
                        toggle.classList.toggle('active');
                        smartSuggestionsEnabled = toggle.classList.contains('active');
                        smartSuggestionsOption.classList.toggle('active', smartSuggestionsEnabled);
                    });
                }
            }

            // Enhanced enableIntelligentTaskCreation function with better detection
function enableIntelligentTaskCreation() {
    const taskTitleInput = document.getElementById('taskTitle');
    if (!taskTitleInput) return;

    let detectionTimeout;
    let lastDetectedKeyword = null;

    // Function to detect and show popup
    function detectAndShowPopup() {
        if (!intelligentPrioEnabled || !keywordDetectionEnabled) return;

        const title = taskTitleInput.value.toLowerCase().trim();
        if (!title) {
            // Hide popup if text is empty
            if (currentDetectionPopup) {
                currentDetectionPopup.classList.remove('show');
                setTimeout(() => {
                    if (currentDetectionPopup) {
                        currentDetectionPopup.remove();
                        currentDetectionPopup = null;
                    }
                }, 300);
            }
            lastDetectedKeyword = null;
            return;
        }

        let detectedPriority = null;
        let detectedKeyword = null;

        // Check for priority keywords
        for (const [priority, keywords] of Object.entries(priorityKeywords)) {
            for (const keyword of keywords) {
                if (title.includes(keyword.toLowerCase())) {
                    detectedPriority = priority;
                    detectedKeyword = keyword;
                    break;
                }
            }
            if (detectedPriority) break;
        }

        // Only show popup if we found a keyword and it's different from the last one
        if (detectedPriority && detectedKeyword && detectedKeyword !== lastDetectedKeyword) {
            lastDetectedKeyword = detectedKeyword;
            showAIDetectionPopup(taskTitleInput, detectedPriority, detectedKeyword);
        } else if (!detectedPriority && currentDetectionPopup) {
            // Hide popup if no keyword detected and popup is showing
            currentDetectionPopup.classList.remove('show');
            setTimeout(() => {
                if (currentDetectionPopup) {
                    currentDetectionPopup.remove();
                    currentDetectionPopup = null;
                }
            }, 300);
            lastDetectedKeyword = null;
        }
    }

    // Real-time detection as user types
    taskTitleInput.addEventListener('input', function() {
        // Clear previous timeout
        clearTimeout(detectionTimeout);
        
        // Add small delay to avoid too many rapid detections
        detectionTimeout = setTimeout(() => {
            detectAndShowPopup();
        }, 300); // 300ms delay after user stops typing
    });

    // Also detect when field gets focus (for existing text)
    taskTitleInput.addEventListener('focus', function() {
        setTimeout(() => {
            detectAndShowPopup();
        }, 200);
    });

    // Hide popup when input loses focus
    taskTitleInput.addEventListener('blur', () => {
        setTimeout(() => {
            if (currentDetectionPopup) {
                currentDetectionPopup.classList.remove('show');
                setTimeout(() => {
                    if (currentDetectionPopup) {
                        currentDetectionPopup.remove();
                        currentDetectionPopup = null;
                    }
                }, 300);
            }
            lastDetectedKeyword = null;
        }, 200);
    });

    // Clear detection state when input is cleared
    taskTitleInput.addEventListener('keydown', function(e) {
        if (e.key === 'Backspace' || e.key === 'Delete') {
            setTimeout(() => {
                detectAndShowPopup();
            }, 50);
        }
    });
}



            function setPriorityWithAnimation(priority) {
                // Set priority with smooth animation
                const priorityInput = document.getElementById(`priority${priority.charAt(0).toUpperCase() + priority.slice(1)}`);
                if (priorityInput) {
                    priorityInput.checked = true;
                    
                    // Update visual selection with animation
                    document.querySelectorAll('.priority-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    const priorityOption = document.querySelector(`.priority-option.${priority}`);
                    if (priorityOption) {
                        priorityOption.classList.add('selected');
                    }
                }
            }

            // Theme Toggle
            function initializeTheme() {
                if (!themeToggle) return;
                
                if (localStorage.getItem('theme') === 'dark') {
                    document.body.classList.add('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                }
                
                themeToggle.addEventListener('click', () => {
                    document.body.classList.toggle('dark-mode');
                    
                    if (document.body.classList.contains('dark-mode')) {
                        localStorage.setItem('theme', 'dark');
                        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                    } else {
                        localStorage.setItem('theme', 'light');
                        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                    }
                });
            }

            // Settings Panel
            function initializeSettings() {
                if (!settingsBtn || !settingsPanel || !settingsOverlay || !settingsClose) return;
                
                settingsBtn.addEventListener('click', () => {
                    settingsPanel.classList.add('active');
                    settingsOverlay.classList.add('active');
                });
                
                settingsClose.addEventListener('click', () => {
                    settingsPanel.classList.remove('active');
                    settingsOverlay.classList.remove('active');
                });
                
                settingsOverlay.addEventListener('click', () => {
                    settingsPanel.classList.remove('active');
                    settingsOverlay.classList.remove('active');
                });

                // Settings toggles
                const autoSaveToggle = document.getElementById('autoSaveToggle');
                const notificationsToggle = document.getElementById('notificationsToggle');
                const compactViewToggle = document.getElementById('compactViewToggle');
                const exportData = document.getElementById('exportData');
                
                if (autoSaveToggle) {
                    autoSaveToggle.addEventListener('click', () => {
                        const toggle = autoSaveToggle.querySelector('.toggle-switch');
                        if (toggle) {
                            toggle.classList.toggle('active');
                            showNotification('Auto Save ' + (toggle.classList.contains('active') ? 'enabled' : 'disabled'), 'info');
                        }
                    });
                }
                
                if (notificationsToggle) {
                    notificationsToggle.addEventListener('click', () => {
                        const toggle = notificationsToggle.querySelector('.toggle-switch');
                        if (toggle) {
                            toggle.classList.toggle('active');
                            showNotification('Notifications ' + (toggle.classList.contains('active') ? 'enabled' : 'disabled'), 'info');
                        }
                    });
                }
                
                if (compactViewToggle) {
                    compactViewToggle.addEventListener('click', () => {
                        const toggle = compactViewToggle.querySelector('.toggle-switch');
                        if (toggle) {
                            toggle.classList.toggle('active');
                            showNotification('Compact View ' + (toggle.classList.contains('active') ? 'enabled' : 'disabled'), 'info');
                        }
                    });
                }
                
                if (exportData) {
                    exportData.addEventListener('click', () => {
                        try {
                            const now = new Date();
                            const dateStr = now.toISOString().split('T')[0];
                            const timeStr = now.toTimeString().split(' ')[0].replace(/:/g, '-');
                            
                            const exportDataObj = {
                                exportDate: now.toISOString(),
                                totalTasks: tasks.length,
                                tasks: tasks,
                                metadata: {
                                    version: '1.0',
                                    source: 'Tasklytic App'
                                }
                            };
                            
                            const jsonString = JSON.stringify(exportDataObj, null, 2);
                            const blob = new Blob([jsonString], { type: 'application/json' });
                            const url = URL.createObjectURL(blob);
                            
                            const link = document.createElement('a');
                            link.href = url;
                            link.download = `tasklytic-backup-${dateStr}_${timeStr}.json`;
                            
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            URL.revokeObjectURL(url);
                            
                            settingsPanel.classList.remove('active');
                            settingsOverlay.classList.remove('active');
                            
                            showNotification('Data exported successfully!', 'success');
                            
                        } catch (error) {
                            console.error('Export failed:', error);
                            showNotification('Export failed. Please try again.', 'error');
                        }
                    });
                }
            }

            // Task Management Functions
            function generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            function saveTasks() {
                try {
                    localStorage.setItem('tasks', JSON.stringify(tasks));
                } catch (error) {
                    console.error('Failed to save tasks:', error);
                    showNotification('Failed to save tasks', 'error');
                }
            }

            function saveAddLaterTasks() {
    try {
        localStorage.setItem('addLaterTasks', JSON.stringify(addLaterTasks));
        updateToBeAddedCounter(); // Update counter when saving
    } catch (error) {
        console.error('Failed to save add later tasks:', error);
    }
}

            // Function to set task reminder with better scheduling
function setTaskReminder(task) {
    if (!task.reminder || !task.reminder.enabled) return;
    
    const dueDate = new Date(task.dueDate);
    const reminderTime = new Date(dueDate.getTime() - (task.reminder.minutes * 60 * 1000));
    const now = new Date();
    
    console.log('Setting reminder for:', task.title);
    console.log('Due date:', dueDate);
    console.log('Reminder time:', reminderTime);
    console.log('Current time:', now);
    
    if (reminderTime > now) {
        const timeoutMs = reminderTime.getTime() - now.getTime();
        
        // Store reminder ID for potential cancellation
        const reminderId = setTimeout(() => {
            showReminderNotification(task);
        }, timeoutMs);
        
        // Store reminder info
        task.reminder.timeoutId = reminderId;
        
        showNotification(`⏰ Reminder set for ${task.reminder.minutes} minutes before due time`, 'success');
        console.log(`Reminder will trigger in ${Math.round(timeoutMs / 1000)} seconds`);
    } else {
        console.log('Reminder time has already passed');
        showNotification('⚠️ Reminder time has already passed', 'warning');
    }
}

// Enhanced function to show reminder notification with sliding animation and sound
function showReminderNotification(task) {
    console.log('Showing reminder for:', task.title);
    
    // Play sound if enabled
    playReminderSound();
    
    // Create enhanced reminder banner
    const banner = document.createElement('div');
    banner.className = 'reminder-notification';
    
    const dueDate = new Date(task.dueDate);
    const timeUntilDue = Math.ceil((dueDate.getTime() - new Date().getTime()) / (1000 * 60));
    
    banner.innerHTML = `
        <div class="reminder-notification-content">
            <div class="reminder-notification-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="reminder-notification-text">
                <div class="reminder-notification-title">📋 Task Reminder</div>
                <div class="reminder-notification-message">${task.title}</div>
                <div class="reminder-notification-time">Due in ${timeUntilDue} minutes</div>
            </div>
        </div>
        <button class="reminder-notification-close" aria-label="Dismiss reminder">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    document.body.appendChild(banner);
    
    // Show with sliding animation FROM LEFT
    setTimeout(() => {
        banner.classList.add('show');
    }, 100);
    
    // Manual close button handler
    const closeBtn = banner.querySelector('.reminder-notification-close');
    closeBtn.addEventListener('click', () => {
        dismissReminderBanner(banner);
    });
    
    // Auto-dismiss after 15 seconds (longer for reminders)
    setTimeout(() => {
        dismissReminderBanner(banner);
    }, 15000);
    
    // Mark as notified
    const taskIndex = tasks.findIndex(t => t.id === task.id);
    if (taskIndex !== -1) {
        tasks[taskIndex].reminder.notified = true;
        saveTasks();
    }
    
    // Show success notification in main system too
    showNotification(`🔔 Reminder: ${task.title}`, 'info');
}

// Function to dismiss reminder banner with smooth animation
function dismissReminderBanner(banner) {
    if (!banner || !banner.parentElement) return;
    
    banner.classList.remove('show');
    setTimeout(() => {
        if (banner.parentElement) {
            banner.remove();
        }
    }, 600);
}

// Enhanced sound functionality that actually works
function playReminderSound() {
    if (!reminderSoundEnabled) return;
    
    try {
        if (reminderSoundUrl) {
            // Use custom sound file
            console.log('🔊 Playing custom sound:', reminderSoundUrl);
            const audio = new Audio(reminderSoundUrl);
            audio.volume = 0.7;
            audio.play().catch(e => {
                console.log('Custom sound failed, trying default:', e);
                playDefaultNotificationSound();
            });
        } else {
            // Use default sound
            console.log('🔊 Playing default notification sound');
            playDefaultNotificationSound();
        }
    } catch (error) {
        console.log('Sound playback failed:', error);
        playDefaultNotificationSound();
    }
}

// Reliable default notification sound
function playDefaultNotificationSound() {
    try {
        // Method 1: Try simple beep data URL
        const audio = new Audio('data:sounds/Alert notification.mp3');
        audio.volume = 0.5;
        audio.play().catch(() => {
            // Method 2: Web Audio API fallback
            createWebAudioNotificationSound();
        });
    } catch (error) {
        // Method 3: Last resort Web Audio API
        createWebAudioNotificationSound();
    }
}

// Improved Web Audio API sound
function createWebAudioNotificationSound() {
    try {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Create a pleasant notification sound sequence
        const playTone = (frequency, startTime, duration) => {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(frequency, startTime);
            oscillator.type = 'sine';
            
            // Smooth envelope
            gainNode.gain.setValueAtTime(0, startTime);
            gainNode.gain.linearRampToValueAtTime(0.3, startTime + 0.01);
            gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
            
            oscillator.start(startTime);
            oscillator.stop(startTime + duration);
        };
        
        // Play a pleasant two-tone notification
        const now = audioContext.currentTime;
        playTone(800, now, 0.15);
        playTone(1000, now + 0.15, 0.15);
        
    } catch (error) {
        console.log('All sound methods failed:', error);
    }
}

// Function to set custom notification sound with testing
function setCustomNotificationSound(soundFilePath) {
    console.log('🎵 Testing sound file:', soundFilePath);
    
    const audio = new Audio();
    
    audio.addEventListener('canplaythrough', () => {
        reminderSoundUrl = soundFilePath;
        reminderSoundEnabled = true;
        console.log('✅ Custom notification sound loaded successfully!');
        showNotification('🎵 Custom sound loaded!', 'success');
        
        // Test play the sound
        audio.volume = 0.7;
        audio.play().catch(e => console.log('Test play failed:', e));
    });
    
    audio.addEventListener('error', (e) => {
        console.warn('❌ Could not load sound file:', soundFilePath);
        console.warn('Error:', e);
        reminderSoundUrl = 'sounds/notification.mp3';
        reminderSoundEnabled = true;
        showNotification('⚠️ Custom sound failed, using default', 'warning');
    });
    
    audio.src = soundFilePath;
    audio.load();
}

// Test function to play notification sound immediately
function testNotificationSound() {
    console.log('🔊 Testing notification sound...');
    playReminderSound();
    showNotification('🔊 Sound test played!', 'info');
}

            // Enhanced AI detection popup click handler
function showAIDetectionPopup(inputElement, detectedPriority, keyword) {
    // Remove existing popup
    if (currentDetectionPopup) {
        currentDetectionPopup.remove();
        currentDetectionPopup = null;
    }

    const popup = document.createElement('div');
    popup.className = 'ai-detection-popup';
    popup.innerHTML = `
        <i class="fas fa-wand-magic-sparkles"></i>
        Intelligent prioritization detected "${keyword}"
    `;

    // Position popup above input
    const inputRect = inputElement.getBoundingClientRect();
    popup.style.position = 'fixed';
    popup.style.left = `${inputRect.left + (inputRect.width / 2)}px`;
    popup.style.top = `${inputRect.top - 70}px`;
    popup.style.transform = 'translateX(-50%)';
    popup.style.zIndex = '2001';

    document.body.appendChild(popup);
    currentDetectionPopup = popup;

    // Show popup with animation
    setTimeout(() => {
        popup.classList.add('show');
    }, 50);

    // Handle popup click with enhanced wave animation
    popup.addEventListener('click', () => {
        // Hide popup immediately
        popup.remove();
        currentDetectionPopup = null;
        
        // Show wave animation in task title container
        showPrioritizingWaveAnimation(() => {
            // Set priority after wave animation completes
            setPriorityWithAnimation(detectedPriority);
            
            // Enhanced category mapping
            const categoryMapping = {
                'meeting': 'work',
                'appointment': 'health', 
                'deadline': 'work',
                'urgent': 'work',
                'asap': 'work',
                'critical': 'work',
                'emergency': 'work',
                'buy': 'shopping',
                'purchase': 'shopping',
                'shop': 'shopping',
                'store': 'shopping',
                'exercise': 'health',
                'workout': 'health',
                'gym': 'health',
                'doctor': 'health',
                'hospital': 'health',
                'study': 'education',
                'homework': 'education',
                'school': 'education',
                'learn': 'education',
                'course': 'education',
                'bill': 'finance',
                'pay': 'finance',
                'money': 'finance',
                'budget': 'finance',
                'bank': 'finance',
                'work': 'work',
                'job': 'work',
                'project': 'work',
                'office': 'work',
                'business': 'work',
                'personal': 'personal',
                'family': 'personal',
                'friend': 'personal',
                'home': 'personal'
            };
            
            const suggestedCategory = categoryMapping[keyword.toLowerCase()] || null;
            
            let message = `🧠 AI set priority to ${detectedPriority.toUpperCase()}`;
            if (suggestedCategory) {
                message += ` and suggested ${suggestedCategory} category`;
                setSuggestedCategory(suggestedCategory);
            }
            
            showNotification(message, 'success');
        });
    });

    // Auto-hide after 10 seconds
    setTimeout(() => {
        if (currentDetectionPopup === popup) {
            popup.classList.remove('show');
            setTimeout(() => {
                if (popup.parentElement) {
                    popup.remove();
                }
                currentDetectionPopup = null;
            }, 300);
        }
    }, 10000);
}

// ADD THE NEW FUNCTION HERE - RIGHT AFTER showAIDetectionPopup
        function checkForKeywordsInText(inputElement) {
            if (!intelligentPrioEnabled || !keywordDetectionEnabled) return;

            const title = inputElement.value.toLowerCase();
            if (!title.trim()) return;

            let detectedPriority = null;
            let detectedKeyword = null;

            // Check for priority keywords
            for (const [priority, keywords] of Object.entries(priorityKeywords)) {
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        detectedPriority = priority;
                        detectedKeyword = keyword;
                        break;
                    }
                }
                if (detectedPriority) break;
            }

            // Show AI detection popup if keyword found
            if (detectedPriority && detectedKeyword) {
                showAIDetectionPopup(inputElement, detectedPriority, detectedKeyword);
            }
        }


// Enhanced showPrioritizingWaveAnimation with perfect container fitting
function showPrioritizingWaveAnimation(callback) {
    const taskTitleInput = document.getElementById('taskTitle');
    if (!taskTitleInput) {
        if (callback) callback();
        return;
    }

    // Get the task title value for display
    const taskTitleValue = taskTitleInput.value.trim() || 'New Task';
    
    // Find the input group container for perfect fitting
    let targetContainer = taskTitleInput.closest('.input-group');
    if (!targetContainer) {
        targetContainer = taskTitleInput.closest('.form-group');
    }
    
    if (!targetContainer) {
        if (callback) callback();
        return;
    }

    // Add positioning classes to containers
    const formGroup = taskTitleInput.closest('.form-group');
    if (formGroup) {
        formGroup.classList.add('task-title-container');
    }
    
    // Get exact dimensions of the input group for perfect fitting
    const containerRect = targetContainer.getBoundingClientRect();
    const inputRect = taskTitleInput.getBoundingClientRect();
    
    // Create wave container with perfect dimensions
    const waveContainer = document.createElement('div');
    waveContainer.className = 'prioritizing-wave-container';
    
    // Truncate long titles for better display
    const displayTitle = taskTitleValue.length > 30 ? 
        taskTitleValue.substring(0, 30) + '...' : taskTitleValue;
    
    waveContainer.innerHTML = `
        <div class="task-title-wave">${displayTitle}</div>
        <div class="prioritizing-text">Prioritizing</div>
        <div class="wave-bars">
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
            <div class="wave-bar"></div>
        </div>
    `;

    // Position wave container to perfectly fit the input group
    waveContainer.style.position = 'absolute';
    waveContainer.style.top = '0px';
    waveContainer.style.left = '0px';
    waveContainer.style.width = '100%';
    waveContainer.style.height = '100%';
    waveContainer.style.zIndex = '1000';

    // Add wave container to the target container
    targetContainer.style.position = 'relative';
    targetContainer.appendChild(waveContainer);
    
    // Add wave effect to input
    taskTitleInput.classList.add('wave-active');
    
    // Ensure input is visible but highlighted
    taskTitleInput.style.position = 'relative';
    taskTitleInput.style.zIndex = '1001';

    // Show animation with perfect timing
    setTimeout(() => {
        waveContainer.classList.add('active');
    }, 50);

    // Start smooth fade out after 1.5 seconds
    setTimeout(() => {
        waveContainer.classList.add('fade-out');
    }, 1500);

    // Complete fade out and cleanup after 2 seconds
    setTimeout(() => {
        waveContainer.classList.remove('active');
        taskTitleInput.classList.remove('wave-active');
        
        // Remove styles and cleanup
        taskTitleInput.style.position = '';
        taskTitleInput.style.zIndex = '';
        targetContainer.style.position = '';
        
        // Remove container after fade animation completes
        setTimeout(() => {
            if (waveContainer.parentElement) {
                waveContainer.remove();
            }
            if (formGroup) {
                formGroup.classList.remove('task-title-container');
            }
            
            // Execute callback after cleanup
            if (callback) callback();
        }, 800); // Wait for fade-out animation
    }, 2000);
}

// Add this function to suggest category
function setSuggestedCategory(category) {
    const categoryInput = document.getElementById(`category${category.charAt(0).toUpperCase() + category.slice(1)}`);
    if (categoryInput) {
        categoryInput.checked = true;
        
        // Update visual selection
        document.querySelectorAll('.category-option').forEach(opt => {
            opt.classList.remove('selected');
        });
        
        const categoryOption = document.querySelector(`.category-option.${category}`);
        if (categoryOption) {
            categoryOption.classList.add('selected');
        }
    }
}

function showVersionSplashScreen() {
    console.log('🎬 Checking version splash screen...');
    
    const seenVersions = JSON.parse(localStorage.getItem('seenVersions') || '[]');
    
    if (!seenVersions.includes(APP_VERSION) && VERSION_FEATURES[APP_VERSION]) {
        const splash = document.createElement('div');
        splash.className = 'version-splash-overlay';
        
        const features = VERSION_FEATURES[APP_VERSION];
        const featuresList = features.features.map((feature, index) => {
            // Enhanced Add Later demo
            if (index === 0 && feature.includes('Add Later')) {
                return `
                    <li>
                        <i class="fas fa-check"></i>
                        ${feature}
                        <div class="enhanced-add-later-demo">
                            <div class="mini-add-later-interface">
                                <div class="demo-header">
                                    <div class="demo-title">
                                        <i class="fas fa-clock"></i>
                                        Schedule Task Creation
                                    </div>
                                    <div class="demo-toggle" id="demoToggle">
                                        <div class="demo-toggle-handle"></div>
                                    </div>
                                </div>
                                
                                <div class="demo-form" id="demoForm">
                                    <input type="text" class="demo-task-input" id="demoTaskInput" placeholder="Enter task title..." value="Weekly team meeting" readonly>
                                    
                                    <div class="demo-datetime-row">
                                        <input type="text" class="demo-date-input" id="demoDateInput" value="Tomorrow" readonly>
                                        <input type="text" class="demo-time-input" id="demoTimeInput" value="09:00" readonly>
                                    </div>
                                    
                                    <div class="demo-preview-box" id="demoPreview">
                                        <div class="demo-preview-text">
                                            <i class="fas fa-info-circle"></i>
                                            <span id="demoPreviewText">Task will be added tomorrow at 09:00</span>
                                        </div>
                                    </div>
                                    
                                    <button class="demo-schedule-btn" id="demoScheduleBtn">
                                        <i class="fas fa-calendar-plus"></i> Schedule Task
                                    </button>
                                </div>
                                
                                <div class="demo-success-animation" id="demoSuccess">
                                    <i class="fas fa-check-circle"></i> Task Scheduled Successfully!
                                </div>
                            </div>
                        </div>
                    </li>
                `;
            }
            return `<li><i class="fas fa-check"></i>${feature}</li>`;
        }).join('');

        splash.innerHTML = `
            <div class="version-splash-content">
                <div class="version-splash-header">
                    <h2 class="version-splash-title">${features.title}</h2>
                    <p class="version-splash-description">${features.description}</p>
                </div>
                
                <div class="version-splash-scrollable">
                    <div class="version-splash-features">
                        <h4 style="color: white; margin-bottom: 1.5rem; font-size: 1.3rem; text-align: center;">
                            🎉 What's New in v${APP_VERSION}:
                        </h4>
                        <ul>${featuresList}</ul>
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.25rem; background: rgba(255, 255, 255, 0.08); border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px);">
                        <h5 style="color: rgba(255, 255, 255, 0.95); margin-bottom: 0.75rem; font-size: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-universal-access"></i> Accessibility & Performance
                        </h5>
                        <p style="color: rgba(255, 255, 255, 0.8); font-size: 0.9rem; line-height: 1.5; margin: 0;">
                            Enhanced keyboard navigation, improved screen reader compatibility, faster loading times, and optimized mobile experience for all users.
                        </p>
                    </div>
                </div>
                
                <div class="version-splash-footer">
                    <div class="version-splash-actions">
                        <button class="version-splash-close primary" id="primaryCloseBtn">
                            <i class="fas fa-rocket"></i> Explore Features
                        </button>
                        <button class="version-splash-skip" id="skipTourBtn">
                            <i class="fas fa-forward"></i> Skip Tour
                        </button>
                    </div>
                </div>
            </div>
        `;

        document.body.appendChild(splash);

        // Show splash after welcome animation completes
        setTimeout(() => {
            splash.classList.add('show');
            initializeEnhancedDemo();
        }, 4200);

        // Enhanced button handlers
        const primaryBtn = splash.querySelector('#primaryCloseBtn');
        const skipBtn = splash.querySelector('#skipTourBtn');
        
        const handleClose = (source) => {
            console.log(`🎯 Closing splash via: ${source}`);
            splash.classList.remove('show');
            setTimeout(() => {
                splash.remove();
            }, 600);
            
            seenVersions.push(APP_VERSION);
            localStorage.setItem('seenVersions', JSON.stringify(seenVersions));
            
            if (source === 'primary') {
                // Show a welcome message for primary close
                setTimeout(() => {
                    if (typeof showNotification === 'function') {
                        showNotification('🚀 Welcome to the enhanced Tasklytic experience!', 'success');
                    }
                }, 1000);
            }
        };

        primaryBtn.addEventListener('click', () => handleClose('primary'));
        skipBtn.addEventListener('click', () => handleClose('skip'));

        // Enhanced keyboard navigation
        splash.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                handleClose('keyboard');
            } else if (e.key === 'Enter') {
                primaryBtn.click();
            }
        });

        // Focus management
        setTimeout(() => {
            primaryBtn.focus();
        }, 500);
    }
}

// Enhanced demo functionality
function initializeEnhancedDemo() {
    const toggle = document.getElementById('demoToggle');
    const form = document.getElementById('demoForm');
    const taskInput = document.getElementById('demoTaskInput');
    const dateInput = document.getElementById('demoDateInput');
    const timeInput = document.getElementById('demoTimeInput');
    const preview = document.getElementById('demoPreview');
    const previewText = document.getElementById('demoPreviewText');
    const scheduleBtn = document.getElementById('demoScheduleBtn');
    const success = document.getElementById('demoSuccess');
    
    if (!toggle || !form) return;
    
    let isToggleActive = false;
    let demoStep = 0;
    let demoInterval;
    
    // Sample tasks and dates for cycling
    const demoData = [
        { 
            task: "Weekly team meeting", 
            date: "Tomorrow", 
            time: "09:00",
            preview: "Task will be added tomorrow at 09:00 AM"
        },
        { 
            task: "Doctor appointment", 
            date: "Friday", 
            time: "14:30",
            preview: "Task will be added Friday at 2:30 PM"
        },
        { 
            task: "Grocery shopping", 
            date: "Weekend", 
            time: "10:00",
            preview: "Task will be added this weekend at 10:00 AM"
        },
        { 
            task: "Project deadline", 
            date: "Next Week", 
            time: "17:00",
            preview: "Task will be added next week at 5:00 PM"
        }
    ];
    
    // Toggle functionality
    toggle.addEventListener('click', () => {
        isToggleActive = !isToggleActive;
        toggle.classList.toggle('active', isToggleActive);
        form.classList.toggle('active', isToggleActive);
        
        if (isToggleActive) {
            preview.classList.add('show');
            startDataCycling();
        } else {
            preview.classList.remove('show');
            stopDataCycling();
        }
    });
    
    // Schedule button functionality
    scheduleBtn.addEventListener('click', () => {
        if (!isToggleActive) return;
        
        // Show success animation
        success.classList.add('show');
        scheduleBtn.style.transform = 'scale(0.95)';
        
        setTimeout(() => {
            success.classList.remove('show');
            scheduleBtn.style.transform = '';
            
            // Advance to next demo data
            advanceDemo();
        }, 2000);
    });
    
    function startDataCycling() {
        // Initial update
        updateDemoData();
        
        // Start cycling every 4 seconds
        demoInterval = setInterval(() => {
            advanceDemo();
        }, 4000);
    }
    
    function stopDataCycling() {
        if (demoInterval) {
            clearInterval(demoInterval);
            demoInterval = null;
        }
    }
    
    function advanceDemo() {
        demoStep = (demoStep + 1) % demoData.length;
        updateDemoData();
    }
    
    function updateDemoData() {
        const currentData = demoData[demoStep];
        
        // Animate field changes
        [taskInput, dateInput, timeInput].forEach(input => {
            input.style.opacity = '0.6';
            input.style.transform = 'scale(0.98)';
        });
        
        setTimeout(() => {
            taskInput.value = currentData.task;
            dateInput.value = currentData.date;
            timeInput.value = currentData.time;
            previewText.textContent = currentData.preview;
            
            [taskInput, dateInput, timeInput].forEach(input => {
                input.style.opacity = '1';
                input.style.transform = 'scale(1)';
            });
            
            // Subtle preview update animation
            preview.style.transform = 'scale(1.02)';
            setTimeout(() => {
                preview.style.transform = 'scale(1)';
            }, 200);
        }, 300);
    }
    
    // Auto-activate toggle after 3 seconds to demonstrate
    setTimeout(() => {
        if (!isToggleActive) {
            toggle.click();
        }
    }, 3000);
    
    console.log('✅ Enhanced Add Later demo initialized');
}


            // Enhanced modal opening with perfect container setup
function openAddTaskModal() {
    if (!taskForm || !taskModal) return;
    
    taskForm.reset();
    document.getElementById('taskId').value = '';
    
    const today = new Date();
    const formattedDate = today.toISOString().substr(0, 10);
    const taskDueDate = document.getElementById('taskDueDate');
    if (taskDueDate) taskDueDate.value = formattedDate;
    
    document.querySelectorAll('.form-error').forEach(error => {
        error.style.display = 'none';
    });
    
    document.querySelectorAll('.category-option, .priority-option').forEach(option => {
        option.classList.remove('selected');
    });
    
    if (currentCategory !== 'all') {
        const categoryInput = document.getElementById(`category${currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1)}`);
        if (categoryInput) {
            categoryInput.checked = true;
            const categoryOption = document.querySelector(`.category-option.${currentCategory}`);
            if (categoryOption) categoryOption.classList.add('selected');
        }
    }

    // Add this to ensure Add Later tab is active by default
document.querySelectorAll('.task-form-tab').forEach(tab => tab.classList.remove('active'));
document.querySelectorAll('.task-form-content').forEach(content => content.classList.remove('active'));

// Make Add Later tab active by default
const addLaterTab = document.querySelector('.task-form-tab[data-tab="addlater"]');
const addLaterContent = document.getElementById('addlaterTab');

if (addLaterTab) addLaterTab.classList.add('active');
if (addLaterContent) addLaterContent.classList.add('active');
    
    const modalTitle = document.getElementById('modalTitle');
    if (modalTitle) modalTitle.textContent = 'Add New Task';
    
    if (modalHeader) modalHeader.className = 'modal-header';
    
    taskModal.classList.add('active');
    
    // Enhanced focus and container setup
    setTimeout(() => {
        const taskTitleInput = document.getElementById('taskTitle');
        if (taskTitleInput) {
            // Ensure perfect container setup
            const inputGroup = taskTitleInput.closest('.input-group');
            const formGroup = taskTitleInput.closest('.form-group');
            
            if (inputGroup) {
                inputGroup.style.overflow = 'visible';
                inputGroup.style.position = 'relative';
            }
            if (formGroup) {
                formGroup.style.overflow = 'visible';
                formGroup.style.position = 'relative';
            }
            
            taskTitleInput.focus();
            // Enable intelligent task creation
            enableIntelligentTaskCreation();
        }
    }, 100);
}

// Enhanced editTask function to trigger AI check for existing text
function editTask(taskId) {
    const task = tasks.find(t => t.id === taskId);
    if (!task || !taskForm || !taskModal) return;
    
    document.getElementById('taskId').value = task.id;
    
    const taskTitle = document.getElementById('taskTitle');
    const taskDescription = document.getElementById('taskDescription');
    
    if (taskTitle) taskTitle.value = task.title;
    if (taskDescription) taskDescription.value = task.description || '';
    
    const categoryInput = document.getElementById(`category${task.category.charAt(0).toUpperCase() + task.category.slice(1)}`);
    if (categoryInput) {
        categoryInput.checked = true;
        document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
        const categoryOption = document.querySelector(`.category-option.${task.category}`);
        if (categoryOption) categoryOption.classList.add('selected');
    }
    
    const priorityInput = document.getElementById(`priority${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}`);
    if (priorityInput) {
        priorityInput.checked = true;
        document.querySelectorAll('.priority-option').forEach(opt => opt.classList.remove('selected'));
        const priorityOption = document.querySelector(`.priority-option.${task.priority}`);
        if (priorityOption) priorityOption.classList.add('selected');
    }
    
    const dueDate = new Date(task.dueDate);
    const taskDueDate = document.getElementById('taskDueDate');
    const taskDueTime = document.getElementById('taskDueTime');
    
    if (taskDueDate) {
        taskDueDate.value = dueDate.toISOString().substr(0, 10);
    }
    
    if (taskDueTime) {
        const hours = dueDate.getHours().toString().padStart(2, '0');
        const minutes = dueDate.getMinutes().toString().padStart(2, '0');
        taskDueTime.value = `${hours}:${minutes}`;
    }
    
    const modalTitle = document.getElementById('modalTitle');
    if (modalTitle) modalTitle.textContent = 'Edit Task';
    if (modalHeader) modalHeader.className = `modal-header ${task.category}`;
    
    taskModal.classList.add('active');
    
    // Enable AI detection for existing text when editing
    setTimeout(() => {
        const taskTitleInput = document.getElementById('taskTitle');
        if (taskTitleInput) {
            taskTitleInput.focus();
            // Check existing text for keywords
            checkForKeywordsInText(taskTitleInput);
            // Re-enable intelligent task creation for this modal instance
            enableIntelligentTaskCreation();
        }
    }, 100);
}

            function confirmDeleteTask(taskId) {
                const task = tasks.find(t => t.id === taskId);
                if (!task || !deleteModal) return;
                
                taskToDelete = taskId;
                
                const deleteTaskTitle = document.getElementById('deleteTaskTitle');
                if (deleteTaskTitle) {
                    deleteTaskTitle.textContent = `"${task.title}"`;
                }
                
                deleteModal.classList.add('active');
            }

            function deleteTask(taskId) {
                tasks = tasks.filter(task => task.id !== taskId);
                saveTasks();
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
                showNotification('Task deleted successfully', 'success');
            }

            function toggleTaskCompletion(taskId) {
    const taskIndex = tasks.findIndex(task => task.id === taskId);
    if (taskIndex !== -1) {
        const wasCompleted = tasks[taskIndex].completed;
        tasks[taskIndex].completed = !tasks[taskIndex].completed;
        tasks[taskIndex].modifiedAt = new Date().toISOString();
        
        if (tasks[taskIndex].completed && !wasCompleted) {
            // Task was just completed
            tasks[taskIndex].completedAt = new Date().toISOString();
            
            // Play completion sound
            playTaskCompletionSound();
            
            showNotification(`🎉 Task "${tasks[taskIndex].title}" completed!`, 'success');
        } else if (!tasks[taskIndex].completed && wasCompleted) {
            // Task was uncompleted
            delete tasks[taskIndex].completedAt;
        }
        
        saveTasks();
        renderTasks();
        updateDashboard();
        updateCategoryCounts();
    }
}

            function renderTasks() {
                if (!taskList) return;
                
                let filteredTasks = tasks;
                
                if (currentCategory !== 'all') {
                    filteredTasks = filteredTasks.filter(task => task.category === currentCategory);
                }
                
                if (currentFilter !== 'all') {
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    switch (currentFilter) {
                        case 'pending':
                            filteredTasks = filteredTasks.filter(task => !task.completed);
                            break;
                        case 'completed':
                            filteredTasks = filteredTasks.filter(task => task.completed);
                            break;
                        case 'overdue':
                            filteredTasks = filteredTasks.filter(task => {
                                const dueDate = new Date(task.dueDate);
                                return !task.completed && dueDate < new Date();
                            });
                            break;
                        case 'today':
                            filteredTasks = filteredTasks.filter(task => {
                                const dueDate = new Date(task.dueDate);
                                dueDate.setHours(0, 0, 0, 0);
                                return dueDate.getTime() === today.getTime();
                            });
                            break;
                    }
                }
                
                filteredTasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
                
                if (filteredTasks.length === 0) {
                    taskList.innerHTML = '';
                    
                    let emptyStateMessage = 'No tasks yet';
                    let emptyStateDescription = 'Add your first task to get started';
                    
                    if (currentFilter !== 'all') {
                        switch (currentFilter) {
                            case 'pending':
                                emptyStateMessage = 'No pending tasks';
                                emptyStateDescription = 'All tasks are completed!';
                                break;
                            case 'completed':
                                emptyStateMessage = 'No completed tasks';
                                emptyStateDescription = 'Complete some tasks to see them here';
                                break;
                            case 'overdue':
                                emptyStateMessage = 'No overdue tasks';
                                emptyStateDescription = "You're on track! Keep it up!";
                                break;
                            case 'today':
                                emptyStateMessage = 'No tasks due today';
                                emptyStateDescription = 'Enjoy your day!';
                                break;
                        }
                    }
                    
                    const emptyStateHtml = `
                        <div class="empty-state" id="emptyState">
                            <i class="fas fa-clipboard-list" aria-hidden="true"></i>
                            <h3>${emptyStateMessage}</h3>
                            <p>${emptyStateDescription}</p>
                        </div>
                    `;
                    
                    taskList.innerHTML = emptyStateHtml;
                    
                    const emptyStateEl = document.getElementById('emptyState');
                    if (emptyStateEl) {
                        emptyStateEl.addEventListener('click', () => {
                            openAddTaskModal();
                        });
                    }
                    
                    return;
                }
                
                taskList.innerHTML = '';
                taskList.className = 'task-list';
                if (currentCategory !== 'all') {
                    taskList.classList.add(currentCategory);
                }
                
                filteredTasks.forEach(task => {
                    const dueDate = new Date(task.dueDate);
                    const formattedDate = new Intl.DateTimeFormat('en-US', {
                        month: 'short',
                        day: 'numeric'
                    }).format(dueDate);
                    
                    const formattedTime = new Intl.DateTimeFormat('en-US', {
                        hour: 'numeric',
                        minute: 'numeric',
                        hour12: true
                    }).format(dueDate);
                    
                    const isOverdue = !task.completed && dueDate < new Date();
                    
                    let priorityClass = '';
                    switch (task.priority) {
                        case 'low':
                            priorityClass = 'success';
                            break;
                        case 'medium':
                            priorityClass = 'warning';
                            break;
                        case 'high':
                            priorityClass = 'danger';
                            break;
                    }
                    
                    const taskEl = document.createElement('div');
                    taskEl.className = `task-item ${task.completed ? 'completed' : ''} ${isOverdue ? 'overdue' : ''}`;
                    taskEl.dataset.id = task.id;
                    
                    taskEl.innerHTML = `
                        <div class="task-checkbox">
                            <input type="checkbox" ${task.completed ? 'checked' : ''} aria-label="Mark task as ${task.completed ? 'incomplete' : 'complete'}">
                        </div>
                        <div class="task-content">
                            <div class="task-title">${task.title}</div>
                            ${task.description ? `<div class="task-description">${task.description}</div>` : ''}
                            <div class="task-meta">
                                <div class="task-category">
                                    ${categoryIcons[task.category]} ${task.category.charAt(0).toUpperCase() + task.category.slice(1)}
                                </div>
                                <div class="task-priority task-${task.priority}" style="background-color: var(--${priorityClass}-light); color: var(--${priorityClass});">
                                    ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                                </div>
                                <div class="task-date">
                                    <i class="fas fa-calendar"></i> ${formattedDate}
                                </div>
                                <div class="task-time">
                                    <i class="fas fa-clock"></i> ${formattedTime}
                                </div>
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="task-action-btn edit" aria-label="Edit task">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <button class="task-action-btn delete" aria-label="Delete task">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                    
                    const checkbox = taskEl.querySelector('.task-checkbox input');
                    if (checkbox) {
                        checkbox.addEventListener('change', (e) => {
                            e.stopPropagation();
                            toggleTaskCompletion(task.id);
                        });
                    }
                    
                    const editBtn = taskEl.querySelector('.task-action-btn.edit');
                    if (editBtn) {
                        editBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            editTask(task.id);
                        });
                    }
                    
                    const deleteBtn = taskEl.querySelector('.task-action-btn.delete');
                    if (deleteBtn) {
                        deleteBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            e.preventDefault();
                            confirmDeleteTask(task.id);
                        });
                    }
                    
                    taskList.appendChild(taskEl);
                });
            }

            function renderTasksWithAdvancedFilter() {
    if (!currentAdvancedFilter) {
        renderTasks();
        return;
    }

    let filteredTasks = [...tasks];
    const { type, value } = currentAdvancedFilter;

    // Apply category filter first
    if (currentCategory !== 'all') {
        filteredTasks = filteredTasks.filter(task => task.category === currentCategory);
    }

    // Apply advanced filter
    switch (type) {
        case 'frequent':
            switch (value) {
                case 'recent':
                    filteredTasks.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
                    break;
                case 'modified':
                    filteredTasks.sort((a, b) => new Date(b.modifiedAt) - new Date(a.modifiedAt));
                    break;
                case 'accessed':
                    // You can implement access tracking later
                    filteredTasks = filteredTasks.slice(0, Math.floor(filteredTasks.length / 2));
                    break;
            }
            break;
            
        case 'priority':
            filteredTasks = filteredTasks.filter(task => task.priority === value);
            break;
            
        case 'date':
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            switch (value) {
                case 'today':
                    filteredTasks = filteredTasks.filter(task => {
                        const taskDate = new Date(task.dueDate);
                        taskDate.setHours(0, 0, 0, 0);
                        return taskDate.getTime() === today.getTime();
                    });
                    break;
                case 'week':
                    const weekFromNow = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
                    filteredTasks = filteredTasks.filter(task => {
                        const taskDate = new Date(task.dueDate);
                        return taskDate >= today && taskDate <= weekFromNow;
                    });
                    break;
                case 'month':
                    const monthFromNow = new Date(today.getTime() + 30 * 24 * 60 * 60 * 1000);
                    filteredTasks = filteredTasks.filter(task => {
                        const taskDate = new Date(task.dueDate);
                        return taskDate >= today && taskDate <= monthFromNow;
                    });
                    break;
                case 'overdue':
                    filteredTasks = filteredTasks.filter(task => {
                        const taskDate = new Date(task.dueDate);
                        return !task.completed && taskDate < new Date();
                    });
                    break;
            }
            break;
            
        case 'category':
            filteredTasks = filteredTasks.filter(task => task.category === value);
            break;
            
        case 'status':
            switch (value) {
                case 'pending':
                    filteredTasks = filteredTasks.filter(task => !task.completed);
                    break;
                case 'completed':
                    filteredTasks = filteredTasks.filter(task => task.completed);
                    break;
                case 'in-progress':
                    // You can implement progress tracking later
                    filteredTasks = filteredTasks.filter(task => !task.completed);
                    break;
            }
            break;
    }

    // Render filtered tasks
    renderFilteredTasks(filteredTasks);
}

function renderFilteredTasks(filteredTasks) {
    // Use the existing renderTasks logic but with filtered tasks
    const originalTasks = [...tasks];
    tasks = filteredTasks;
    renderTasks();
    tasks = originalTasks;
}

            function updateDashboard() {
                if (!totalTasksValue || !completedTasksValue || !pendingTasksValue || !overdueTasksValue) return;
                
                const totalTasks = tasks.length;
                const completedTasks = tasks.filter(task => task.completed).length;
                const pendingTasks = tasks.filter(task => !task.completed).length;
                const overdueTasks = tasks.filter(task => {
                    const dueDate = new Date(task.dueDate);
                    return !task.completed && dueDate < new Date();
                }).length;
                
                totalTasksValue.textContent = totalTasks;
                completedTasksValue.textContent = completedTasks;
                pendingTasksValue.textContent = pendingTasks;
                overdueTasksValue.textContent = overdueTasks;

                // Re-add view more buttons after dashboard update
    setTimeout(() => {
        if (typeof addViewMoreButtons === 'function') {
            addViewMoreButtons();
        }
    }, 100);
}



            function updateCategoryCounts() {
                const categoryCounts = {
                    all: tasks.length,
                    work: tasks.filter(task => task.category === 'work').length,
                    personal: tasks.filter(task => task.category === 'personal').length,
                    shopping: tasks.filter(task => task.category === 'shopping').length,
                    health: tasks.filter(task => task.category === 'health').length,
                    finance: tasks.filter(task => task.category === 'finance').length,
                    education: tasks.filter(task => task.category === 'education').length
                };
                
                taskCountElements.forEach(el => {
                    const category = el.closest('.category')?.dataset.category;
                    if (category) {
                        el.textContent = categoryCounts[category] || 0;
                    }
                });
            }

            function initializeSearch() {
                if (!searchInput) return;

                const searchSuggestions = document.getElementById('searchSuggestions');
                const searchBlurOverlay = document.getElementById('searchBlurOverlay');
                let searchTimeout;

                searchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.trim().toLowerCase();
                    
                    clearTimeout(searchTimeout);
                    
                    if (searchTerm.length === 0) {
                        hideSuggestions();
                        renderTasks();
                        return;
                    }
                    
                    searchTimeout = setTimeout(() => {
                        const matchedTasks = tasks.filter(task => 
                            task.title.toLowerCase().includes(searchTerm) || 
                            (task.description && task.description.toLowerCase().includes(searchTerm))
                        );
                        
                        if (matchedTasks.length > 0) {
                            showSuggestions(matchedTasks, searchTerm);
                        } else {
                            hideSuggestions();
                        }
                    }, 200);
                });

                searchInput.addEventListener('focus', () => {
                    const searchTerm = searchInput.value.trim();
                    if (searchTerm.length > 0) {
                        const matchedTasks = tasks.filter(task => 
                            task.title.toLowerCase().includes(searchTerm.toLowerCase()) || 
                            (task.description && task.description.toLowerCase().includes(searchTerm.toLowerCase()))
                        );
                        if (matchedTasks.length > 0) {
                            showSuggestions(matchedTasks, searchTerm);
                        }
                    }
                });

                // Hide suggestions when clicking outside
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('.search-container')) {
                        hideSuggestions();
                    }
                });

                // Add this function after initializeSearch()
function initializeAdvancedFilter() {
    console.log('🔍 Initializing Advanced Filter...');
    
    const filterToggleBtn = document.getElementById('filterToggleBtn');
    const filterOptionsPanel = document.getElementById('filterOptionsPanel');
    const filterOptions = document.querySelectorAll('.filter-option');
    const filterItems = document.querySelectorAll('.filter-item');

    console.log('Filter elements found:', {
        filterToggleBtn: !!filterToggleBtn,
        filterOptionsPanel: !!filterOptionsPanel,
        filterOptionsCount: filterOptions.length,
        filterItemsCount: filterItems.length
    });

    if (!filterToggleBtn || !filterOptionsPanel) {
        console.error('❌ Filter elements not found!');
        return;
    }

    // Toggle filter panel
    filterToggleBtn.addEventListener('click', (e) => {
        console.log('🎯 Filter button clicked!');
        e.stopPropagation();
        toggleFilterPanel();
    });

    // Filter option handlers
    filterItems.forEach(item => {
        item.addEventListener('click', (e) => {
            console.log('📝 Filter item clicked:', item.dataset.value);
            e.stopPropagation();
            const filterType = item.closest('.filter-option').dataset.filter;
            const filterValue = item.dataset.value;
            
            applyAdvancedFilter(filterType, filterValue, item);
            closeFilterPanel();
        });
    });

    // Close panel when clicking outside
    document.addEventListener('click', (e) => {
        if (!e.target.closest('.search-container')) {
            closeFilterPanel();
        }
    });

    function toggleFilterPanel() {
        console.log('🔄 Toggling filter panel. Current state:', isFilterPanelOpen);
        if (isFilterPanelOpen) {
            closeFilterPanel();
        } else {
            openFilterPanel();
        }
    }

    function openFilterPanel() {
        console.log('🟢 Opening filter panel');
        isFilterPanelOpen = true;
        filterToggleBtn.classList.add('morphed');
        
        setTimeout(() => {
            filterOptionsPanel.classList.add('active');
            console.log('✅ Filter panel opened');
        }, 300);
    }

    function closeFilterPanel() {
        console.log('🔴 Closing filter panel');
        isFilterPanelOpen = false;
        filterOptionsPanel.classList.remove('active');
        
        setTimeout(() => {
            filterToggleBtn.classList.remove('morphed');
            console.log('✅ Filter panel closed');
        }, 200);
    }

    function applyAdvancedFilter(filterType, filterValue, clickedItem) {
        console.log('🎯 Applying filter:', filterType, filterValue);
        
        // Remove active from all items
        filterItems.forEach(item => item.classList.remove('active'));
        
        // Add active to clicked item
        clickedItem.classList.add('active');
        
        currentAdvancedFilter = { type: filterType, value: filterValue };
        
        // Apply filter and render
        renderTasksWithAdvancedFilter();
        
        // Show notification
        showNotification(`🔍 Filtered by ${filterType}: ${filterValue.replace('-', ' ')}`, 'info');
    }

    console.log('✅ Advanced Filter initialized successfully');
}

                function showSuggestions(matchedTasks, searchTerm) {
                    if (!searchSuggestions || !searchBlurOverlay) return;
                    
                    searchBlurOverlay.classList.add('active');
                    
                    searchSuggestions.innerHTML = '';
                    matchedTasks.slice(0, 5).forEach(task => {
                        const item = document.createElement('div');
                        item.className = 'search-suggestion-item';
                        item.innerHTML = `
                            <div style="font-weight: 600; color: var(--gray-800);">${highlightText(task.title, searchTerm)}</div>
                            ${task.description ? `<div style="font-size: 0.9rem; color: var(--gray-600);">${highlightText(task.description, searchTerm)}</div>` : ''}
                        `;
                        
                        item.addEventListener('click', () => {
                            // Filter tasks to show only this result
                            const originalTasks = [...tasks];
                            tasks = [task];
                            renderTasks();
                            tasks = originalTasks;
                            hideSuggestions();
                            searchInput.value = task.title;
                        });
                        
                        searchSuggestions.appendChild(item);
                    });
                    
                    searchSuggestions.classList.add('show');
                }

                function hideSuggestions() {
                    if (searchSuggestions && searchBlurOverlay) {
                        searchSuggestions.classList.remove('show');
                        searchBlurOverlay.classList.remove('active');
                    }
                }

                function highlightText(text, searchTerm) {
                    if (!searchTerm) return text;
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    return text.replace(regex, '<mark style="background: var(--highlight-light); color: var(--highlight-color);">$1</mark>');
                }
            }

            // Enhanced task form initialization for perfect container setup
function initializeTaskForm() {
    if (!taskForm) return;

    // Ensure proper container structure for wave animation
    const taskTitleInput = document.getElementById('taskTitle');
    if (taskTitleInput) {
        const inputGroup = taskTitleInput.closest('.input-group');
        const formGroup = taskTitleInput.closest('.form-group');
        
        // Ensure containers have proper styling for perfect fit
        if (inputGroup) {
            inputGroup.style.overflow = 'visible';
        }
        if (formGroup) {
            formGroup.style.overflow = 'visible';
            formGroup.style.position = 'relative';
        }
    }

    // Rest of your existing task form initialization...
    // Tab switching
    const taskFormTabs = document.querySelectorAll('.task-form-tab');
    const taskFormContents = document.querySelectorAll('.task-form-content');

    // Enhanced tab switching with smooth transitions
// Enhanced tab switching with smooth transitions
taskFormTabs.forEach(tab => {
    tab.addEventListener('click', () => {
        const targetTab = tab.dataset.tab;
        
        // Remove active from all tabs
        taskFormTabs.forEach(t => {
            t.classList.remove('active');
        });
        
        // Remove active from all contents
        taskFormContents.forEach(c => {
            c.classList.remove('active');
        });
        
        // Add active to clicked tab
        tab.classList.add('active');
        
        // Show corresponding content
        let targetContent = null;
        if (targetTab === 'details') {
            targetContent = document.getElementById('detailsTab');
        } else if (targetTab === 'reminders') {
            targetContent = document.getElementById('remindersTab');
        } else if (targetTab === 'addlater') {
            targetContent = document.getElementById('addlaterTab');
        }
        
        if (targetContent) {
            // Small delay for smooth transition
            setTimeout(() => {
                targetContent.classList.add('active');
            }, 50);
        }
    });
});

    // Reminder toggle
    const reminderToggle = document.getElementById('reminderToggle');
    const reminderSwitch = document.getElementById('reminderSwitch');
    const reminderOptions = document.getElementById('reminderOptions');

    if (reminderToggle && reminderSwitch && reminderOptions) {
        reminderToggle.addEventListener('click', () => {
            reminderSwitch.classList.toggle('active');
            const isActive = reminderSwitch.classList.contains('active');
            reminderOptions.style.display = isActive ? 'block' : 'none';
        });
    }

    // Reminder option selection
    const reminderOptionElements = document.querySelectorAll('.reminder-option');
    const customReminderInput = document.getElementById('customReminderInput');

    reminderOptionElements.forEach(option => {
        option.addEventListener('click', () => {
            reminderOptionElements.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
            
            const radio = option.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;
            
            // Show/hide custom input
            if (option.classList.contains('custom')) {
                customReminderInput.style.display = 'block';
            } else {
                customReminderInput.style.display = 'none';
            }
        });
    });

    // Category selection
    const categoryOptions = document.querySelectorAll('.category-option');
    categoryOptions.forEach(option => {
        option.addEventListener('click', () => {
            categoryOptions.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
            
            const radio = option.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;
        });
    });

    // Priority selection
    const priorityOptions = document.querySelectorAll('.priority-option');
    priorityOptions.forEach(option => {
        option.addEventListener('click', () => {
            priorityOptions.forEach(opt => opt.classList.remove('selected'));
            option.classList.add('selected');
            
            const radio = option.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;
        });
    });

    // Form submission
    taskForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        if (validateTaskForm()) {
            saveTask();
        }
    });

     // Add Later toggle
    const addLaterToggle = document.getElementById('addLaterToggle');
    const addLaterSwitch = document.getElementById('addLaterSwitch');
    const addLaterOptions = document.getElementById('addLaterOptions');
    const addLaterDate = document.getElementById('addLaterDate');
    const addLaterTime = document.getElementById('addLaterTime');
    const addLaterPreview = document.getElementById('addLaterPreview');
    const addLaterPreviewText = document.getElementById('addLaterPreviewText');

    if (addLaterToggle && addLaterSwitch && addLaterOptions) {
        addLaterToggle.addEventListener('click', () => {
            addLaterSwitch.classList.toggle('active');
            const isActive = addLaterSwitch.classList.contains('active');
            addLaterOptions.style.display = isActive ? 'block' : 'none';
            
            if (isActive) {
                // Set default date to tomorrow
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                addLaterDate.value = tomorrow.toISOString().substr(0, 10);
                updateAddLaterPreview();
            }
        });
    }

    // Update preview when date/time changes
    [addLaterDate, addLaterTime].forEach(input => {
        if (input) {
            input.addEventListener('change', updateAddLaterPreview);
        }
    });

    function updateAddLaterPreview() {
        if (!addLaterDate || !addLaterTime || !addLaterPreview || !addLaterPreviewText) return;
        
        const date = addLaterDate.value;
        const time = addLaterTime.value;
        
        if (date && time) {
            const scheduledDate = new Date(`${date}T${time}`);
            const now = new Date();
            
            if (scheduledDate > now) {
                const timeDiff = scheduledDate.getTime() - now.getTime();
                const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                
                let timeText = '';
                if (days > 0) {
                    timeText = `in ${days} day${days > 1 ? 's' : ''} and ${hours} hour${hours > 1 ? 's' : ''}`;
                } else {
                    timeText = `in ${hours} hour${hours > 1 ? 's' : ''}`;
                }
                
                addLaterPreviewText.textContent = `Task will be added ${timeText} on ${scheduledDate.toLocaleDateString()} at ${scheduledDate.toLocaleTimeString()}`;
                addLaterPreview.style.display = 'block';
            } else {
                addLaterPreviewText.textContent = 'Please select a future date and time';
                addLaterPreview.style.display = 'block';
            }
        } else {
            addLaterPreview.style.display = 'none';
        }
    }
}


function initializeSmartSuggestions() {
    const container = document.getElementById('smartSuggestionsContainer');
    const content = document.getElementById('smartSuggestionsContent');
    const status = document.getElementById('suggestionsStatus');
    
    if (!container || !content) return;
    
    // Animate container appearance from center
    setTimeout(() => {
        container.classList.add('animate-from-center');
        
        setTimeout(() => {
            analyzeUserPatterns();
            generateSmartSuggestions();
        }, 800);
    }, 1000);
    
    // Pre-defined task templates
    const taskTemplates = {
        work: [
            { title: "Daily standup meeting", description: "Team sync and progress update", priority: "medium", time: "09:00" },
            { title: "Code review", description: "Review pending pull requests", priority: "high", time: "14:00" },
            { title: "Project planning", description: "Plan next sprint tasks", priority: "medium", time: "16:00" }
        ],
        personal: [
            { title: "Morning workout", description: "30-minute exercise routine", priority: "medium", time: "07:00" },
            { title: "Read book", description: "Read for 30 minutes", priority: "low", time: "21:00" },
            { title: "Call family", description: "Weekly family check-in", priority: "medium", time: "19:00" }
        ],
        health: [
            { title: "Doctor appointment", description: "Annual health checkup", priority: "high", time: "10:00" },
            { title: "Take vitamins", description: "Daily vitamin supplements", priority: "low", time: "08:00" },
            { title: "Drink water reminder", description: "Stay hydrated throughout the day", priority: "low", time: "12:00" }
        ],
        shopping: [
            { title: "Grocery shopping", description: "Weekly grocery run", priority: "medium", time: "18:00" },
            { title: "Buy household items", description: "Cleaning supplies and essentials", priority: "low", time: "15:00" },
            { title: "Online shopping", description: "Check and order needed items", priority: "low", time: "20:00" }
        ],
        finance: [
            { title: "Pay monthly bills", description: "Electricity, internet, rent", priority: "high", time: "09:00" },
            { title: "Review expenses", description: "Check monthly spending", priority: "medium", time: "17:00" },
            { title: "Update budget", description: "Adjust monthly budget plan", priority: "medium", time: "18:00" }
        ],
        education: [
            { title: "Online course", description: "Continue learning new skills", priority: "medium", time: "20:00" },
            { title: "Practice coding", description: "Daily coding practice", priority: "high", time: "19:00" },
            { title: "Read articles", description: "Stay updated with industry news", priority: "low", time: "22:00" }
        ]
    };

    function analyzeUserPatterns() {
        status.textContent = "Analyzing your task patterns...";
        
        // Analyze user's task creation patterns
        const categoryCount = {};
        const dayPatterns = {};
        
        tasks.forEach(task => {
            // Count categories
            categoryCount[task.category] = (categoryCount[task.category] || 0) + 1;
            
            // Analyze creation days
            const day = new Date(task.createdAt).getDay();
            dayPatterns[day] = (dayPatterns[day] || 0) + 1;
        });
        
        suggestionPatterns = {
            favoriteCategories: Object.keys(categoryCount).sort((a, b) => categoryCount[b] - categoryCount[a]),
            totalTasks: tasks.length,
            categoryCount,
            dayPatterns
        };
        
        console.log('User patterns analyzed:', suggestionPatterns);
    }

    function generateSmartSuggestions() {
        setTimeout(() => {
            status.textContent = "Generating smart suggestions...";
            
            smartSuggestions = [];
            
            if (tasks.length === 0) {
                // New user - suggest popular tasks
                smartSuggestions = [
                    { ...taskTemplates.work[0], category: 'work', frequency: 'Daily' },
                    { ...taskTemplates.personal[0], category: 'personal', frequency: 'Daily' },
                    { ...taskTemplates.health[1], category: 'health', frequency: 'Daily' }
                ];
            } else {
                // Generate based on patterns
                const topCategories = suggestionPatterns.favoriteCategories.slice(0, 3);
                
                topCategories.forEach(category => {
                    if (taskTemplates[category]) {
                        const template = taskTemplates[category][Math.floor(Math.random() * taskTemplates[category].length)];
                        smartSuggestions.push({
                            ...template,
                            category,
                            frequency: suggestionPatterns.categoryCount[category] > 3 ? 'Frequent' : 'Suggested'
                        });
                    }
                });
                
                // Fill remaining slots if needed
                while (smartSuggestions.length < 3) {
                    const randomCategory = Object.keys(taskTemplates)[Math.floor(Math.random() * Object.keys(taskTemplates).length)];
                    const template = taskTemplates[randomCategory][Math.floor(Math.random() * taskTemplates[randomCategory].length)];
                    
                    if (!smartSuggestions.find(s => s.title === template.title)) {
                        smartSuggestions.push({
                            ...template,
                            category: randomCategory,
                            frequency: 'Suggested'
                        });
                    }
                }
            }
            
            renderSmartSuggestions();
        }, 1000);
    }

    function renderSmartSuggestions() {
        setTimeout(() => {
            if (smartSuggestions.length === 0) {
                status.textContent = "No suggestions available";
                content.innerHTML = `
                    <div class="no-suggestions">
                        <i class="fas fa-robot"></i>
                        <p>No suggestions yet</p>
                        <span>Keep using the app to get personalized suggestions!</span>
                    </div>
                `;
            } else {
                status.textContent = `${smartSuggestions.length} suggestions found`;
                
                content.innerHTML = smartSuggestions.map((suggestion, index) => `
                    <div class="suggestion-item" data-index="${index}">
                        <div class="suggestion-header">
                            <div class="suggestion-title">${suggestion.title}</div>
                            <button class="suggestion-menu-btn" data-index="${index}">
                                <i class="fas fa-ellipsis-v"></i>
                            </button>
                        </div>
                        <div class="suggestion-meta">
                            <div class="suggestion-category">${suggestion.category}</div>
                            <div class="suggestion-frequency">${suggestion.frequency}</div>
                        </div>
                        <div class="suggestion-description">${suggestion.description}</div>
                        
                        <div class="suggestion-menu" id="suggestionMenu${index}">
                            <div class="suggestion-menu-item add" data-action="add" data-index="${index}">
                                <i class="fas fa-plus"></i> Add Task
                            </div>
                            <div class="suggestion-menu-item modify" data-action="modify" data-index="${index}">
                                <i class="fas fa-edit"></i> Modify
                            </div>
                            <div class="suggestion-menu-item forget" data-action="forget" data-index="${index}">
                                <i class="fas fa-times"></i> Forget
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Add event listeners
                addSuggestionEventListeners();
            }
        }, 500);
    }

    function addSuggestionEventListeners() {
        // Menu button clicks
        document.querySelectorAll('.suggestion-menu-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const index = btn.dataset.index;
                const menu = document.getElementById(`suggestionMenu${index}`);
                
                // Close all other menus
                document.querySelectorAll('.suggestion-menu').forEach(m => {
                    if (m !== menu) m.classList.remove('active');
                });
                
                menu.classList.toggle('active');
            });
        });

        // Menu item clicks
        document.querySelectorAll('.suggestion-menu-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.stopPropagation();
                const action = item.dataset.action;
                const index = parseInt(item.dataset.index);
                
                handleSuggestionAction(action, index);
            });
        });

        // Close menus when clicking outside
        document.addEventListener('click', () => {
            document.querySelectorAll('.suggestion-menu').forEach(menu => {
                menu.classList.remove('active');
            });
        });
    }

    function handleSuggestionAction(action, index) {
        const suggestion = smartSuggestions[index];
        
        switch (action) {
            case 'add':
                addSuggestedTask(suggestion);
                break;
            case 'modify':
                modifySuggestedTask(suggestion);
                break;
            case 'forget':
                forgetSuggestion(index);
                break;
        }
        
        // Close menu
        document.getElementById(`suggestionMenu${index}`).classList.remove('active');
    }

    function addSuggestedTask(suggestion) {
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const [hours, minutes] = suggestion.time.split(':');
        tomorrow.setHours(parseInt(hours), parseInt(minutes));
        
        const newTask = {
            id: generateId(),
            title: suggestion.title,
            description: suggestion.description,
            category: suggestion.category,
            priority: suggestion.priority,
            dueDate: tomorrow.toISOString(),
            completed: false,
            createdAt: new Date().toISOString(),
            modifiedAt: new Date().toISOString()
        };
        
        tasks.push(newTask);
        saveTasks();
        renderTasks();
        updateDashboard();
        updateCategoryCounts();
        
        showNotification(`✅ Added "${suggestion.title}" to your tasks!`, 'success');
    }

    function modifySuggestedTask(suggestion) {
        // Pre-fill modal with suggestion data
        openAddTaskModal();
        
        setTimeout(() => {
            document.getElementById('taskTitle').value = suggestion.title;
            document.getElementById('taskDescription').value = suggestion.description;
            
            // Set category
            const categoryInput = document.getElementById(`category${suggestion.category.charAt(0).toUpperCase() + suggestion.category.slice(1)}`);
            if (categoryInput) {
                categoryInput.checked = true;
                document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
                const categoryOption = document.querySelector(`.category-option.${suggestion.category}`);
                if (categoryOption) categoryOption.classList.add('selected');
            }
            
            // Set priority
            const priorityInput = document.getElementById(`priority${suggestion.priority.charAt(0).toUpperCase() + suggestion.priority.slice(1)}`);
            if (priorityInput) {
                priorityInput.checked = true;
                document.querySelectorAll('.priority-option').forEach(opt => opt.classList.remove('selected'));
                const priorityOption = document.querySelector(`.priority-option.${suggestion.priority}`);
                if (priorityOption) priorityOption.classList.add('selected');
            }
        }, 100);
    }

    function forgetSuggestion(index) {
        const suggestionItem = document.querySelector(`.suggestion-item[data-index="${index}"]`);
        
        suggestionItem.classList.add('fading-out');
        
        setTimeout(() => {
            smartSuggestions.splice(index, 1);
            renderSmartSuggestions();
            showNotification('💭 Suggestion removed', 'info');
        }, 600);
    }
}

            function validateTaskForm() {
                let isValid = true;
                
                // Clear previous errors
                document.querySelectorAll('.form-error').forEach(error => {
                    error.style.display = 'none';
                });
                
                // Validate title
                const titleInput = document.getElementById('taskTitle');
                if (!titleInput || !titleInput.value.trim()) {
                    const titleError = document.getElementById('taskTitleError');
                    if (titleError) {
                        titleError.style.display = 'block';
                        titleError.textContent = 'Please enter a task title';
                    }
                    isValid = false;
                }
                
                // Validate category
                const categorySelected = document.querySelector('input[name="taskCategory"]:checked');
                if (!categorySelected) {
                    const categoryError = document.getElementById('taskCategoryError');
                    if (categoryError) {
                        categoryError.style.display = 'block';
                        categoryError.textContent = 'Please select a category';
                    }
                    isValid = false;
                }
                
                // Validate priority
                const prioritySelected = document.querySelector('input[name="taskPriority"]:checked');
                if (!prioritySelected) {
                    const priorityError = document.getElementById('taskPriorityError');
                    if (priorityError) {
                        priorityError.style.display = 'block';
                        priorityError.textContent = 'Please select a priority';
                    }
                    isValid = false;
                }
                
                // Validate due date
                const dueDateInput = document.getElementById('taskDueDate');
                if (!dueDateInput || !dueDateInput.value) {
                    const dueDateError = document.getElementById('taskDueDateError');
                    if (dueDateError) {
                        dueDateError.style.display = 'block';
                        dueDateError.textContent = 'Please select a due date';
                    }
                    isValid = false;
                }
                
                return isValid;
            }

            function saveTask() {
                const taskId = document.getElementById('taskId').value;
                const title = document.getElementById('taskTitle').value.trim();
                const description = document.getElementById('taskDescription').value.trim();
                const category = document.querySelector('input[name="taskCategory"]:checked')?.value;
                const priority = document.querySelector('input[name="taskPriority"]:checked')?.value;
                const dueDate = document.getElementById('taskDueDate').value;
                const dueTime = document.getElementById('taskDueTime').value || '09:00';
                
                // Validate required fields
                if (!title || !category || !priority || !dueDate) {
                    showNotification('Please fill in all required fields', 'error');
                    return;
                }
                
                const [hours, minutes] = dueTime.split(':');
                const dueDateObj = new Date(dueDate);
                dueDateObj.setHours(parseInt(hours), parseInt(minutes));

                // Check if add later is enabled
    const addLaterEnabled = document.getElementById('addLaterSwitch')?.classList.contains('active');
    const addLaterDate = document.getElementById('addLaterDate')?.value;
    const addLaterTime = document.getElementById('addLaterTime')?.value;

    if (addLaterEnabled && addLaterDate && addLaterTime) {
        const scheduledDate = new Date(`${addLaterDate}T${addLaterTime}`);
        const now = new Date();
        
        if (scheduledDate <= now) {
            showNotification('Please select a future date and time for Add Later', 'error');
            return;
        }

        // Get reminder data
        const reminderEnabled = document.getElementById('reminderSwitch')?.classList.contains('active');
        const reminderTime = document.querySelector('input[name="reminderTime"]:checked')?.value;
        const customMinutes = document.getElementById('customMinutes')?.value;

        let reminderMinutes = null;
        if (reminderEnabled && reminderTime) {
            if (reminderTime === 'custom' && customMinutes) {
                reminderMinutes = parseInt(customMinutes);
            } else if (reminderTime !== 'custom') {
                reminderMinutes = parseInt(reminderTime);
            }
        }
        
        // Create add later task instead of regular task
        const addLaterTaskData = {
            id: generateId(),
            scheduledFor: scheduledDate.toISOString(),
            createdAt: new Date().toISOString(),
            taskData: {
                title,
                description,
                category,
                priority,
                dueDate: dueDateObj.toISOString(),
                completed: false
            }
        };
        
        // Add reminder data if enabled
        if (reminderMinutes) {
            addLaterTaskData.taskData.reminder = {
                enabled: true,
                minutes: reminderMinutes,
                notified: false
            };
        }
        
        addLaterTasks.push(addLaterTaskData);
        saveAddLaterTasks();
        
        taskModal.classList.remove('active');
        taskForm.reset();
        document.querySelectorAll('.category-option, .priority-option').forEach(option => {
            option.classList.remove('selected');
        });
        
        showNotification(`⏰ Task scheduled to be added on ${scheduledDate.toLocaleDateString()} at ${scheduledDate.toLocaleTimeString()}`, 'success');
        startAddLaterMonitoring();
        return; // Exit early, don't create regular task
    }
                
                const taskData = {
                    title,
                    description,
                    category,
                    priority,
                    dueDate: dueDateObj.toISOString(),
                    completed: false,
                    createdAt: new Date().toISOString(),
                    modifiedAt: new Date().toISOString()
                };

                // Get reminder data
                const reminderEnabled = document.getElementById('reminderSwitch')?.classList.contains('active');
                const reminderTime = document.querySelector('input[name="reminderTime"]:checked')?.value;
                const customMinutes = document.getElementById('customMinutes')?.value;

                let reminderMinutes = null;
                if (reminderEnabled && reminderTime) {
                    if (reminderTime === 'custom' && customMinutes) {
                        reminderMinutes = parseInt(customMinutes);
                    } else if (reminderTime !== 'custom') {
                        reminderMinutes = parseInt(reminderTime);
                    }
                }

                // Add reminder data to taskData
if (reminderMinutes) {
    taskData.reminder = {
        enabled: true,
        minutes: reminderMinutes,
        notified: false
    };
}

let finalTask = null;

if (taskId) {
    // Editing existing task
    const taskIndex = tasks.findIndex(task => task.id === taskId);
    if (taskIndex !== -1) {
        taskData.id = taskId;
        taskData.createdAt = tasks[taskIndex].createdAt;
        taskData.completed = tasks[taskIndex].completed;
        taskData.completedAt = tasks[taskIndex].completedAt;
        
        tasks[taskIndex] = taskData;
        finalTask = tasks[taskIndex];
        showNotification('Task updated successfully!', 'success');
    }
} else {
    // Creating new task
    taskData.id = generateId();
    tasks.push(taskData);
    finalTask = taskData;
    showNotification('Task created successfully!', 'success');
}

saveTasks();

// Set reminder AFTER task is fully created with ID
if (finalTask && finalTask.reminder && finalTask.reminder.enabled) {
    setTaskReminder(finalTask);
}
                
                // Smooth modal close
                taskModal.classList.remove('active');
                
                // Reset form
                taskForm.reset();
                document.querySelectorAll('.category-option, .priority-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
            }

            // Category and Filter Initialization
            function initializeCategoryAndFilters() {
                // Category switching
                const categories = document.querySelectorAll('.category');
                categories.forEach(category => {
                    category.addEventListener('click', () => {
                        const categoryType = category.dataset.category;
                        if (categoryType === currentCategory) return;
                        
                        // Remove active from all categories
                        categories.forEach(cat => cat.classList.remove('active'));
                        
                        // Add active to clicked category
                        category.classList.add('active');
                        
                        // Update current category
                        currentCategory = categoryType;
                        
                        // Update category title and description
                        if (currentCategoryEl) {
                            currentCategoryEl.innerHTML = `${categoryIcons[categoryType]} ${categoryType.charAt(0).toUpperCase() + categoryType.slice(1)} Tasks`;
                        }
                        
                        if (categoryDescriptionEl) {
                            categoryDescriptionEl.textContent = categoryDescriptions[categoryType];
                        }
                        
                        // Render tasks
                        renderTasks();
                        
                        // Show/hide dashboard based on category
                        if (dashboard) {
                            if (categoryType === 'all') {
                                dashboard.classList.remove('hidden');
                                if (taskListWrapper) {
                                    taskListWrapper.classList.remove('expanded');
                                }
                            } else {
                                dashboard.classList.add('hidden');
                                if (taskListWrapper) {
                                    taskListWrapper.classList.add('expanded');
                                }
                            }
                        }
                    });
                });

                // Filter switching
                taskFilterBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const filter = btn.dataset.filter;
                        if (filter === currentFilter) return;
                        
                        // Remove active from all filter buttons
                        taskFilterBtns.forEach(filterBtn => {
                            filterBtn.classList.remove('active');
                        });
                        
                        // Add active to clicked filter
                        btn.classList.add('active');
                        
                        // Update current filter
                        currentFilter = filter;
                        
                        // Render tasks with new filter
                        renderTasks();
                    });
                });

                // Sort functionality
                const sortSelect = document.getElementById('sortSelect');
                if (sortSelect) {
                    sortSelect.addEventListener('change', (e) => {
                        const sortBy = e.target.value;
                        sortTasks(sortBy);
                        renderTasks();
                    });
                }
            }

            // Enhanced category highlighting with ripple effect
function enhanceCategoryHighlighting() {
    const sidebar = document.querySelector('.sidebar');
    const categories = document.querySelectorAll('.category');
    
    categories.forEach(category => {
        category.addEventListener('click', function(e) {
            // Remove active from all categories
            categories.forEach(cat => cat.classList.remove('active'));
            
            // Add active to clicked category
            this.classList.add('active');
            
            // Add full container highlighting class for fallback
            sidebar.classList.add('has-active-category');
            
            // Enhanced visual feedback
            this.style.transform = 'translateX(12px) scale(1.08)';
            setTimeout(() => {
                this.style.transform = '';
            }, 200);
            
        });
    });
}

            // Modal Initialization
            function initializeModals() {
                // Task Modal
                if (addTaskBtn) {
                    addTaskBtn.addEventListener('click', openAddTaskModal);
                }

                if (modalClose) {
                    modalClose.addEventListener('click', () => {
                        taskModal.classList.remove('active');
                    });
                }

                if (cancelTaskBtn) {
                    cancelTaskBtn.addEventListener('click', () => {
                        taskModal.classList.remove('active');
                    });
                }

                // Delete Modal
                if (deleteModalClose) {
                    deleteModalClose.addEventListener('click', () => {
                        deleteModal.classList.remove('active');
                    });
                }

                if (cancelDeleteBtn) {
                    cancelDeleteBtn.addEventListener('click', () => {
                        deleteModal.classList.remove('active');
                    });
                }

                if (confirmDeleteBtn) {
                    confirmDeleteBtn.addEventListener('click', () => {
                        if (taskToDelete) {
                            deleteTask(taskToDelete);
                            taskToDelete = null;
                        }
                        deleteModal.classList.remove('active');
                    });
                }

                // Close modals on outside click
                [taskModal, deleteModal, intelligentPrioModal].forEach(modal => {
                    if (modal) {
                        modal.addEventListener('click', (e) => {
                            if (e.target === modal) {
                                modal.classList.remove('active');
                            }
                        });
                    }
                });

                // Close modals on Escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        document.querySelectorAll('.modal.active').forEach(modal => {
                            modal.classList.remove('active');
                        });
                    }
                });
            }

            // Update showNotification to auto-dismiss without X button
            function showNotification(message, type = 'info') {
                if (!notificationContainer) return;

                const notification = document.createElement('div');
                notification.className = `notification ${type}`;

                const iconMap = {
                    success: 'fas fa-check-circle',
                    error: 'fas fa-exclamation-circle',
                    warning: 'fas fa-exclamation-triangle',
                    info: 'fas fa-info-circle'
                };

                notification.innerHTML = `
                    <i class="notification-icon ${iconMap[type] || iconMap.info}"></i>
                    <span>${message}</span>
                `;

                notificationContainer.appendChild(notification);

                // Show notification
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);

                // Auto-dismiss after 3 seconds
                setTimeout(() => {
                    dismissNotification(notification);
                }, 3000);
            }

            function dismissNotification(notification) {
                if (!notification || !notification.parentElement) return;
                
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 400);
            }

            // Keyboard Shortcuts
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + N: New task
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    openAddTaskModal();
                }
                
                // Ctrl/Cmd + F: Focus search
                if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                    e.preventDefault();
                    if (searchInput) {
                        searchInput.focus();
                    }
                }
            });

            function startAddLaterMonitoring() {
    // Clear existing interval
    if (addLaterCheckInterval) {
        clearInterval(addLaterCheckInterval);
    }
    
    // Check every 15 seconds instead of 60 seconds for faster response
    addLaterCheckInterval = setInterval(checkAddLaterTasks, 15000);
    
    // Check immediately when starting
    checkAddLaterTasks();
    
    // Check when user returns to the tab (handles when user was away)
    document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
            console.log('🔄 User returned - checking for missed Add Later tasks');
            checkAddLaterTasks();
        }
    });
    
    // Check when window gains focus (another way to catch when user returns)
    window.addEventListener('focus', () => {
        console.log('🔄 Window focused - checking for missed Add Later tasks');
        checkAddLaterTasks();
    });
}

  // UPDATE THE TO BE ADDED COUNTER - ADD THIS NEW FUNCTION
            function updateToBeAddedCounter() {
                const toBeAddedCard = document.getElementById('toBeAddedCard');
                const toBeAddedValue = document.getElementById('toBeAddedValue');
                
                if (!toBeAddedCard || !toBeAddedValue) return;
                
                const count = addLaterTasks.length;
                
                if (count > 0) {
                    toBeAddedValue.textContent = count;
                    if (toBeAddedCard.style.display === 'none') {
                        toBeAddedCard.style.display = 'block';
                        setTimeout(() => {
                            toBeAddedCard.classList.add('slide-in');
                        }, 100);
                    }
                } else {
                    if (toBeAddedCard.style.display !== 'none') {
                        toBeAddedCard.classList.add('slide-out');
                        setTimeout(() => {
                            toBeAddedCard.style.display = 'none';
                            toBeAddedCard.classList.remove('slide-in', 'slide-out');
                        }, 600);
                    }
                }
            }

            function checkAddLaterTasks() {
                const now = new Date();
                const tasksToAdd = [];
                
                addLaterTasks.forEach((addLaterTask, index) => {
                    const scheduledDate = new Date(addLaterTask.scheduledFor);
                    
                    if (now >= scheduledDate) {
                        tasksToAdd.push({ task: addLaterTask, index });
                    }
                });
                
                // Process tasks that need to be added
                tasksToAdd.forEach(({ task, index }) => {
                    addScheduledTask(task);
                    addLaterTasks.splice(index, 1);
                });
                
                if (tasksToAdd.length > 0) {
                    saveAddLaterTasks();
                    saveTasks();
                    renderTasks();
                    updateDashboard();
                    updateCategoryCounts();
                }
            }

            function addScheduledTask(addLaterTask) {
    const taskData = {
        ...addLaterTask.taskData,
        id: generateId(),
        createdAt: new Date().toISOString(),
        modifiedAt: new Date().toISOString(),
        addedAutomatically: true,
        originalScheduleTime: addLaterTask.scheduledFor
    };
    
    tasks.push(taskData);
    
    // Set reminder if enabled
    if (taskData.reminder && taskData.reminder.enabled) {
        setTaskReminder(taskData);
    }
    
    // Show notification
    showAddLaterNotification(taskData, addLaterTask);
    
    // Update counter after adding task
    updateToBeAddedCounter();
}

            function showAddLaterNotification(task, addLaterTask) {
                const banner = document.createElement('div');
                banner.className = 'add-later-notification';
                
                const scheduledTime = new Date(addLaterTask.scheduledFor);
                const now = new Date();
                const actualDelay = now.getTime() - scheduledTime.getTime();
                
                let delayText = '';
                if (actualDelay > 60000) { // More than 1 minute late
                    const delayMinutes = Math.floor(actualDelay / 60000);
                    const delayHours = Math.floor(delayMinutes / 60);
                    const delayDays = Math.floor(delayHours / 24);
                    
                    if (delayDays > 0) {
                        delayText = `(${delayDays} day${delayDays > 1 ? 's' : ''} late)`;
                    } else if (delayHours > 0) {
                        delayText = `(${delayHours} hour${delayHours > 1 ? 's' : ''} late)`;
                    } else {
                        delayText = `(${delayMinutes} minute${delayMinutes > 1 ? 's' : ''} late)`;
                    }
                }
                
                banner.innerHTML = `
                    <div class="add-later-notification-content">
                        <div class="add-later-notification-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="add-later-notification-text">
                            <div class="add-later-notification-title">📋 Scheduled Task Added!</div>
                            <div class="add-later-notification-message">${task.title}</div>
                            <div class="add-later-notification-details">
                                Scheduled: ${scheduledTime.toLocaleDateString()} at ${scheduledTime.toLocaleTimeString()}<br>
                                Added: ${now.toLocaleDateString()} at ${now.toLocaleTimeString()} ${delayText}
                            </div>
                        </div>
                    </div>
                    <button class="add-later-notification-close" aria-label="Dismiss notification">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.body.appendChild(banner);
                
                // Show with animation
                setTimeout(() => {
                    banner.classList.add('show');
                }, 100);
                
                // Close button handler
                const closeBtn = banner.querySelector('.add-later-notification-close');
                closeBtn.addEventListener('click', () => {
                    dismissAddLaterBanner(banner);
                });
                
                // Auto-dismiss after 10 seconds
                setTimeout(() => {
                    dismissAddLaterBanner(banner);
                }, 10000);
                
                // Show regular notification too
                showNotification(`⏰ "${task.title}" was automatically added to your tasks!`, 'success');
            }

            function dismissAddLaterBanner(banner) {
                if (!banner || !banner.parentElement) return;
                
                banner.classList.remove('show');
                setTimeout(() => {
                    if (banner.parentElement) {
                        banner.remove();
                    }
                }, 600);
            }

            function initializeAddLater() {
    startAddLaterMonitoring();
    
    // Check immediately when app loads for any missed tasks
    console.log('🚀 App loaded - checking for missed Add Later tasks');
    checkAddLaterTasks();
    
    // Update the counter on app load
    updateToBeAddedCounter();
    
    // Also check after a short delay in case of timing issues
    setTimeout(() => {
        checkAddLaterTasks();
    }, 2000);
}

function openScheduledTaskModal() {
    console.log('🔍 Opening scheduled tasks modal...');
    
    const modal = document.getElementById('scheduledTasksModal');
    const tasksList = document.getElementById('scheduledTasksList');
    
    if (!modal || !tasksList) {
        console.error('❌ Modal elements not found');
        return;
    }
    
    // Clear existing content
    tasksList.innerHTML = '';
    
    if (!addLaterTasks || addLaterTasks.length === 0) {
        tasksList.innerHTML = `
            <div class="no-scheduled-tasks">
                <i class="fas fa-calendar-check"></i>
                <h3>No Tasks Scheduled</h3>
                <p>All your "Add Later" tasks will appear here when scheduled.</p>
            </div>
        `;
    } else {
        // Group tasks by date
        const groupedTasks = groupTasksByDate(addLaterTasks);
        
        Object.keys(groupedTasks)
            .sort((a, b) => new Date(a) - new Date(b))
            .forEach(dateKey => {
                const dateGroup = document.createElement('div');
                dateGroup.className = 'scheduled-date-group';
                
                const dateHeader = document.createElement('div');
                dateHeader.className = 'scheduled-date-header';
                dateHeader.innerHTML = `
                    <h3>${formatDateGroup(dateKey)}</h3>
                    <span class="task-count">${groupedTasks[dateKey].length} task${groupedTasks[dateKey].length !== 1 ? 's' : ''}</span>
                `;
                
                dateGroup.appendChild(dateHeader);
                
                const tasksContainer = document.createElement('div');
                tasksContainer.className = 'scheduled-tasks-container';
                
                groupedTasks[dateKey].forEach((task, index) => {
                    const taskElement = createScheduledTaskElement(task, index);
                    tasksContainer.appendChild(taskElement);
                });
                
                dateGroup.appendChild(tasksContainer);
                tasksList.appendChild(dateGroup);
            });
    }
    
    // Show modal
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
    
    console.log('✅ Scheduled tasks modal opened');
}

// Helper functions
function groupTasksByDate(tasks) {
    const grouped = {};
    
    tasks.forEach(task => {
        const scheduledDate = new Date(task.scheduledFor);
        const dateKey = scheduledDate.toDateString();
        
        if (!grouped[dateKey]) {
            grouped[dateKey] = [];
        }
        
        grouped[dateKey].push(task);
    });
    
    return grouped;
}

function formatDateGroup(dateKey) {
    const date = new Date(dateKey);
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    
    const isToday = date.toDateString() === today.toDateString();
    const isTomorrow = date.toDateString() === tomorrow.toDateString();
    
    if (isToday) {
        return 'Today';
    } else if (isTomorrow) {
        return 'Tomorrow';
    } else {
        return date.toLocaleDateString('en-US', {
            weekday: 'long',
            month: 'long',
            day: 'numeric',
            year: date.getFullYear() !== today.getFullYear() ? 'numeric' : undefined
        });
    }
}

function initializeAnalytics() {
    console.log('🔍 Initializing Analytics...');
    
    // Wait for DOM to be fully ready
    setTimeout(() => {
        analyticsModal = document.getElementById('analyticsFullscreenModal');
        const analyticsCloseBtn = document.getElementById('analyticsCloseBtn');
        
        if (!analyticsModal) {
            console.error('❌ Analytics modal not found!');
            return;
        }
        
        console.log('✅ Analytics modal found');
        
        // Add view more buttons
        addViewMoreButtons();
        
        // Close button handler
        if (analyticsCloseBtn) {
            analyticsCloseBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                closeAnalyticsModal();
            });
            console.log('✅ Close button handler added');
        }
        
        // ESC key handler
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && analyticsModal && analyticsModal.classList.contains('show')) {
                e.preventDefault();
                closeAnalyticsModal();
            }
        });
        
        console.log('✅ Analytics initialization complete');
    }, 100);
}

function addViewMoreButtons() {
    const statCards = document.querySelectorAll('.stat-card:not(.to-be-added-card)');
    console.log('Found stat cards:', statCards.length);
    
    statCards.forEach((card, index) => {
        // Remove existing button first
        const existingBtn = card.querySelector('.view-more-btn');
        if (existingBtn) {
            existingBtn.remove();
        }
        
        const viewMoreBtn = document.createElement('button');
        viewMoreBtn.className = 'view-more-btn';
        viewMoreBtn.innerHTML = '<i class="fas fa-chart-line"></i> View More';
        viewMoreBtn.setAttribute('aria-label', 'View detailed analytics');
        
        const statTypes = ['total', 'completed', 'pending', 'overdue'];
        const statType = statTypes[index] || 'total';
        
        // Add click handler with proper event handling
        viewMoreBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            
            console.log('🚀 View More clicked for type:', statType);
            
            // Immediately open the modal
            openAnalyticsModal(statType);
        });
        
        card.appendChild(viewMoreBtn);
        console.log('✅ Button added to card', index, 'type:', statType);
    });
}

function openAnalyticsModal(type) {
    console.log('🚀 Opening analytics modal for type:', type);
    
    if (!analyticsModal) {
        console.error('❌ Analytics modal not available');
        analyticsModal = document.getElementById('analyticsFullscreenModal');
        if (!analyticsModal) {
            console.error('❌ Still cannot find analytics modal');
            return;
        }
    }
    
    // Prevent any other modals from interfering
    const taskModal = document.getElementById('taskModal');
    if (taskModal && taskModal.classList.contains('active')) {
        taskModal.classList.remove('active');
    }
    
    currentAnalyticsType = type;
    
    // Update modal title
    const modalTitle = document.getElementById('analyticsModalTitle');
    const titles = {
        total: '<i class="fas fa-tasks"></i> Total Tasks Analytics',
        completed: '<i class="fas fa-check-circle"></i> Completed Tasks Analytics',
        pending: '<i class="fas fa-clock"></i> Pending Tasks Analytics',
        overdue: '<i class="fas fa-exclamation-circle"></i> Overdue Tasks Analytics'
    };
    
    if (modalTitle) {
        modalTitle.innerHTML = titles[type] || titles.total;
    }
    
    // Show modal immediately with slide animation
    analyticsModal.classList.add('show');
    document.body.style.overflow = 'hidden';
    
    console.log('✅ Modal shown with class:', analyticsModal.className);
    
    // Setup chart controls after modal is visible
    setTimeout(() => {
        const chartBtns = document.querySelectorAll('.chart-control-btn');
        chartBtns.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('.chart-control-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                updateTrendsChart(e.target.dataset.period);
            });
        });
    }, 100);
    
    // Populate data after animation
    setTimeout(() => {
        populateRealtimeStats(type);
        populateProgressRings(type);
        populateCharts(type);
        console.log('✅ Data populated');
    }, 300);
}

function closeAnalyticsModal() {
    console.log('🔴 Closing analytics modal');
    
    if (!analyticsModal) return;
    
    analyticsModal.classList.remove('show');
    document.body.style.overflow = '';
    currentAnalyticsType = null;
    
    console.log('✅ Modal closed');
}

function populateRealtimeStats(type) {
    const container = document.getElementById('realtimeStatsGrid');
    if (!container) return;
    
    const stats = calculateDetailedStats(type);
    
    container.innerHTML = stats.map(stat => `
        <div class="realtime-stat-card">
            <div class="realtime-stat-header">
                <div class="realtime-stat-title">${stat.title}</div>
                <div class="realtime-stat-icon">
                    <i class="${stat.icon}"></i>
                </div>
            </div>
            <div class="realtime-stat-value">${stat.value}</div>
            <div class="realtime-stat-details">
                <span>${stat.description}</span>
                <span class="stat-change ${stat.trend}">${stat.change}</span>
            </div>
        </div>
    `).join('');
}

function populateProgressRings(type) {
    const container = document.getElementById('progressRingContainer');
    if (!container) return;
    
    const ringData = calculateProgressRings(type);
    
    container.innerHTML = ringData.map(ring => `
        <div class="progress-ring">
            <svg>
                <circle class="progress-ring-bg"></circle>
                <circle class="progress-ring-fill" style="--progress-offset: ${314 - (314 * ring.percentage / 100)}"></circle>
            </svg>
            <div class="progress-ring-text">
                <span class="progress-ring-value">${ring.percentage}%</span>
                <span class="progress-ring-label">${ring.label}</span>
            </div>
        </div>
    `).join('');
}

function calculateDetailedStats(type) {
    const now = new Date();
    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
    const thisWeek = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
    
    let filteredTasks = tasks;
    
    // Filter based on type
    switch (type) {
        case 'completed':
            filteredTasks = tasks.filter(task => task.completed);
            break;
        case 'pending':
            filteredTasks = tasks.filter(task => !task.completed);
            break;
        case 'overdue':
            filteredTasks = tasks.filter(task => {
                const dueDate = new Date(task.dueDate);
                return !task.completed && dueDate < now;
            });
            break;
    }
    
    const todayTasks = filteredTasks.filter(task => {
        const taskDate = new Date(task.dueDate);
        return taskDate >= today && taskDate < new Date(today.getTime() + 24 * 60 * 60 * 1000);
    });
    
    const thisWeekTasks = filteredTasks.filter(task => {
        const taskDate = new Date(task.dueDate);
        return taskDate >= thisWeek && taskDate <= now;
    });
    
    const highPriorityTasks = filteredTasks.filter(task => task.priority === 'high');
    const averageCompletionTime = calculateAverageCompletionTime(filteredTasks);
    
    return [
        {
            title: 'Total Count',
            value: filteredTasks.length,
            description: 'Total tasks in this category',
            icon: 'fas fa-hashtag',
            trend: 'positive',
            change: '+12%'
        },
        {
            title: 'Due Today',
            value: todayTasks.length,
            description: 'Tasks due today',
            icon: 'fas fa-calendar-day',
            trend: todayTasks.length > 3 ? 'negative' : 'positive',
            change: todayTasks.length > 3 ? 'High load' : 'Manageable'
        },
        {
            title: 'This Week',
            value: thisWeekTasks.length,
            description: 'Tasks this week',
            icon: 'fas fa-calendar-week',
            trend: 'positive',
            change: '+8%'
        },
        {
            title: 'High Priority',
            value: highPriorityTasks.length,
            description: 'High priority tasks',
            icon: 'fas fa-exclamation-triangle',
            trend: highPriorityTasks.length > 2 ? 'negative' : 'positive',
            change: highPriorityTasks.length > 2 ? 'Attention needed' : 'Under control'
        }
    ];
}

function calculateProgressRings(type) {
    const totalTasks = tasks.length;
    const completedTasks = tasks.filter(task => task.completed).length;
    const pendingTasks = tasks.filter(task => !task.completed).length;
    const overdueTasks = tasks.filter(task => {
        const dueDate = new Date(task.dueDate);
        return !task.completed && dueDate < new Date();
    }).length;
    
    return [
        {
            percentage: totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0,
            label: 'Completion Rate'
        },
        {
            percentage: totalTasks > 0 ? Math.round((pendingTasks / totalTasks) * 100) : 0,
            label: 'Pending Rate'
        },
        {
            percentage: totalTasks > 0 ? Math.round(((totalTasks - overdueTasks) / totalTasks) * 100) : 100,
            label: 'On-Time Rate'
        }
    ];
}

function calculateAverageCompletionTime(tasks) {
    const completedTasks = tasks.filter(task => task.completed && task.completedAt);
    
    if (completedTasks.length === 0) return 0;
    
    const totalTime = completedTasks.reduce((sum, task) => {
        const created = new Date(task.createdAt);
        const completed = new Date(task.completedAt);
        return sum + (completed - created);
    }, 0);
    
    return Math.round(totalTime / completedTasks.length / (1000 * 60 * 60 * 24)); // Convert to days
}

function populateCharts(type) {
    updateTrendsChart('week');
    updateCategoryChart();
    initializeTrendsChartTabs(); // Add this new function
}

     function initializeCategoryChartTabs() {
        const tabButtons = document.querySelectorAll('.category-tab-btn');
        
        tabButtons.forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Remove active class from all tabs
                tabButtons.forEach(tab => tab.classList.remove('active'));
                
                // Add active class to clicked tab
                e.target.classList.add('active');
                
                // Get chart type
                const chartType = e.target.dataset.chartType;
                
                // Switch chart views
                switchCategoryChart(chartType);
            });
        });
    }

    function switchCategoryChart(type) {
        const barChart = document.getElementById('categoryBarChart');
        const animatedChart = document.getElementById('categoryAnimatedChart');
        
        if (!barChart || !animatedChart) return;
        
        // Remove active class from all views
        document.querySelectorAll('.category-chart-view').forEach(view => {
            view.classList.remove('active');
        });
        
        // Activate the selected view
        if (type === 'bar') {
            barChart.classList.add('active');
            updateBarChart();
        } else if (type === 'animated') {
            animatedChart.classList.add('active');
            updateAnimatedChart();
        }
    }

    function updateCategoryCharts() {
        // Update both chart types
        updateBarChart();
        updateAnimatedChart();
    }

    function updateBarChart() {
    const chartContainer = document.getElementById('categoryBarChart');
    if (!chartContainer) return;
    
    const categories = ['work', 'personal', 'shopping', 'health', 'finance', 'education'];
    const categoryData = categories.map(cat => ({
        name: cat,
        count: tasks.filter(task => task.category === cat).length,
        color: categoryColors[cat] || categoryColors.work
    }));
    
    const maxCount = Math.max(...categoryData.map(d => d.count), 1);
    
    chartContainer.innerHTML = `
        <!-- Legend -->
        <div class="category-legend">
            ${categoryData.map(cat => `
                <div class="legend-item">
                    <div class="legend-color" style="background: ${cat.color.bg};"></div>
                    <span>${cat.color.icon} ${cat.name}</span>
                    <span style="font-weight: 600;">(${cat.count})</span>
                </div>
            `).join('')}
        </div>
        
        <!-- Fixed Bar Chart -->
        <div class="bar-chart-container">
            ${categoryData.map((cat, i) => `
                <div class="bar-chart-row">
                    <div class="bar-label">
                        <i class="${cat.color.icon.replace('<i class="', '').replace('"></i>', '')}" 
                           style="background: ${cat.color.bg};"></i>
                        ${cat.name}
                    </div>
                    <div class="bar-container">
                        <div class="bar-fill" 
                             style="background: ${cat.color.gradient}; 
                                    width: ${maxCount > 0 ? (cat.count / maxCount) * 100 : 0}%;
                                    animation: barGrowHorizontal 1s ease-out ${i * 0.1}s both;">
                            <span class="bar-count">${cat.count}</span>
                            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; 
                                       background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                                       animation: barShimmer 2s infinite ${i * 0.3}s;"></div>
                        </div>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

function updateAnimatedChart() {
    const chartContainer = document.getElementById('categoryAnimatedChart');
    if (!chartContainer) return;
    
    const categories = ['work', 'personal', 'shopping', 'health', 'finance', 'education'];
    const categoryData = categories.map(cat => ({
        name: cat,
        count: tasks.filter(task => task.category === cat).length,
        color: categoryColors[cat] || categoryColors.work
    }));
    
    const maxCount = Math.max(...categoryData.map(d => d.count), 1);
    const totalTasks = categoryData.reduce((sum, cat) => sum + cat.count, 0);
    
    // Professional Y-axis values
    const yAxisValues = [0, Math.round(maxCount * 0.25), Math.round(maxCount * 0.5), Math.round(maxCount * 0.75), maxCount];
    
    chartContainer.innerHTML = `
        <div class="line-chart-container">
            <!-- Professional Left Panel -->
            <div class="category-filters-panel">
                <div class="filters-panel-title">
                    <i class="fas fa-layer-group"></i>
                    Data Categories
                </div>
                
                <button class="category-filter-btn all-data active" data-category="all">
                    <div class="filter-btn-left">
                        <div class="filter-btn-icon" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);">
                            <i class="fas fa-chart-area"></i>
                        </div>
                        <span>All Categories</span>
                    </div>
                    <div class="filter-btn-count">${totalTasks}</div>
                </button>
                
                ${categoryData.map(cat => `
                    <button class="category-filter-btn" 
                            data-category="${cat.name}"
                            style="border-color: ${cat.color.bg}20;">
                        <div class="filter-btn-left">
                            <div class="filter-btn-icon" style="background: ${cat.color.bg}; border-color: ${cat.color.bg}40;">
                                ${cat.color.icon}
                            </div>
                            <span>${cat.name}</span>
                        </div>
                        <div class="filter-btn-count" style="background: ${cat.color.bg}15; color: ${cat.color.bg}; border-color: ${cat.color.bg}20;">
                            ${cat.count}
                        </div>
                    </button>
                `).join('')}
            </div>
            
            <!-- Professional Right Panel -->
            <div class="chart-panel">
                <div class="chart-header">
                    <div class="chart-title">Task Distribution Analytics</div>
                </div>
                
                <!-- Y-axis labels -->
                <div class="y-axis-labels">
                    ${yAxisValues.reverse().map(val => `<span>${val}</span>`).join('')}
                </div>
                
                <svg class="chart-svg" viewBox="0 0 100 100" preserveAspectRatio="none">
                    <!-- Professional Grid -->
                    ${[20, 40, 60, 80].map(y => 
                        `<line class="chart-grid" x1="0" y1="${y}" x2="100" y2="${y}"/>`
                    ).join('')}
                    ${categoryData.map((cat, i) => 
                        `<line class="chart-grid" x1="${(i / (categoryData.length - 1)) * 100}" y1="0" x2="${(i / (categoryData.length - 1)) * 100}" y2="100"/>`
                    ).join('')}
                    
                    <!-- Subtle area fills -->
                    ${categoryData.map((cat, i) => {
                        const points = categoryData.map((c, idx) => ({
                            x: (idx / (categoryData.length - 1)) * 100,
                            y: maxCount > 0 ? ((maxCount - c.count) / maxCount) * 70 + 15 : 50
                        }));
                        
                        const areaPath = `M 0 85 ${points.map(p => `L ${p.x} ${p.y}`).join(' ')} L 100 85 Z`;
                        
                        return `
                            <path class="chart-area category-area" 
                                  data-category="${cat.name}"
                                  d="${areaPath}" 
                                  fill="url(#areaGradient${i})"
                                  style="animation: fillArea 1.8s ease-out ${i * 0.15}s both;"/>
                        `;
                    }).join('')}
                    
                    <!-- Professional lines -->
                    ${categoryData.map((cat, i) => {
                        const points = categoryData.map((c, idx) => ({
                            x: (idx / (categoryData.length - 1)) * 100,
                            y: maxCount > 0 ? ((maxCount - c.count) / maxCount) * 70 + 15 : 50
                        }));
                        
                        const linePath = points.map((point, idx) => 
                            `${idx === 0 ? 'M' : 'L'} ${point.x} ${point.y}`
                        ).join(' ');
                        
                        return `
                            <path class="chart-line category-line" 
                                  data-category="${cat.name}"
                                  d="${linePath}" 
                                  stroke="${cat.color.bg}"
                                  stroke-dasharray="800"
                                  stroke-dashoffset="800"
                                  style="animation: drawLine 1.5s ease-out ${i * 0.15}s both;"/>
                        `;
                    }).join('')}
                    
                    <!-- Data point labels -->
                    ${categoryData.map((cat, i) => `
                        <text class="chart-value-label category-label" 
                              data-category="${cat.name}"
                              x="${(i / (categoryData.length - 1)) * 100}" 
                              y="${maxCount > 0 ? ((maxCount - cat.count) / maxCount) * 70 + 10 : 45}"
                              style="animation: labelFadeIn 0.5s ease-out ${i * 0.1 + 1.2}s both;">
                            ${cat.count}
                        </text>
                    `).join('')}
                    
                    <!-- Professional gradients -->
                    <defs>
                        ${categoryData.map((cat, i) => `
                            <linearGradient id="areaGradient${i}" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:${cat.color.bg};stop-opacity:0.08" />
                                <stop offset="100%" style="stop-color:${cat.color.bg};stop-opacity:0.01" />
                            </linearGradient>
                        `).join('')}
                    </defs>
                </svg>
                
                <!-- Professional bottom labels -->
                <div class="chart-labels-container">
                    ${categoryData.map((cat, i) => `
                        <div class="chart-label-item category-x-label" 
                             data-category="${cat.name}"
                             style="animation-delay: ${i * 0.08}s;">
                            <div class="label-icon">${cat.color.icon}</div>
                            <div class="label-name">${cat.name}</div>
                            <div class="label-count">${cat.count} tasks</div>
                        </div>
                    `).join('')}
                </div>
            </div>
        </div>
    `;
    
    // Initialize professional filtering
    initializeCategoryFiltering();
}

function filterCategoryData(selectedCategory) {
    const chartLines = document.querySelectorAll('.category-line');
    const chartAreas = document.querySelectorAll('.category-area');
    const chartLabels = document.querySelectorAll('.category-label');
    const xLabels = document.querySelectorAll('.category-x-label');
    
    if (selectedCategory === 'all') {
        // Professional view - show all data
        chartLines.forEach((line, i) => {
            line.style.opacity = '0.85';
            line.style.strokeWidth = '2.5';
            line.style.filter = 'drop-shadow(0 1px 3px rgba(0,0,0,0.15))';
        });
        chartAreas.forEach(area => {
            area.style.opacity = '0.03';
        });
        chartLabels.forEach(label => {
            label.style.opacity = '0.9';
            label.style.fontSize = '9px';
            label.style.fontWeight = '600';
        });
        xLabels.forEach(label => {
            label.style.opacity = '1';
            label.style.transform = 'scale(1)';
        });
    } else {
        // Professional focused view
        chartLines.forEach(line => {
            if (line.dataset.category === selectedCategory) {
                line.style.opacity = '1';
                line.style.strokeWidth = '3.5';
                line.style.filter = 'drop-shadow(0 2px 8px ' + line.getAttribute('stroke') + '40)';
            } else {
                line.style.opacity = '0.15';
                line.style.strokeWidth = '2';
                line.style.filter = 'none';
            }
        });
        
        chartAreas.forEach(area => {
            if (area.dataset.category === selectedCategory) {
                area.style.opacity = '0.08';
            } else {
                area.style.opacity = '0.01';
            }
        });
        
        chartLabels.forEach(label => {
            if (label.dataset.category === selectedCategory) {
                label.style.opacity = '1';
                label.style.fontSize = '10px';
                label.style.fontWeight = '700';
            } else {
                label.style.opacity = '0.25';
                label.style.fontSize = '8px';
            }
        });
        
        xLabels.forEach(label => {
            if (label.dataset.category === selectedCategory) {
                label.style.opacity = '1';
                label.style.transform = 'scale(1.05)';
                label.style.color = 'rgba(241,245,249,0.95)';
            } else {
                label.style.opacity = '0.4';
                label.style.transform = 'scale(0.95)';
                label.style.color = 'rgba(148,163,184,0.6)';
            }
        });
    }
}

// REPLACE THE EXISTING updateTrendsChart FUNCTION WITH THIS:
function updateTrendsChart(period) {
    const chartContainer = document.getElementById('trendsChart');
    if (!chartContainer) return;
    
    const now = new Date();
    let dataPoints = [];
    
    switch (period) {
        case 'week':
            for (let i = 6; i >= 0; i--) {
                const date = new Date(now);
                date.setDate(date.getDate() - i);
                const dayTasks = tasks.filter(task => {
                    const taskDate = new Date(task.createdAt || task.dueDate);
                    return taskDate.toDateString() === date.toDateString();
                });
                dataPoints.push({
                    label: date.toLocaleDateString('en-US', { weekday: 'short' }),
                    value: dayTasks.length,
                    completed: dayTasks.filter(task => task.completed).length
                });
            }
            break;
        case 'month':
            for (let i = 29; i >= 0; i -= 4) {
                const date = new Date(now);
                date.setDate(date.getDate() - i);
                const weekTasks = tasks.filter(task => {
                    const taskDate = new Date(task.createdAt || task.dueDate);
                    const weekStart = new Date(date);
                    const weekEnd = new Date(date);
                    weekEnd.setDate(weekEnd.getDate() + 4);
                    return taskDate >= weekStart && taskDate <= weekEnd;
                });
                dataPoints.push({
                    label: `Week ${Math.floor((29 - i) / 4) + 1}`,
                    value: weekTasks.length,
                    completed: weekTasks.filter(task => task.completed).length
                });
            }
            break;
        case 'year':
            for (let i = 11; i >= 0; i--) {
                const date = new Date(now);
                date.setMonth(date.getMonth() - i);
                const monthTasks = tasks.filter(task => {
                    const taskDate = new Date(task.createdAt || task.dueDate);
                    return taskDate.getMonth() === date.getMonth() && 
                           taskDate.getFullYear() === date.getFullYear();
                });
                dataPoints.push({
                    label: date.toLocaleDateString('en-US', { month: 'short' }),
                    value: monthTasks.length,
                    completed: monthTasks.filter(task => task.completed).length
                });
            }
            break;
    }
    
    const maxValue = Math.max(...dataPoints.map(d => d.value), 1);
    const hasAnyData = dataPoints.some(d => d.value > 0);
    
    chartContainer.innerHTML = `
        ${hasAnyData ? `
            <div style="display: flex; align-items: end; height: 100%; gap: 1rem; padding: 2rem; position: relative;">
                ${dataPoints.map((point, i) => {
                    const height = point.value > 0 ? (point.value / maxValue) * 80 + 10 : 5;
                    const completedHeight = point.value > 0 ? (point.completed / point.value) * height : 0;
                    return `
                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center; height: 100%;">
                            <div style="position: relative; height: 100%; display: flex; align-items: end;">
                                <!-- Total tasks bar -->
                                <div style="width: 100%; background: linear-gradient(180deg, rgba(79, 70, 229, 0.3) 0%, rgba(79, 70, 229, 0.1) 100%); 
                                            height: ${height}%; border-radius: 4px 4px 0 0; 
                                            animation: ${point.value > 0 ? `barGrow 1s ease-out ${i * 0.1}s both` : 'none'};
                                            position: relative; border: 1px solid rgba(79, 70, 229, 0.2);">
                                    <!-- Completed tasks overlay -->
                                    ${point.completed > 0 ? `
                                        <div style="position: absolute; bottom: 0; left: 0; right: 0;
                                                   background: linear-gradient(180deg, var(--success) 0%, var(--success-dark) 100%); 
                                                   height: ${completedHeight}%; border-radius: 4px 4px 0 0;
                                                   animation: barGrow 1.2s ease-out ${i * 0.1 + 0.3}s both;"></div>
                                    ` : ''}
                                    <!-- Value label on bar -->
                                    ${point.value > 0 ? `
                                        <div style="position: absolute; top: -2rem; left: 50%; transform: translateX(-50%); 
                                                   color: rgba(255,255,255,0.9); font-size: 0.9rem; font-weight: 600;
                                                   background: rgba(0,0,0,0.3); padding: 0.2rem 0.5rem; border-radius: 6px;
                                                   opacity: 0; animation: labelFadeIn 0.5s ease-out ${i * 0.1 + 0.8}s both;">
                                            ${point.value}
                                        </div>
                                    ` : ''}
                                    <!-- Completed count -->
                                    ${point.completed > 0 ? `
                                        <div style="position: absolute; top: -3.5rem; left: 50%; transform: translateX(-50%); 
                                                   color: var(--success); font-size: 0.8rem; font-weight: 600;
                                                   opacity: 0; animation: labelFadeIn 0.5s ease-out ${i * 0.1 + 1}s both;">
                                            ✓${point.completed}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                            <!-- Bottom label -->
                            <div style="margin-top: 0.5rem; color: rgba(255,255,255,0.7); font-size: 0.8rem; text-align: center;">
                                ${point.label}
                            </div>
                        </div>
                    `;
                }).join('')}
            </div>
        ` : `
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 2rem;">
                <i class="fas fa-chart-line" style="font-size: 4rem; color: rgba(255,255,255,0.2); margin-bottom: 1.5rem;"></i>
                <h3 style="color: rgba(255,255,255,0.7); margin-bottom: 0.5rem; font-size: 1.3rem;">No Activity Yet</h3>
                <p style="color: rgba(255,255,255,0.5); text-align: center; max-width: 300px; line-height: 1.5;">
                    Your activity trends will appear here as you create and complete tasks over time.
                </p>
            </div>
        `}
        
       <!-- Enhanced Legend with FATTER oval indicators -->
        <div style="display: flex; justify-content: center; gap: 2.5rem; margin-top: 1.5rem; padding: 1rem;
                   background: rgba(255,255,255,0.03); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 20px; height: 28px; 
                           background: linear-gradient(180deg, rgba(79, 70, 229, 0.4) 0%, rgba(79, 70, 229, 0.2) 100%); 
                           border-radius: 15px; border: 2px solid rgba(79, 70, 229, 0.3);
                           box-shadow: 0 2px 6px rgba(79, 70, 229, 0.2);"></div>
                <span style="color: rgba(255,255,255,0.9); font-size: 0.9rem; font-weight: 600;">Total Tasks</span>
            </div>
            <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 20px; height: 28px; 
                           background: linear-gradient(180deg, var(--success) 0%, var(--success-dark) 100%); 
                           border-radius: 15px; box-shadow: 0 2px 6px rgba(16, 185, 129, 0.3);"></div>
                <span style="color: rgba(255,255,255,0.9); font-size: 0.9rem; font-weight: 600;">Completed</span>
            </div>
        </div>
    `;
}


function updateCategoryChart() {
    const chartContainer = document.getElementById('categoryBarChart');
    if (!chartContainer) return;
    
    const categories = ['work', 'personal', 'shopping', 'health', 'finance', 'education'];
    const visibleCategories = ['work', 'personal', 'shopping', 'health'];
    const hiddenCategories = ['finance', 'education'];
    
    const categoryData = categories.map(cat => ({
        name: cat,
        count: tasks.filter(task => task.category === cat).length,
        color: categoryColors[cat] || categoryColors.work
    }));
    
    const maxCount = Math.max(...categoryData.map(d => d.count), 1);
    const hasAnyData = categoryData.some(d => d.count > 0);
    const totalTasks = categoryData.reduce((sum, cat) => sum + cat.count, 0);
    const activeCategoriesCount = categoryData.filter(c => c.count > 0).length;
    
    chartContainer.innerHTML = `
        <!-- Color-Coded Category Header - Only colored when active -->
        <div class="category-header-grid">
            ${categoryData.map((cat, index) => {
                const hasActivity = cat.count > 0;
                return `
                    <div class="category-header-item ${hasActivity ? 'active' : 'inactive'}" 
                         style="${hasActivity ? `background: ${cat.color.gradient};` : 'background: rgba(255, 255, 255, 0.05);'} 
                                animation: categoryHeaderSlide 0.6s ease-out ${index * 0.1}s both;">
                        <div class="category-header-icon ${hasActivity ? 'active' : 'inactive'}">
                            ${cat.color.icon}
                        </div>
                        <div class="category-header-info">
                            <div class="category-header-name">${cat.name}</div>
                            <div class="category-header-count ${hasActivity ? 'active' : 'inactive'}">
                                ${hasActivity ? `${cat.count} task${cat.count !== 1 ? 's' : ''}` : 'No activity'}
                            </div>
                        </div>
                        ${hasActivity ? `
                            <div class="activity-indicator">
                                <i class="fas fa-circle-check"></i>
                            </div>
                        ` : `
                            <div class="inactive-indicator">
                                <i class="fas fa-circle"></i>
                            </div>
                        `}
                    </div>
                `;
            }).join('')}
        </div>
        
        <!-- Chart Title - Updated to show active categories -->
        <div class="chart-section-title">
            <h4>Task Distribution by Category</h4>
            <span>${totalTasks > 0 ? `${totalTasks} total tasks across ${activeCategoriesCount} active categories` : 'Create tasks to see category distribution'}</span>
        </div>
        
        <!-- Rest of your existing code for bars... -->
        ${totalTasks > 0 ? `
            <!-- Always Visible Bars (First 4) -->
            <div class="bar-chart-container-dynamic">
                ${categoryData
                    .filter(cat => visibleCategories.includes(cat.name))
                    .map((cat, i) => {
                        const width = hasAnyData && cat.count > 0 ? (cat.count / maxCount) * 100 : 0;
                        const hasData = cat.count > 0;
                        
                        return createCategoryBarHTML(cat, i, width, hasData, totalTasks);
                    }).join('')}
            </div>
            
            <!-- View More Button -->
            <div class="category-view-more-container">
                <button class="category-view-more-btn" id="categoryViewMoreBtn">
                    <span class="btn-text">View More Categories</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            
            <!-- Expandable Bars (Last 2) -->
            <div class="expandable-rows" id="categoryExpandableRows">
                ${categoryData
                    .filter(cat => hiddenCategories.includes(cat.name))
                    .map((cat, i) => {
                        const width = hasAnyData && cat.count > 0 ? (cat.count / maxCount) * 100 : 0;
                        const hasData = cat.count > 0;
                        
                        return createCategoryBarHTML(cat, i + 4, width, hasData, totalTasks);
                    }).join('')}
            </div>
        ` : `
            <!-- Empty State when no tasks -->
            <div class="category-empty-state">
                <i class="fas fa-chart-bar"></i>
                <h4>No Tasks Created Yet</h4>
                <p>Create your first task to see category-wise distribution and analytics</p>
                <div class="empty-state-hint">
                    <span>💡 Tip: Use the "Add Task" button to get started</span>
                </div>
            </div>
        `}
        
        <!-- Summary Footer - Only show when there's data -->
        ${totalTasks > 0 ? `
            <div class="chart-summary-footer">
                <div class="summary-stats">
                    <span class="summary-completed">${tasks.filter(t => t.completed).length} completed</span>
                    <span class="summary-pending">${tasks.filter(t => !t.completed).length} pending</span>
                    <span class="summary-total">${totalTasks} total</span>
                </div>
            </div>
        ` : ''}
    `;
    
    // Rest of your existing click handler code...
    const viewMoreBtn = document.getElementById('categoryViewMoreBtn');
    const expandableRows = document.getElementById('categoryExpandableRows');
    
    if (viewMoreBtn && expandableRows) {
        viewMoreBtn.addEventListener('click', () => {
            const isExpanded = expandableRows.classList.contains('expanded');
            const btnText = viewMoreBtn.querySelector('.btn-text');
            const btnIcon = viewMoreBtn.querySelector('i');
            
            if (isExpanded) {
                expandableRows.classList.remove('expanded');
                viewMoreBtn.classList.remove('expanded');
                btnText.textContent = 'View More Categories';
                btnIcon.className = 'fas fa-chevron-down';
            } else {
                expandableRows.classList.add('expanded');
                viewMoreBtn.classList.add('expanded');
                btnText.textContent = 'View Less Categories';
                btnIcon.className = 'fas fa-chevron-up';
            }
        });
    }
}

// Helper function to create category bar HTML
function createCategoryBarHTML(cat, index, width, hasData, totalTasks) {
    return `
        <div class="bar-chart-row-dynamic ${hasData ? 'has-data' : 'no-data'}">
            <div class="bar-label-dynamic">
                <i class="${cat.color.icon.replace('<i class="', '').replace('"></i>', '')}" 
                   style="background: ${hasData ? cat.color.bg : 'rgba(255,255,255,0.2)'}; 
                          color: white; width: 20px; height: 20px; 
                          display: flex; align-items: center; justify-content: center; 
                          border-radius: 5px; font-size: 0.8rem; margin-right: 0.6rem;
                          transition: all 0.3s ease;"></i>
                <span class="category-name-dynamic">${cat.name}</span>
            </div>
            
            <div class="bar-container-dynamic">
                <!-- Background track -->
                <div class="bar-track" style="
                    width: 100%; 
                    height: 100%; 
                    background: rgba(255,255,255,0.05); 
                    border-radius: 14px;
                    border: 1px solid rgba(255,255,255,0.1);
                "></div>
                
                <!-- Progress bar -->
                <div class="bar-fill-dynamic" 
                     style="background: ${cat.color.gradient}; 
                            width: ${width}%;
                            animation: ${hasData ? `barGrowDynamic 1.2s ease-out ${index * 0.15}s both` : 'none'};
                            transition: width 0.8s ease-out;">
                            
                    <span class="bar-count-dynamic" 
                          style="opacity: ${hasData ? '1' : '0'};
                                 transform: ${hasData ? 'scale(1)' : 'scale(0.8)'};
                                 transition: all 0.3s ease;">
                        ${cat.count}
                    </span>
                    
                    ${hasData ? `<div class="bar-shimmer-dynamic"></div>` : ''}
                </div>
                
                <!-- No data indicator -->
                <div class="no-data-indicator" 
                     style="opacity: ${hasData ? '0' : '1'};
                            pointer-events: ${hasData ? 'none' : 'auto'};
                            transition: opacity 0.4s ease;">
                    <span>No data yet</span>
                </div>
            </div>
            
            <!-- Progress percentage -->
            <div class="progress-percentage" 
                 style="opacity: ${hasData ? '1' : '0'};
                        transform: ${hasData ? 'translateX(0)' : 'translateX(10px)'};
                        transition: all 0.3s ease;">
                ${hasData && totalTasks > 0 ? Math.round((cat.count / totalTasks) * 100) + '%' : '0%'}
            </div>
        </div>
    `;
}

// Add the keyframe animations to your CSS
const additionalCSS = `
@keyframes barGrow {
    from { height: 0%; }
    to { height: var(--final-height, 50%); }
}

@keyframes barGrowHorizontal {
    from { width: 0%; }
    to { width: var(--final-width, 50%); }
}
`;

// Add the CSS to the page
const style = document.createElement('style');
style.textContent = additionalCSS;
document.head.appendChild(style);

            // Initialize the application
            initializeApp();
            initializeAdvancedFilter();

            // Broad View Mode Implementation
            let scrollTimeout;
            let isBroadView = false;
            const mainContent = document.querySelector('.main-content');
            const broadViewToggle = document.getElementById('broadViewToggle');

            function initializeBroadViewMode() {
                const taskListWrapper = document.getElementById('taskListWrapper');
                
                if (!taskListWrapper || !mainContent || !broadViewToggle) return;

                // Scroll detection for auto broad view
                taskListWrapper.addEventListener('scroll', () => {
                    // Only trigger in 'all' category
                    if (currentCategory !== 'all') return;
                    
                    clearTimeout(scrollTimeout);
                    
                    // Show toggle button immediately when scrolling
                    if (!broadViewToggle.classList.contains('show')) {
                        broadViewToggle.classList.add('show');
                    }
                    
                    // Auto-enter broad view after 1 second of scrolling
                    scrollTimeout = setTimeout(() => {
                        if (!isBroadView && taskListWrapper.scrollTop > 50) {
                            enterBroadView();
                        }
                    }, 1000);
                });

                // Toggle button click handler
                broadViewToggle.addEventListener('click', () => {
                    if (isBroadView) {
                        exitBroadView();
                    } else {
                        enterBroadView();
                    }
                });

                // Exit broad view when category changes
                document.querySelectorAll('.category').forEach(category => {
                    category.addEventListener('click', () => {
                        if (isBroadView) {
                            exitBroadView();
                        }
                    });
                });

                // Hide toggle button when not in 'all' category
                const categoryObserver = new MutationObserver(() => {
                    if (currentCategory !== 'all') {
                        broadViewToggle.classList.remove('show');
                        if (isBroadView) {
                            exitBroadView();
                        }
                    }
                });
            }

            function enterBroadView() {
                if (isBroadView) return;
                
                isBroadView = true;
                mainContent.classList.add('broad-view');
                
                // Update toggle button icon
                const toggleIcon = broadViewToggle.querySelector('i');
                if (toggleIcon) {
                    toggleIcon.className = 'fas fa-compress';
                }
                
                // Show notification
                showNotification('📖 Broad view mode activated', 'info');
                
                // Smooth scroll to top for better UX
                const taskListWrapper = document.getElementById('taskListWrapper');
                if (taskListWrapper) {
                    taskListWrapper.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            }

            function exitBroadView() {
                if (!isBroadView) return;
                
                isBroadView = false;
                mainContent.classList.remove('broad-view');
                
                // Update toggle button icon
                const toggleIcon = broadViewToggle.querySelector('i');
                if (toggleIcon) {
                    toggleIcon.className = 'fas fa-expand';
                }
                
                // Show notification
                showNotification('📑 Normal view restored', 'info');
            }

            // Initialize broad view mode
            initializeBroadViewMode();

            function updateSearchBlurHandling() {
    const searchInput = document.getElementById('searchInput');
    const searchBlurOverlay = document.getElementById('searchBlurOverlay');
    const searchSuggestions = document.getElementById('searchSuggestions');
    
    if (!searchInput || !searchBlurOverlay) return;

    let searchTimeout;
    let currentFocusIndex = -1;

    // Enhanced search input handling
    searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.trim();
        
        clearTimeout(searchTimeout);
        
        if (searchTerm.length > 0) {
            // Show blur immediately
            searchBlurOverlay.classList.add('active');
            
            searchTimeout = setTimeout(() => {
                const matchedTasks = tasks.filter(task => 
                    task.title.toLowerCase().includes(searchTerm.toLowerCase()) || 
                    (task.description && task.description.toLowerCase().includes(searchTerm.toLowerCase()))
                );
                
                if (matchedTasks.length > 0) {
                    showEnhancedSuggestions(matchedTasks, searchTerm);
                } else {
                    showNoResults(searchTerm);
                }
            }, 200);
        } else {
            hideSuggestions();
        }
    });

    // Show suggestions when focused if has content
    searchInput.addEventListener('focus', () => {
        if (searchInput.value.trim().length > 0) {
            searchBlurOverlay.classList.add('active');
            // Re-trigger search to show existing suggestions
            const event = new Event('input');
            searchInput.dispatchEvent(event);
        }
    });

    // Hide suggestions when losing focus
    searchInput.addEventListener('blur', (e) => {
        setTimeout(() => {
            // Only hide if not clicking on suggestions
            if (!document.querySelector('.search-suggestions:hover')) {
                hideSuggestions();
            }
        }, 150);
    });

    // Keyboard navigation for better accessibility
    searchInput.addEventListener('keydown', (e) => {
        const suggestions = document.querySelectorAll('.search-suggestion-item');
        
        switch (e.key) {
            case 'ArrowDown':
                e.preventDefault();
                currentFocusIndex = Math.min(currentFocusIndex + 1, suggestions.length - 1);
                updateFocus(suggestions);
                break;
                
            case 'ArrowUp':
                e.preventDefault();
                currentFocusIndex = Math.max(currentFocusIndex - 1, -1);
                updateFocus(suggestions);
                break;
                
            case 'Enter':
                e.preventDefault();
                if (currentFocusIndex >= 0 && suggestions[currentFocusIndex]) {
                    suggestions[currentFocusIndex].click();
                }
                break;
                
            case 'Escape':
                hideSuggestions();
                searchInput.blur();
                break;
        }
    });

    // Click on blur overlay to hide
    searchBlurOverlay.addEventListener('click', () => {
        hideSuggestions();
        searchInput.blur();
    });

    function showEnhancedSuggestions(matchedTasks, searchTerm) {
        if (!searchSuggestions) return;
        
        searchSuggestions.innerHTML = '';
        matchedTasks.slice(0, 5).forEach((task, index) => { // Show up to 6 results
            const item = document.createElement('div');
            item.className = 'search-suggestion-item';
            item.setAttribute('tabindex', '0'); // Make focusable
            
            item.innerHTML = `
                <div>${highlightText(task.title, searchTerm)}</div>
                ${task.description ? `<div>${highlightText(task.description, searchTerm)}</div>` : ''}
            `;
            
            // Click handler
            item.addEventListener('click', () => {
                selectTask(task);
                hideSuggestions();
                searchInput.value = task.title;
                showNotification(`🎯 Viewing: ${task.title}`, 'info');
            });
            
            // Mouse enter handler for focus
            item.addEventListener('mouseenter', () => {
                currentFocusIndex = index;
                updateFocus(document.querySelectorAll('.search-suggestion-item'));
            });
            
            // Keyboard handler for individual items
            item.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    item.click();
                }
            });
            
            searchSuggestions.appendChild(item);
        });
        
        searchSuggestions.classList.add('show');
        currentFocusIndex = -1;
    }

    function showNoResults(searchTerm) {
        if (!searchSuggestions) return;
        
        searchSuggestions.innerHTML = `
            <div class="search-no-results">
                <div class="icon">🔍</div>
                <div style="font-weight: 600; margin-bottom: 0.25rem;">No tasks found</div>
                <div style="font-size: 0.9rem; opacity: 0.8;">
                    No results for "${searchTerm}"
                </div>
                <div style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.6;">
                    Try a different search term
                </div>
            </div>
        `;
        
        searchSuggestions.classList.add('show');
    }

    function updateFocus(suggestions) {
        suggestions.forEach((item, index) => {
            if (index === currentFocusIndex) {
                item.style.background = 'linear-gradient(135deg, rgba(79, 70, 229, 0.12) 0%, rgba(118, 75, 162, 0.08) 100%)';
                item.style.transform = 'translateX(5px)';
                item.style.borderLeft = '4px solid var(--primary)';
                item.style.boxShadow = '0 4px 12px rgba(79, 70, 229, 0.15)';
                item.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
            } else {
                item.style.background = '';
                item.style.transform = '';
                item.style.borderLeft = '';
                item.style.boxShadow = '';
            }
        });
    }

    function selectTask(task) {
        // Filter to show only the selected task
        const originalTasks = [...tasks];
        tasks = [task];
        renderTasks();
        tasks = originalTasks;
    }

    function hideSuggestions() {
        if (searchSuggestions && searchBlurOverlay) {
            searchSuggestions.classList.remove('show');
            searchBlurOverlay.classList.remove('active');
            currentFocusIndex = -1;
        }
    }

    // Enhanced highlighting function
    function highlightText(text, searchTerm) {
        if (!searchTerm) return text;
        const regex = new RegExp(`(${searchTerm})`, 'gi');
        return text.replace(regex, '<mark>$1</mark>');
    }
}

            // Hide popup when clicking outside
document.addEventListener('click', (e) => {
    if (currentDetectionPopup && !e.target.closest('.ai-detection-popup') && !e.target.closest('#taskTitle')) {
        currentDetectionPopup.classList.remove('show');
        setTimeout(() => {
            if (currentDetectionPopup) {
                currentDetectionPopup.remove();
                currentDetectionPopup = null;
            }
        }, 300);
    }
});

            // Add some sample data if no tasks exist
            if (tasks.length === 0) {
                const sampleTasks = [
                    {
                        id: generateId(),
                        title: 'Welcome to Tasklytic!',
                        description: 'This is a sample task to get you started. Try editing or deleting it!',
                        category: 'personal',
                        priority: 'medium',
                        dueDate: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
                        completed: false,
                        createdAt: new Date().toISOString(),
                        modifiedAt: new Date().toISOString()
                    },
                    {
                        id: generateId(),
                        title: 'Try the AI Prioritization',
                        description: 'Click the AI button to see intelligent task creation in action!',
                        category: 'work',
                        priority: 'high',
                        dueDate: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),
                        completed: false,
                        createdAt: new Date().toISOString(),
                        modifiedAt: new Date().toISOString()
                    }
                ];
                
                tasks = sampleTasks;
                saveTasks();
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
            }
        });

        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', (e) => {
            console.error('Unhandled promise rejection:', e.reason);
            e.preventDefault();
        });
    </script>

      <script>
if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        const swCode = `
            const CACHE_NAME = 'tasklytic-v1';
            const urlsToCache = ['./', '/'];
            
            self.addEventListener('install', function(event) {
                console.log('SW: Installing...');
                event.waitUntil(
                    caches.open(CACHE_NAME)
                        .then(function(cache) {
                            console.log('SW: Caching files');
                            return cache.addAll(urlsToCache);
                        })
                        .catch(function(error) {
                            console.log('SW: Cache failed', error);
                        })
                );
                self.skipWaiting();
            });
            
            self.addEventListener('fetch', function(event) {
                event.respondWith(
                    caches.match(event.request)
                        .then(function(response) {
                            return response || fetch(event.request);
                        })
                        .catch(function() {
                            return caches.match('./');
                        })
                );
            });
            
            self.addEventListener('activate', function(event) {
                console.log('SW: Activated');
                event.waitUntil(
                    caches.keys().then(function(cacheNames) {
                        return Promise.all(
                            cacheNames.map(function(cacheName) {
                                if (cacheName !== CACHE_NAME) {
                                    return caches.delete(cacheName);
                                }
                            })
                        );
                    })
                );
            });
        `;
        
        const blob = new Blob([swCode], { type: 'application/javascript' });
        const swURL = URL.createObjectURL(blob);
        
        navigator.serviceWorker.register(swURL)
            .then(function(registration) {
                console.log('✅ ServiceWorker registered successfully');
                // Trigger install prompt after a delay
                setTimeout(() => {
                    window.dispatchEvent(new Event('beforeinstallprompt'));
                }, 2000);
            })
            .catch(function(error) {
                console.log('❌ ServiceWorker registration failed: ', error);
            });
    });
}
</script>
<!-- Broad View Toggle Button -->
    <button class="broad-view-toggle" id="broadViewToggle" aria-label="Toggle Broad View">
        <i class="fas fa-expand"></i>
    </button>

    <!-- Full Screen Analytics Modal - Place RIGHT BEFORE </body> -->
<div class="analytics-fullscreen-modal" id="analyticsFullscreenModal">
    <div class="analytics-modal-header">
        <h2 class="analytics-modal-title" id="analyticsModalTitle">
            <i class="fas fa-chart-bar"></i>
            Task Analytics
        </h2>
        <button class="analytics-close-btn" id="analyticsCloseBtn">
            <i class="fas fa-times"></i>
        </button>
    </div>
    
    <div class="analytics-modal-content">
        <!-- Real-time Stats Grid -->
        <div class="realtime-stats-grid" id="realtimeStatsGrid">
            <!-- Stats will be populated here -->
        </div>
        
        <!-- Progress Rings -->
        <div class="progress-ring-container" id="progressRingContainer">
            <!-- Progress rings will be populated here -->
        </div>
        
        <!-- 1. TRENDS CHART (Bar/Line Toggle) -->
<div class="interactive-chart-container">
    <div class="chart-header">
    <h3 class="chart-title">Task Completion Trends</h3>
    <div class="chart-subtitle" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-top: 0.25rem;">
        Visual overview of your task creation and completion patterns
    </div>
        <div class="chart-controls-row">
            <div class="chart-controls">
        <button class="chart-control-btn active" data-period="week">Week</button>
        <button class="chart-control-btn" data-period="month">Month</button>
        <button class="chart-control-btn" data-period="year">Year</button>
    </div>
</div>
    </div>
    <div id="trendsChart" style="height: 350px; overflow: hidden;"></div>
</div>
        
        <!-- 2. CATEGORY DISTRIBUTION (Enhanced with Completed/Pending) -->
<div class="interactive-chart-container">
    <div class="chart-header">
        <h3 class="chart-title">Category Distribution</h3>
        <div class="chart-subtitle" style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-top: 0.25rem;">
            Complete breakdown showing all tasks: completed and pending
        </div>
    </div>
    <!-- INCREASED HEIGHT FOR ENHANCED FEATURES -->
    <div id="categoryBarChart" style="height: 500px; overflow: hidden;"></div>
</div>


<!-- SVG Gradients for Progress Rings -->
<svg style="position: absolute; width: 0; height: 0;" aria-hidden="true">
    <defs>
        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#4f46e5;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#06b6d4;stop-opacity:1" />
        </linearGradient>
    </defs>
</svg>

</body>
</html>
        
